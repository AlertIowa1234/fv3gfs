<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.13"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>GFS Physics Documentation: Orographic Gravity Wave Drag and Mountain Blocking</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { init_search(); });
</script>
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    extensions: ["tex2jax.js"],
    jax: ["input/TeX","output/HTML-CSS"],
});
</script><script type="text/javascript" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="ccpp_dox_extra_style.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="ncep.jpg"/></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">GFS Physics Documentation
   </div>
  </td>
   <td>        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
</td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.13 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('group__orographic.html','');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">Orographic Gravity Wave Drag and Mountain Blocking<div class="ingroups"><a class="el" href="group__gwd.html">Orographic and Convective Gravity Wave Drag</a></div></div>  </div>
</div><!--header-->
<div class="contents">

<p>This subroutine includes orographic gravity wave drag and mountain blocking.  
<a href="#details">More...</a></p>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<p>The time tendencies of zonal and meridional wind are altered to include the effect of mountain induced gravity wave drag from subgrid scale orography including convective breaking, shear breaking and the presence of critical levels. </p>
<table class="memberdecls">
<tr class="memitem:ga82eda62e1bdee0a0ab6a831fc53ae89c"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__orographic.html#ga82eda62e1bdee0a0ab6a831fc53ae89c">gwdps</a> (IM, IX, IY, KM, A, B, C, U1, V1, T1, Q1, KPBL, PRSI, DEL, PRSL, PRSLK, PHII, PHIL, DELTIM, KDT, HPRIME, OC, OA4, CLX4, THETA, SIGMA, GAMMA, ELVMAX, DUSFC, DVSFC, G, CP, RD, RV, IMX, nmtvr, cdmbgwd, me, lprnt, ipr, rdxzb)</td></tr>
<tr class="separator:ga82eda62e1bdee0a0ab6a831fc53ae89c"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<h2 class="groupheader">Function/Subroutine Documentation</h2>
<a id="ga82eda62e1bdee0a0ab6a831fc53ae89c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga82eda62e1bdee0a0ab6a831fc53ae89c">&#9670;&nbsp;</a></span>gwdps()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine gwdps </td>
          <td>(</td>
          <td class="paramtype">integer&#160;</td>
          <td class="paramname"><em>IM</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer&#160;</td>
          <td class="paramname"><em>IX</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer&#160;</td>
          <td class="paramname"><em>IY</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer&#160;</td>
          <td class="paramname"><em>KM</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(kind=kind_phys), dimension(iy,km)&#160;</td>
          <td class="paramname"><em>A</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(kind=kind_phys), dimension(iy,km)&#160;</td>
          <td class="paramname"><em>B</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(kind=kind_phys), dimension(iy,km)&#160;</td>
          <td class="paramname"><em>C</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(kind=kind_phys), dimension(ix,km)&#160;</td>
          <td class="paramname"><em>U1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(kind=kind_phys), dimension(ix,km)&#160;</td>
          <td class="paramname"><em>V1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(kind=kind_phys), dimension(ix,km)&#160;</td>
          <td class="paramname"><em>T1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(kind=kind_phys), dimension(ix,km)&#160;</td>
          <td class="paramname"><em>Q1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, dimension(im)&#160;</td>
          <td class="paramname"><em>KPBL</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(kind=kind_phys), dimension(ix,km+1)&#160;</td>
          <td class="paramname"><em>PRSI</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(kind=kind_phys), dimension(ix,km)&#160;</td>
          <td class="paramname"><em>DEL</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(kind=kind_phys), dimension(ix,km)&#160;</td>
          <td class="paramname"><em>PRSL</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(kind=kind_phys), dimension(ix,km)&#160;</td>
          <td class="paramname"><em>PRSLK</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(kind=kind_phys), dimension(ix,km+1)&#160;</td>
          <td class="paramname"><em>PHII</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(kind=kind_phys), dimension(ix,km)&#160;</td>
          <td class="paramname"><em>PHIL</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(kind=kind_phys)&#160;</td>
          <td class="paramname"><em>DELTIM</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer&#160;</td>
          <td class="paramname"><em>KDT</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(kind=kind_phys), dimension(im)&#160;</td>
          <td class="paramname"><em>HPRIME</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(kind=kind_phys), dimension(im)&#160;</td>
          <td class="paramname"><em>OC</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(kind=kind_phys), dimension(iy,4)&#160;</td>
          <td class="paramname"><em>OA4</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(kind=kind_phys), dimension(iy,4)&#160;</td>
          <td class="paramname"><em>CLX4</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(kind=kind_phys), dimension(im)&#160;</td>
          <td class="paramname"><em>THETA</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(kind=kind_phys), dimension(im)&#160;</td>
          <td class="paramname"><em>SIGMA</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(kind=kind_phys), dimension(im)&#160;</td>
          <td class="paramname"><em>GAMMA</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(kind=kind_phys), dimension(im)&#160;</td>
          <td class="paramname"><em>ELVMAX</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(kind=kind_phys), dimension(im)&#160;</td>
          <td class="paramname"><em>DUSFC</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(kind=kind_phys), dimension(im)&#160;</td>
          <td class="paramname"><em>DVSFC</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(kind=kind_phys)&#160;</td>
          <td class="paramname"><em>G</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(kind=kind_phys)&#160;</td>
          <td class="paramname"><em>CP</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(kind=kind_phys)&#160;</td>
          <td class="paramname"><em>RD</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(kind=kind_phys)&#160;</td>
          <td class="paramname"><em>RV</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer&#160;</td>
          <td class="paramname"><em>IMX</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer&#160;</td>
          <td class="paramname"><em>nmtvr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(kind=kind_phys), dimension(2)&#160;</td>
          <td class="paramname"><em>cdmbgwd</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer&#160;</td>
          <td class="paramname"><em>me</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">logical&#160;</td>
          <td class="paramname"><em>lprnt</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer&#160;</td>
          <td class="paramname"><em>ipr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(kind=kind_phys), dimension(iy)&#160;</td>
          <td class="paramname"><em>rdxzb</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">IM</td><td>horizontal number of used pts </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">IX</td><td>horizontal dimension </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">IY</td><td>horizontal number of used pts </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">KM</td><td>vertical layer dimension </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">A</td><td>non-linear tendency for v wind component </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">B</td><td>non-linear tendency for u wind component </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">C</td><td>non-linear tendency for temperature (not used) </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">U1</td><td>zonal wind component of model layer wind (m/s) </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">V1</td><td>meridional wind component of model layer wind (m/s) </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">T1</td><td>model layer mean temperature (K) </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">Q1</td><td>model layer mean specific humidity </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">KPBL</td><td>index for the PBL top layer </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">PRSI</td><td>pressure at layer interfaces </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">DEL</td><td>positive increment of p/psfc across layer </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">PRSL</td><td>mean layer pressure </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">PRSLK</td><td>Exner function at layer </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">PHII</td><td>interface geopotential ( \(m^2/s^2\)) </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">PHIL</td><td>layer geopotential ( \(m^2/s^2\)) </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">DELTIM</td><td>physics time step in seconds </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">KDT</td><td>number of the current time step </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">HPRIME</td><td>orographic standard deviation (m) (mtnvar(:,1)) </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">OC</td><td>orographic Convexity (mtnvar(:,2)) </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">OA4</td><td>orographic Asymmetry (mtnvar(:,3:6)) </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">CLX4</td><td>Lx, the fractional area covered by the subgrid-scale orography higher than a critical height for a grid box with the interval \( \triangle x \) (mtnvar(:,7:10)) </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">THETA</td><td>the angle of the mtn with that to the east (x) axis (mtnvar(:,11)) </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">SIGMA</td><td>orographic slope (mtnvar(:,13)) </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">GAMMA</td><td>orographic anisotropy (mtnvar(:,12)) </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">ELVMAX</td><td>orographic maximum (mtnvar(:,14)) </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">DUSFC</td><td>u component of surface stress </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">DVSFC</td><td>v component of surface stress </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">G</td><td>see physcons::con_g </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">CP</td><td>see physcons::con_cp </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">RD</td><td>see physcons::con_tird </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">RV</td><td>see physcons::con_rv </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">IMX</td><td>number of longitude points </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">NMTVR</td><td>number of topographic variables such as variance etc used in the GWD parameterization,current operational, nmtvr=14 </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">CDMBGWD</td><td>multiplication factors for cdmb and gwd </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">ME</td><td>pe number - used for debug prints </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">LPRNT</td><td>logical print flag </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">IPR</td><td>check print point for debugging </td></tr>
  </table>
  </dd>
</dl>
<h1><a class="anchor" id="gen_gwdps"></a>
General Algorithm</h1>
<p>&mdash; Subgrid Mountain Blocking Section</p>
<ul>
<li>Compute Brunt-Vaisala Frequency \(N\).</li>
<li>Find the dividing streamline height starting from the level above the maximum mountain height and processing downward.</li>
<li>Compute wind speed UDS <p class="formulaDsp">
\[ UDS=\max(\sqrt{U1^2+V1^2},minwnd) \]
</p>
 where \( minwnd=0.1 \), \(U1\) and \(V1\) are zonal and meridional wind components of model layer wind.</li>
<li>The dividing streamline height (idxzb), of a subgrid scale obstable, is found by comparing the potential (PE) and kinetic energies (EK) of the upstream large scale wind and subgrid scale air parcel movements. the dividing streamline is found when \(PE\geq EK\). Mountain-blocked flow is defined to exist between the surface and the dividing streamline height ( \(h_d\)), which can be found by solving an integral equation for \(h_d\): <p class="formulaDsp">
\[ \frac{U^{2}(h_{d})}{2}=\int_{h_{d}}^{H} N^{2}(z)(H-z)dz \]
</p>
 where \(H\) is the maximum subgrid scale elevation within the grid box of actual orography, \(h\), obtained from the GTOPO30 dataset from the U.S. Geological Survey.</li>
<li>Calculate \(ZLEN\), which sums up a number of contributions of elliptic obstables. <p class="formulaDsp">
\[ ZLEN=\sqrt{[\frac{h_{d}-z}{z+h&#39;}]} \]
</p>
 where \(z\) is the height, \(h&#39;\) is the orographic standard deviation (HPRIME).</li>
<li>Calculate the drag coefficient to vary with the aspect ratio of the obstable as seen by the incident flow (see eq.14 in Lott and Miller (1997) <a class="el" href="citelist.html#CITEREF_lott_and_miller_1997">[42]</a>) <p class="formulaDsp">
\[ R=\frac{\cos^{2}\psi+\gamma\sin^{2}\psi}{\gamma\cos^{2}\psi+\sin^{2}\psi} \]
</p>
 where \(\psi\), which is derived from THETA, is the angle between the incident flow direction and the normal ridge direcion. \(\gamma\) is the orographic anisotropy (GAMMA).</li>
<li>In each model layer below the dividing streamlines, a drag from the blocked flow is exerted by the obstacle on the large scale flow. The drag per unit area and per unit height is written (eq.15 in Lott and Miller (1997) <a class="el" href="citelist.html#CITEREF_lott_and_miller_1997">[42]</a>): <p class="formulaDsp">
\[ D_{b}(z)=-C_{d}\max(2-\frac{1}{R},0)\rho\frac{\sigma}{2h&#39;}ZLEN\max(\cos\psi,\gamma\sin\psi)\frac{UDS}{2} \]
</p>
 where \(C_{d}\) is a specified constant, \(\sigma\) is the orographic slope.</li>
</ul>
<p>&mdash; Orographic Gravity Wave Drag Section</p>
<ul>
<li>Calculate the reference level index: kref=max(2,KPBL+1). where KPBL is the index for the PBL top layer.</li>
<li>Calculate low-level horizontal wind direction, the derived orographic asymmetry parameter (OA), and the derived Lx (CLX).</li>
<li>Calculate enhancement factor (E),number of mountans (m') and aspect ratio constant. <br />
 As in eq.(4.9),(4.10),(4.11) in Kim and Arakawa (1995) <a class="el" href="citelist.html#CITEREF_kim_and_arakawa_1995">[37]</a>, we define m' and E in such a way that they depend on the geometry and location of the subgrid-scale orography through OA and the nonlinearity of flow above the orography through Fr. OC, which is the orographic convexity, and statistically determine how protruded (sharp) the subgrid-scale orography is, is included in the saturation flux G' in such a way that G' is proportional to OC. The forms of E,m' and G' are: <p class="formulaDsp">
\[ E(OA,F_{r_{0}})=(OA+2)^{\delta} \]
</p>
 <p class="formulaDsp">
\[ \delta=C_{E}F_{r_{0}}/F_{r_{c}} \]
</p>
 <p class="formulaDsp">
\[ m&#39;(OA,CLX)=C_{m}\triangle x(1+CLX)^{OA+1} \]
</p>
 <p class="formulaDsp">
\[ G&#39;(OC,F_{r_{0}})=\frac{F_{r_{0}}^2}{F_{r_{0}}^2+a^{2}} \]
</p>
 <p class="formulaDsp">
\[ a^{2}=C_{G}OC^{-1} \]
</p>
 where \(F_{r_{c}}(=1)\) is the critical Froude number, \(F_{r_{0}}\) is the Froude number. \(C_{E}\), \(C_{m}\), \(C_{G}\) are constants.</li>
<li>Calculate the reference-level drag \(\tau_{0}\) (eq.(4.8) in Kim and Arakawa (1995) <a class="el" href="citelist.html#CITEREF_kim_and_arakawa_1995">[37]</a>): <p class="formulaDsp">
\[ \tau_0=E\frac{m&#39;}{\triangle x}\frac{\rho_{0}U_0^3}{N_{0}}G&#39; \]
</p>
 where \(E\), \(m&#39;\), and \(G&#39;\) are the enhancement factor, "the number of mountains", and the flux function defined above, respectively.</li>
<li>Compute the drag above the reference level ( \(k\geq kref\)):<ul>
<li>Calculate the ratio of the Scorer parameter ( \(R_{scor}\)). <br />
 From a series of experiments, Kim and Arakawa (1995) <a class="el" href="citelist.html#CITEREF_kim_and_arakawa_1995">[37]</a> found that the magnitude of drag divergence tends to be underestimated by the revised scheme in low-level downstream regions with wave breaking. Therefore, at low levels when OA &gt; 0 (i.e., in the "downstream" region) the saturation hypothesis is replaced by the following formula based on the ratio of the the Scorer parameter: <p class="formulaDsp">
\[ R_{scor}=\min \left[\frac{\tau_i}{\tau_{i+1}},1\right] \]
</p>
</li>
<li>The drag above the reference level is expressed as: <p class="formulaDsp">
\[ \tau=\frac{m&#39;}{\triangle x}\rho NUh_d^2 \]
</p>
 where \(h_{d}\) is the displacement wave amplitude. In the absence of wave breaking, the displacement amplitude for the \(i^{th}\) layer can be expressed using the drag for the layer immediately below. Thus, assuming \(\tau_i=\tau_{i+1}\), we can get: <p class="formulaDsp">
\[ h_{d_i}^2=\frac{\triangle x}{m&#39;}\frac{\tau_{i+1}}{\rho_{i}N_{i}U_{i}} \]
</p>
</li>
</ul>
</li>
<li>The minimum Richardson number ( \(Ri_{m}\)) or local wave-modified Richardson number, which determines the onset of wave breaking, is expressed in terms of \(R_{i}\) and \(F_{r_{d}}=Nh_{d}/U\): <p class="formulaDsp">
\[ Ri_{m}=\frac{Ri(1-Fr_{d})}{(1+\sqrt{Ri}\cdot Fr_{d})^{2}} \]
</p>
 see eq.(4.6) in Kim and Arakawa (1995) <a class="el" href="citelist.html#CITEREF_kim_and_arakawa_1995">[37]</a>.<ul>
<li>Check stability to employ the 'saturation hypothesis' of Lindzen (1981) <a class="el" href="citelist.html#CITEREF_lindzen_1981">[40]</a> except at tropospheric downstream regions. <br />
 Wave breaking occurs when \(Ri_{m}&lt;Ri_{c}=0.25\). Then Lindzen's wave saturation hypothesis resets the displacement amplitude \(h_{d}\) to that corresponding to \(Ri_{m}=0.25\), we obtain the critical \(h_{d}\)(or \(h_{c}\)) expressed in terms of the mean values of \(U\), \(N\), and \(Ri\) ( eq.(4.7) in Kim and Arakawa (1995) <a class="el" href="citelist.html#CITEREF_kim_and_arakawa_1995">[37]</a>): <p class="formulaDsp">
\[ h_{c}=\frac{U}{N}\left\{2(2+\frac{1}{\sqrt{Ri}})^{1/2}-(2+\frac{1}{\sqrt{Ri}})\right\} \]
</p>
 if \(Ri_{m}\leq Ri_{c}\), obtain \(\tau\) from the drag above the reference level by using \(h_{c}\) computed above; otherwise \(\tau\) is unchanged (note: scaled by the ratio of the Scorer paramter).</li>
</ul>
</li>
<li>Calculate outputs: A, B, DUSFC, DVSFC (see parameter description).<ul>
<li>Below the dividing streamline height (k &lt; idxzb), mountain blocking( \(D_{b}\)) is applied.</li>
<li>Otherwise (k&gt;= idxzb), orographic GWD ( \(\tau\)) is applied. </li>
</ul>
</li>
</ul>

<p class="definition">Definition at line <a class="el" href="gwdps_8f_source.html#l00188">188</a> of file <a class="el" href="gwdps_8f_source.html">gwdps.f</a>.</p>

</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">Generated by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.13 </li>
  </ul>
</div>
</body>
</html>

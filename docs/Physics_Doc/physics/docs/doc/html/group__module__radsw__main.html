<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.13"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>GFS Physics Documentation: module_radsw_main</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { init_search(); });
</script>
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    extensions: ["tex2jax.js"],
    jax: ["input/TeX","output/HTML-CSS"],
});
</script><script type="text/javascript" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="ccpp_dox_extra_style.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="ncep.jpg"/></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">GFS Physics Documentation
   </div>
  </td>
   <td>        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
</td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.13 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('group__module__radsw__main.html','');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#groups">Modules</a> &#124;
<a href="#namespaces">Modules</a> &#124;
<a href="#func-members">Functions/Subroutines</a>  </div>
  <div class="headertitle">
<div class="title">module_radsw_main</div>  </div>
</div><!--header-->
<div class="contents">

<p>This module includes NCEP's modifications of the rrtmg-sw radiation code from AER.  
<a href="#details">More...</a></p>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<p>The SW radiation model in the current NOAA Environmental Modeling System (NEMS) was adapted from the RRTM radiation model developed by AER Inc. (Clough et al., 2005 <a class="el" href="citelist.html#CITEREF_clough_et_al_2005">[16]</a>; Mlawer et al., 1997 <a class="el" href="citelist.html#CITEREF_mlawer_et_al_1997">[46]</a>). It contains 14 spectral bands spanning a spectral wavenumber range of \(50000-820 cm^{-1}\) (corresponding to a wavelength range \(0.2-12.2\mu m\)), each spectral band focuses on a specific set of atmospheric absorbing species as shown in Table 1. To achieve great computation efficiency while at the same time to maintain a high degree of accuracy, the RRTM radiation model employs a corrected-k distribution method (i.e. mapping the highly spectral changing absorption coefficient, k, into a monotonic and smooth varying cumulative probability function, g). In the RRTM-SW, there are 16 unevenly distributed g points for each of the 14 bands for a total of 224 g points. The GCM version of the code (RRTMG-SW) uses a reduced number (various between 2 to 16) of g points for each of the bands that totals to 112 instead of the full set of 224. To get high quality for the scheme, many advanced techniques are used in RRTM such as carefully selecting the band structure to handle various major (key-species) and minor absorbers; deriving a binary parameter for a paired key molecular species in the same domain; and using two pressure regions (dividing level is at about 96mb) for optimal treatment of various species, etc.</p>
<p>Table 1. RRTMG-SW spectral bands and the corresponding absorbing species </p><table class="doxtable">
<tr>
<th>Band #</th><th>Wavenumber Range </th><th>Lower Atm (Key)</th><th>Lower Atm (Minor)</th><th>Mid/Up Atm (Key)</th><th>Mid/Up Atm (Minor)  </th></tr>
<tr>
<td>16 </td><td>2600-3250 </td><td>H2O,CH4 </td><td></td><td>CH4 </td><td></td></tr>
<tr>
<td>17 </td><td>3250-4000 </td><td>H2O,CO2 </td><td></td><td>H2O,CO2 </td><td></td></tr>
<tr>
<td>18 </td><td>4000-4650 </td><td>H2O,CH4 </td><td></td><td>CH4 </td><td></td></tr>
<tr>
<td>19 </td><td>4650-5150 </td><td>H2O,CO2 </td><td></td><td>CO2 </td><td></td></tr>
<tr>
<td>20 </td><td>5150-6150 </td><td>H2O </td><td>CH4 </td><td>H2O </td><td>CH4 </td></tr>
<tr>
<td>21 </td><td>6150-7700 </td><td>H2O,CO2 </td><td></td><td>H2O,CO2 </td><td></td></tr>
<tr>
<td>22 </td><td>7700-8050 </td><td>H2O,O2 </td><td></td><td>O2 </td><td></td></tr>
<tr>
<td>23 </td><td>8050-12850 </td><td>H2O </td><td></td><td>&mdash; </td><td></td></tr>
<tr>
<td>24 </td><td>12850-16000 </td><td>H2O,O2 </td><td>O3 </td><td>O2 </td><td>O3 </td></tr>
<tr>
<td>25 </td><td>16000-22650 </td><td>H2O </td><td>O3 </td><td>&mdash; </td><td>O3 </td></tr>
<tr>
<td>26 </td><td>22650-29000 </td><td>&mdash; </td><td></td><td>&mdash; </td><td></td></tr>
<tr>
<td>27 </td><td>29000-38000 </td><td>O3 </td><td></td><td>O3 </td><td></td></tr>
<tr>
<td>28 </td><td>38000-50000 </td><td>O3,O2 </td><td></td><td>O3,O2 </td><td></td></tr>
<tr>
<td>29 </td><td>820-2600 </td><td>H2O </td><td>CO2 </td><td>CO2 </td><td>H2O </td></tr>
</table>
<p><br />
 scattering due to clouds greatly complicate the SW radiative transfer computations. To balance the trade-off between computation and speed, RRTMG-SW uses a two-stream approximation method with a delta-function adjustment. Several variations of the delta-two method are included in the radiation transfer code; each holds its own strength and shortcomings (King and Harshvadhan, 1986 <a class="el" href="citelist.html#CITEREF_king_and_harshvardhan_1986">[38]</a> ; \(R\ddot{a}is\ddot{a}nen\),2002 <a class="el" href="citelist.html#CITEREF_raisanen_2002">[52]</a> ; Barker et al., 2015 <a class="el" href="citelist.html#CITEREF_barker_et_al_2015">[6]</a>). The default (the same in operation runs) selection (iswmode=2) activates the Practical Improved Flux Method (PIFM) by Zdunkowski et al.(1980) <a class="el" href="citelist.html#CITEREF_zdunkowski_et_al_1980">[64]</a> . In dealing with a column of cloudy atmosphere, two approaches are included in the RRTMG-SW. One is the commonly used treatment that sees each of the cloud contaminated layers as independent, partially and uniformly filled slabs. Cloud inhomogeneity within and the nature coherence among adjacent cloud layers are largely ignored to reduce the overwhelm complexities associated with scattering process. The effective layer reflectance and transmittance are weighted mean according to cloud fraction. The approach may overestimate cloud effect, especially for multi-layered cloud system associated with deep convection. In NEMS radiation code, to mitigate this shortcoming without increase computation cost, the cloud contaminated column is divided into two parts based on the column's total cloud coverage (a maximum-random overlapping is used in the operational models) to form a cloud free part and an overcast part. Layered clouds are then normalized by the total cloud amount before going through radiative transfer calculations. Fluxes from the cloud-free part and cloudy part are combined together to obtain the final result. <br />
 On the other hand, the Monte-Carlo Independent Column Approximation (McICA) (Pincus et al.,2003 <a class="el" href="citelist.html#CITEREF_pincus_et_al_2003">[50]</a> ; \(R\ddot{a}is\ddot{a}nen\) and Barker, 2004 <a class="el" href="citelist.html#CITEREF_raisanen_and_barker_2004">[51]</a>), provides a simple and effective way to solve cloud overlapping issue without increasing computational burden. The method is based on the concept of an ICA scheme that divides each grid column into a large number of sub-columns, and statistically redistributes layered clouds (under an assumed overlapping condition, such as the maximum-random method) into the sub-columns (i.e. at any layer it will be either clear or overcast). Thus the grid domain averaged flux under ICA scheme can be expressed as: </p><p class="formulaDsp">
\[ \overline{F}=\frac{1}{N}\sum_{n=1}^N F_{n} =\frac{1}{N}\sum_{n=1}^N\sum_{k=1}^K F_{n,k} \]
</p>
<p> Where \(N\) is the number of total sub-columns, and \(K\) is the number of spectral terms in integration. \(F_{n}\) is flux obtained in the \(n^{th}\) sub-column, that is the summation of total of \(K\) spectral corresponding fluxes, \(F_{n,k}\) . The double integrations (summations) make ICA impractical for GCM applications. The McICA method is to divide a model grid into \(K\) sub-columns and randomly to pair a sub-column's cloud profile with one of the radiative spectral intervals (e.g. the g-point in RRTM). The double summations will then be reduced to only one: </p><p class="formulaDsp">
\[ \overline{F}=\frac{1}{N}\sum_{n=1}^N\sum_{k=1}^K F_{n,k} \approx\overline{F}=\sum_{k=1}^K F_{S_{k},k} \]
</p>
<p>The RRTM-SW package includes three files:</p><ul>
<li><a class="el" href="radsw__param_8f.html" title="This file contains SW band parameters setup. ">radsw_param.f</a>, which contains:<ul>
<li><a class="el" href="namespacemodule__radsw__parameters.html" title="This module is for specifying the band structures and program parameters used by the RRTMG-SW scheme...">module_radsw_parameters</a>: specifies major parameters of the spectral bands and defines the construct structures of derived-type variables for holding the output results.</li>
</ul>
</li>
<li><a class="el" href="radsw__datatb_8f.html" title="This file contains many individual data modules with specifically precalculated data tables: ...">radsw_datatb.f</a>, which contains:<ul>
<li><a class="el" href="namespacemodule__radsw__ref.html" title="This module contains the reference pressures (in logarithm form) at 59 vertical levels (TOA is omitte...">module_radsw_ref</a>: reference temperature and pressure</li>
<li><a class="el" href="namespacemodule__radsw__cldprtb.html" title="This module contains cloud radiative property coefficients. ">module_radsw_cldprtb</a>: cloud property coefficients table</li>
<li><a class="el" href="namespacemodule__radsw__sflux.html" title="This module contains various indexes and coefficients for SW spectral bands, as well as the spectral ...">module_radsw_sflux</a>: indexes and coefficients for spectral distribution of solar flux</li>
<li>module_radsw_kgbnn: absorption coefficents for 14 bands, where nn = 16-29</li>
</ul>
</li>
<li>mersenne_twister.f, which contains:<ul>
<li>mersenne_twister: program of random number generators using the Mersenne-Twister algorithm</li>
</ul>
</li>
<li><a class="el" href="radsw__main_8f.html" title="This file contains NCEP&#39;s modifications of the rrtmg-sw radiation code from AER. ">radsw_main.f</a>, which contains:<ul>
<li>module_radsw_main: the main SW radiation computation programming source codes, which contains two externally callable subroutines:<ul>
<li><a class="el" href="group__module__radsw__main.html#ga784397878835a8cdd0b14a7b9eafb4e3" title="This subroutine is the main SW radiation routine. ">swrad()</a>: the main radiation routine</li>
<li><a class="el" href="group__module__radsw__main.html#ga5b0d35149515607d94f42b6ee5a40665" title="This subroutine initializes non-varying module variables, conversion factors, and look-up tables...">rswinit()</a>: the initialization routine</li>
</ul>
</li>
</ul>
</li>
</ul>
<dl class="section author"><dt>Author</dt><dd>Eli J. Mlawer, <a href="#" onclick="location.href='mai'+'lto:'+'eml'+'aw'+'er@'+'ae'+'r.c'+'om'; return false;">emlaw<span style="display: none;">.nosp@m.</span>er@a<span style="display: none;">.nosp@m.</span>er.co<span style="display: none;">.nosp@m.</span>m</a> </dd>
<dd>
Jennifer S. Delamere, <a href="#" onclick="location.href='mai'+'lto:'+'jde'+'la'+'mer'+'@a'+'er.'+'co'+'m'; return false;">jdela<span style="display: none;">.nosp@m.</span>mer@<span style="display: none;">.nosp@m.</span>aer.c<span style="display: none;">.nosp@m.</span>om</a> </dd>
<dd>
Michael J. Iacono, <a href="#" onclick="location.href='mai'+'lto:'+'mia'+'co'+'no@'+'ae'+'r.c'+'om'; return false;">miaco<span style="display: none;">.nosp@m.</span>no@a<span style="display: none;">.nosp@m.</span>er.co<span style="display: none;">.nosp@m.</span>m</a> </dd>
<dd>
Shepard A. Clough </dd></dl>
<dl class="section version"><dt>Version</dt><dd>NCEP SW v5.1 Nov 2012 -RRTMG-SW v3.8</dd></dl>
<p>The authors wish to acknowledge the contributions of the following people: Steven J. Taubman, Karen Cady-Pereira, Patrick D. Brown, Ronald E. Farren, Luke Chen, Robert Bergstrom.</p>
<dl class="section copyright"><dt>Copyright</dt><dd>2002-2007, Atmospheric &amp; Environmental Research, Inc. (AER). This software may be used, copied, or redistributed as long as it is not sold and this copyright notice is reproduced on each copy made. This model is provided as is without any express or implied warranties. (<a href="http://www.rtweb.aer.com/">http://www.rtweb.aer.com/</a>) </dd></dl>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="groups"></a>
Modules</h2></td></tr>
<tr class="memitem:group__module__radsw__kgbnn"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__module__radsw__kgbnn.html">module_radsw_kgbnn</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="namespaces"></a>
Modules</h2></td></tr>
<tr class="memitem:namespacemodule__radsw__parameters"><td class="memItemLeft" align="right" valign="top">module &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacemodule__radsw__parameters.html">module_radsw_parameters</a></td></tr>
<tr class="memdesc:namespacemodule__radsw__parameters"><td class="mdescLeft">&#160;</td><td class="mdescRight">This module is for specifying the band structures and program parameters used by the RRTMG-SW scheme. <br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions/Subroutines</h2></td></tr>
<tr class="memitem:ga5b0d35149515607d94f42b6ee5a40665"><td class="memItemLeft" align="right" valign="top">subroutine, public&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__module__radsw__main.html#ga5b0d35149515607d94f42b6ee5a40665">module_radsw_main::rswinit</a> (me)</td></tr>
<tr class="memdesc:ga5b0d35149515607d94f42b6ee5a40665"><td class="mdescLeft">&#160;</td><td class="mdescRight">This subroutine initializes non-varying module variables, conversion factors, and look-up tables.  <a href="group__module__radsw__main.html#ga5b0d35149515607d94f42b6ee5a40665">More...</a><br /></td></tr>
<tr class="separator:ga5b0d35149515607d94f42b6ee5a40665"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gadf2f35094ed7dc31e8f52781745cf021"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__module__radsw__main.html#gadf2f35094ed7dc31e8f52781745cf021">module_radsw_main::mcica_subcol</a> (cldf, nlay, ipseed, lcloudy)</td></tr>
<tr class="memdesc:gadf2f35094ed7dc31e8f52781745cf021"><td class="mdescLeft">&#160;</td><td class="mdescRight">This subroutine computes the sub-colum cloud profile flag array.  <a href="group__module__radsw__main.html#gadf2f35094ed7dc31e8f52781745cf021">More...</a><br /></td></tr>
<tr class="separator:gadf2f35094ed7dc31e8f52781745cf021"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga5eb9918ebc222138a9dad016440e1a74"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__module__radsw__main.html#ga5eb9918ebc222138a9dad016440e1a74">module_radsw_main::setcoef</a> (pavel, tavel, h2ovmr, nlay, nlp1, laytrop, jp, jt, jt1, fac00, fac01, fac10, fac11, selffac, selffrac, indself, forfac, forfrac, indfor)</td></tr>
<tr class="memdesc:ga5eb9918ebc222138a9dad016440e1a74"><td class="mdescLeft">&#160;</td><td class="mdescRight">This subroutine computes various coefficients needed in radiative transfer calculation.  <a href="group__module__radsw__main.html#ga5eb9918ebc222138a9dad016440e1a74">More...</a><br /></td></tr>
<tr class="separator:ga5eb9918ebc222138a9dad016440e1a74"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga859cc14063a58e9d0a252e4366b9fff3"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__module__radsw__main.html#ga859cc14063a58e9d0a252e4366b9fff3">module_radsw_main::spcvrtm</a> (ssolar, cosz, sntz, albbm, albdf, sfluxzen, cldfmc, cf1, cf0, taug, taur, tauae, ssaae, asyae, taucw, ssacw, asycw, nlay, nlp1, fxupc, fxdnc, fxup0, fxdn0, ftoauc, ftoau0, ftoadc, fsfcuc, fsfcu0, fsfcdc, fsfcd0, sfbmc, sfdfc, sfbm0, sfdf0, suvbfc, suvbf0)</td></tr>
<tr class="memdesc:ga859cc14063a58e9d0a252e4366b9fff3"><td class="mdescLeft">&#160;</td><td class="mdescRight">This subroutine computes the shortwave radiative fluxes using two-stream method of h. barder and mcica,the monte-carlo independent column approximation, for the representation of sub-grid cloud variability (i.e. cloud overlap).  <a href="group__module__radsw__main.html#ga859cc14063a58e9d0a252e4366b9fff3">More...</a><br /></td></tr>
<tr class="separator:ga859cc14063a58e9d0a252e4366b9fff3"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="member-group"></a>
constant values</h2></td></tr>
<tr class="memitem:ga7d311ceb7f824ea31d31ba8144751b5a"><td class="memItemLeft" align="right" valign="top"><a id="ga7d311ceb7f824ea31d31ba8144751b5a"></a>
real(kind=kind_phys), parameter&#160;</td><td class="memItemRight" valign="bottom"><b>module_radsw_main::eps</b> = 1.0e-6</td></tr>
<tr class="separator:ga7d311ceb7f824ea31d31ba8144751b5a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gac666738c31ea648cae506a47e5a4e43d"><td class="memItemLeft" align="right" valign="top"><a id="gac666738c31ea648cae506a47e5a4e43d"></a>
real(kind=kind_phys), parameter&#160;</td><td class="memItemRight" valign="bottom"><b>module_radsw_main::oneminus</b> = 1.0 - eps</td></tr>
<tr class="separator:gac666738c31ea648cae506a47e5a4e43d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gacd9ae7c14cbfdc55f1f0fff637ca0331"><td class="memItemLeft" align="right" valign="top"><a id="gacd9ae7c14cbfdc55f1f0fff637ca0331"></a>
real(kind=kind_phys), parameter&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__module__radsw__main.html#gacd9ae7c14cbfdc55f1f0fff637ca0331">module_radsw_main::bpade</a> = 1.0/0.278</td></tr>
<tr class="memdesc:gacd9ae7c14cbfdc55f1f0fff637ca0331"><td class="mdescLeft">&#160;</td><td class="mdescRight">pade approx constant <br /></td></tr>
<tr class="separator:gacd9ae7c14cbfdc55f1f0fff637ca0331"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga4d32ea8f0f1bca37e3351a5ae5077f77"><td class="memItemLeft" align="right" valign="top"><a id="ga4d32ea8f0f1bca37e3351a5ae5077f77"></a>
real(kind=kind_phys), parameter&#160;</td><td class="memItemRight" valign="bottom"><b>module_radsw_main::stpfac</b> = 296.0/1013.0</td></tr>
<tr class="separator:ga4d32ea8f0f1bca37e3351a5ae5077f77"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gabe91ed52b6016e99a2d0c874524fb27f"><td class="memItemLeft" align="right" valign="top"><a id="gabe91ed52b6016e99a2d0c874524fb27f"></a>
real(kind=kind_phys), parameter&#160;</td><td class="memItemRight" valign="bottom"><b>module_radsw_main::ftiny</b> = 1.0e-12</td></tr>
<tr class="separator:gabe91ed52b6016e99a2d0c874524fb27f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gac3fcae797833888c5f47fc5ed821c06f"><td class="memItemLeft" align="right" valign="top"><a id="gac3fcae797833888c5f47fc5ed821c06f"></a>
real(kind=kind_phys), parameter&#160;</td><td class="memItemRight" valign="bottom"><b>module_radsw_main::flimit</b> = 1.0e-20</td></tr>
<tr class="separator:gac3fcae797833888c5f47fc5ed821c06f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga244c149eb05c0675a7e040dbf7e2bc4b"><td class="memItemLeft" align="right" valign="top"><a id="ga244c149eb05c0675a7e040dbf7e2bc4b"></a>
real(kind=kind_phys), parameter&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__module__radsw__main.html#ga244c149eb05c0675a7e040dbf7e2bc4b">module_radsw_main::s0</a> = 1368.22</td></tr>
<tr class="memdesc:ga244c149eb05c0675a7e040dbf7e2bc4b"><td class="mdescLeft">&#160;</td><td class="mdescRight">internal solar constant <br /></td></tr>
<tr class="separator:ga244c149eb05c0675a7e040dbf7e2bc4b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gad54ac2d2bd5c4b3bd692c76d2a0bcc5d"><td class="memItemLeft" align="right" valign="top"><a id="gad54ac2d2bd5c4b3bd692c76d2a0bcc5d"></a>
real(kind=kind_phys), parameter&#160;</td><td class="memItemRight" valign="bottom"><b>module_radsw_main::f_zero</b> = 0.0</td></tr>
<tr class="separator:gad54ac2d2bd5c4b3bd692c76d2a0bcc5d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gad256aaca9c9d6b5d161ae21f68989db6"><td class="memItemLeft" align="right" valign="top"><a id="gad256aaca9c9d6b5d161ae21f68989db6"></a>
real(kind=kind_phys), parameter&#160;</td><td class="memItemRight" valign="bottom"><b>module_radsw_main::f_one</b> = 1.0</td></tr>
<tr class="separator:gad256aaca9c9d6b5d161ae21f68989db6"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="member-group"></a>
atomic weights for conversion from mass to volume mixing ratios</h2></td></tr>
<tr class="memitem:ga1445a63250d89083447371120c484618"><td class="memItemLeft" align="right" valign="top"><a id="ga1445a63250d89083447371120c484618"></a>
real(kind=kind_phys), parameter&#160;</td><td class="memItemRight" valign="bottom"><b>module_radsw_main::amdw</b> = con_amd/con_amw</td></tr>
<tr class="separator:ga1445a63250d89083447371120c484618"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga527e5e1cec6ad0800f69a606fde77369"><td class="memItemLeft" align="right" valign="top"><a id="ga527e5e1cec6ad0800f69a606fde77369"></a>
real(kind=kind_phys), parameter&#160;</td><td class="memItemRight" valign="bottom"><b>module_radsw_main::amdo3</b> = con_amd/con_amo3</td></tr>
<tr class="separator:ga527e5e1cec6ad0800f69a606fde77369"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="member-group"></a>
band indices</h2></td></tr>
<tr class="memitem:ga4c0fc140a51c619089128f52e4bb878c"><td class="memItemLeft" align="right" valign="top"><a id="ga4c0fc140a51c619089128f52e4bb878c"></a>
integer, dimension(nblow:nbhgh)&#160;</td><td class="memItemRight" valign="bottom"><b>module_radsw_main::nspa</b></td></tr>
<tr class="separator:ga4c0fc140a51c619089128f52e4bb878c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga6be022a4a1ae32248d9721a9fff93db6"><td class="memItemLeft" align="right" valign="top"><a id="ga6be022a4a1ae32248d9721a9fff93db6"></a>
integer, dimension(nblow:nbhgh)&#160;</td><td class="memItemRight" valign="bottom"><b>module_radsw_main::nspb</b></td></tr>
<tr class="separator:ga6be022a4a1ae32248d9721a9fff93db6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gad295d723dd7d269cb51c73923a4cbb94"><td class="memItemLeft" align="right" valign="top"><a id="gad295d723dd7d269cb51c73923a4cbb94"></a>
integer, dimension(nblow:nbhgh)&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__module__radsw__main.html#gad295d723dd7d269cb51c73923a4cbb94">module_radsw_main::idxsfc</a></td></tr>
<tr class="memdesc:gad295d723dd7d269cb51c73923a4cbb94"><td class="mdescLeft">&#160;</td><td class="mdescRight">band index for sfc flux <br /></td></tr>
<tr class="separator:gad295d723dd7d269cb51c73923a4cbb94"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gaa20102786f7e7f8c71fb2783082eac1b"><td class="memItemLeft" align="right" valign="top"><a id="gaa20102786f7e7f8c71fb2783082eac1b"></a>
integer, dimension(nblow:nbhgh)&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__module__radsw__main.html#gaa20102786f7e7f8c71fb2783082eac1b">module_radsw_main::idxebc</a></td></tr>
<tr class="memdesc:gaa20102786f7e7f8c71fb2783082eac1b"><td class="mdescLeft">&#160;</td><td class="mdescRight">band index for cld prop <br /></td></tr>
<tr class="separator:gaa20102786f7e7f8c71fb2783082eac1b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga177282b3087dce2f54f1233ee8631231"><td class="memItemLeft" align="right" valign="top"><a id="ga177282b3087dce2f54f1233ee8631231"></a>
integer, parameter&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__module__radsw__main.html#ga177282b3087dce2f54f1233ee8631231">module_radsw_main::nuvb</a> = 27</td></tr>
<tr class="memdesc:ga177282b3087dce2f54f1233ee8631231"><td class="mdescLeft">&#160;</td><td class="mdescRight">uv-b band index <br /></td></tr>
<tr class="separator:ga177282b3087dce2f54f1233ee8631231"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="member-group"></a>
logical flags for optional output fields</h2></td></tr>
<tr class="memitem:ga08bfecbd5edb2ad3ba0ae836cfe18d05"><td class="memItemLeft" align="right" valign="top"><a id="ga08bfecbd5edb2ad3ba0ae836cfe18d05"></a>
logical&#160;</td><td class="memItemRight" valign="bottom"><b>module_radsw_main::lhswb</b> = .false.</td></tr>
<tr class="separator:ga08bfecbd5edb2ad3ba0ae836cfe18d05"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga3fd8cae0d38772eea36ce6ec2d258997"><td class="memItemLeft" align="right" valign="top"><a id="ga3fd8cae0d38772eea36ce6ec2d258997"></a>
logical&#160;</td><td class="memItemRight" valign="bottom"><b>module_radsw_main::lhsw0</b> = .false.</td></tr>
<tr class="separator:ga3fd8cae0d38772eea36ce6ec2d258997"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gac4ab674edb40fda0c89aa8ee331ccdc6"><td class="memItemLeft" align="right" valign="top"><a id="gac4ab674edb40fda0c89aa8ee331ccdc6"></a>
logical&#160;</td><td class="memItemRight" valign="bottom"><b>module_radsw_main::lflxprf</b> = .false.</td></tr>
<tr class="separator:gac4ab674edb40fda0c89aa8ee331ccdc6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga8c0a241d6c1aa69fee4cd24fdbc4256b"><td class="memItemLeft" align="right" valign="top"><a id="ga8c0a241d6c1aa69fee4cd24fdbc4256b"></a>
logical&#160;</td><td class="memItemRight" valign="bottom"><b>module_radsw_main::lfdncmp</b> = .false.</td></tr>
<tr class="separator:ga8c0a241d6c1aa69fee4cd24fdbc4256b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga1f9d18b17cc24321ed1cf45254ac2b0f"><td class="memItemLeft" align="right" valign="top"><a id="ga1f9d18b17cc24321ed1cf45254ac2b0f"></a>
real(kind=kind_phys), dimension(0:ntbmx)&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__module__radsw__main.html#ga1f9d18b17cc24321ed1cf45254ac2b0f">module_radsw_main::exp_tbl</a></td></tr>
<tr class="memdesc:ga1f9d18b17cc24321ed1cf45254ac2b0f"><td class="mdescLeft">&#160;</td><td class="mdescRight">those data will be set up only once by "rswinit" <br /></td></tr>
<tr class="separator:ga1f9d18b17cc24321ed1cf45254ac2b0f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gaad60e753cdda20d4e84d063280f0dfcc"><td class="memItemLeft" align="right" valign="top"><a id="gaad60e753cdda20d4e84d063280f0dfcc"></a>
real(kind=kind_phys)&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__module__radsw__main.html#gaad60e753cdda20d4e84d063280f0dfcc">module_radsw_main::heatfac</a></td></tr>
<tr class="memdesc:gaad60e753cdda20d4e84d063280f0dfcc"><td class="mdescLeft">&#160;</td><td class="mdescRight">the factor for heating rates (in k/day, or k/sec set by subroutine 'rswinit') <br /></td></tr>
<tr class="separator:gaad60e753cdda20d4e84d063280f0dfcc"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gae1f88a0b60d69b892cfae83bb9ab67df"><td class="memItemLeft" align="right" valign="top"><a id="gae1f88a0b60d69b892cfae83bb9ab67df"></a>
integer, parameter&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__module__radsw__main.html#gae1f88a0b60d69b892cfae83bb9ab67df">module_radsw_main::ipsdsw0</a> = 1</td></tr>
<tr class="memdesc:gae1f88a0b60d69b892cfae83bb9ab67df"><td class="mdescLeft">&#160;</td><td class="mdescRight">initial permutation seed used for sub-column cloud scheme <br /></td></tr>
<tr class="separator:gae1f88a0b60d69b892cfae83bb9ab67df"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga784397878835a8cdd0b14a7b9eafb4e3"><td class="memItemLeft" align="right" valign="top">subroutine, public&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__module__radsw__main.html#ga784397878835a8cdd0b14a7b9eafb4e3">module_radsw_main::swrad</a> (plyr, plvl, tlyr, tlvl, qlyr, olyr, gasvmr, clouds, icseed, aerosols, sfcalb, cosz, solcon, NDAY, idxday, npts, nlay, nlp1, lprnt, hswc, topflx, sfcflx, HSW0, HSWB, FLXPRF, FDNCMP)</td></tr>
<tr class="memdesc:ga784397878835a8cdd0b14a7b9eafb4e3"><td class="mdescLeft">&#160;</td><td class="mdescRight">This subroutine is the main SW radiation routine.  <a href="group__module__radsw__main.html#ga784397878835a8cdd0b14a7b9eafb4e3">More...</a><br /></td></tr>
<tr class="separator:ga784397878835a8cdd0b14a7b9eafb4e3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga89ca572fa54a63a21009caa0760d405b"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__module__radsw__main.html#ga89ca572fa54a63a21009caa0760d405b">module_radsw_main::cldprop</a> (cfrac, cliqp, reliq, cicep, reice, cdat1, cdat2, cdat3, cdat4, cf1, nlay, ipseed, taucw, ssacw, asycw, cldfrc, cldfmc)</td></tr>
<tr class="memdesc:ga89ca572fa54a63a21009caa0760d405b"><td class="mdescLeft">&#160;</td><td class="mdescRight">This subroutine computes the cloud optical properties for each cloudy layer and g-point interval.  <a href="group__module__radsw__main.html#ga89ca572fa54a63a21009caa0760d405b">More...</a><br /></td></tr>
<tr class="separator:ga89ca572fa54a63a21009caa0760d405b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gaeb992f35bdf7dbf9ea8709d7d91dedfd"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__module__radsw__main.html#gaeb992f35bdf7dbf9ea8709d7d91dedfd">module_radsw_main::spcvrtc</a> (ssolar, cosz, sntz, albbm, albdf, sfluxzen, cldfrc, cf1, cf0, taug, taur, tauae, ssaae, asyae, taucw, ssacw, asycw, nlay, nlp1, fxupc, fxdnc, fxup0, fxdn0, ftoauc, ftoau0, ftoadc, fsfcuc, fsfcu0, fsfcdc, fsfcd0, sfbmc, sfdfc, sfbm0, sfdf0, suvbfc, suvbf0)</td></tr>
<tr class="memdesc:gaeb992f35bdf7dbf9ea8709d7d91dedfd"><td class="mdescLeft">&#160;</td><td class="mdescRight">This subroutine computes the shortwave radiative fluxes using two-stream method.  <a href="group__module__radsw__main.html#gaeb992f35bdf7dbf9ea8709d7d91dedfd">More...</a><br /></td></tr>
<tr class="separator:gaeb992f35bdf7dbf9ea8709d7d91dedfd"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gad227ccde86a01f47c1ab3b4bed5ba1be"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__module__radsw__main.html#gad227ccde86a01f47c1ab3b4bed5ba1be">module_radsw_main::vrtqdr</a> (zrefb, zrefd, ztrab, ztrad, zldbt, ztdbt, NLAY, NLP1, zfu, zfd)</td></tr>
<tr class="memdesc:gad227ccde86a01f47c1ab3b4bed5ba1be"><td class="mdescLeft">&#160;</td><td class="mdescRight">This subroutine is called by <a class="el" href="group__module__radsw__main.html#gaeb992f35bdf7dbf9ea8709d7d91dedfd" title="This subroutine computes the shortwave radiative fluxes using two-stream method. ">spcvrtc()</a> and <a class="el" href="group__module__radsw__main.html#ga859cc14063a58e9d0a252e4366b9fff3" title="This subroutine computes the shortwave radiative fluxes using two-stream method of h...">spcvrtm()</a>, and computes the upward and downward radiation fluxes.  <a href="group__module__radsw__main.html#gad227ccde86a01f47c1ab3b4bed5ba1be">More...</a><br /></td></tr>
<tr class="separator:gad227ccde86a01f47c1ab3b4bed5ba1be"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gaa82121d21c1e8f2ca938378249fea135"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__module__radsw__main.html#gaa82121d21c1e8f2ca938378249fea135">module_radsw_main::taumol</a> (colamt, colmol, fac00, fac01, fac10, fac11, jp, jt, jt1, laytrop, forfac, forfrac, indfor, selffac, selffrac, indself, nlay, sfluxzen, taug, taur)</td></tr>
<tr class="memdesc:gaa82121d21c1e8f2ca938378249fea135"><td class="mdescLeft">&#160;</td><td class="mdescRight">This subroutine calculates optical depths for gaseous absorption and rayleigh scattering <br />
 subroutine called taumol## (## = 16-29)  <a href="group__module__radsw__main.html#gaa82121d21c1e8f2ca938378249fea135">More...</a><br /></td></tr>
<tr class="separator:gaa82121d21c1e8f2ca938378249fea135"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga8702f5f6285ff1a5cbfad740545fffb6"><td class="memItemLeft" align="right" valign="top"><a id="ga8702f5f6285ff1a5cbfad740545fffb6"></a>
subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__module__radsw__main.html#ga8702f5f6285ff1a5cbfad740545fffb6">taumol16</a></td></tr>
<tr class="memdesc:ga8702f5f6285ff1a5cbfad740545fffb6"><td class="mdescLeft">&#160;</td><td class="mdescRight">The subroutine computes the optical depth in band 16: 2600-3250 cm-1 (low - h2o,ch4; high - ch4) <br /></td></tr>
<tr class="separator:ga8702f5f6285ff1a5cbfad740545fffb6"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<h2 class="groupheader">Function/Subroutine Documentation</h2>
<a id="ga89ca572fa54a63a21009caa0760d405b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga89ca572fa54a63a21009caa0760d405b">&#9670;&nbsp;</a></span>cldprop()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">subroutine module_radsw_main::cldprop </td>
          <td>(</td>
          <td class="paramtype">real (kind=kind_phys), dimension(nlay), intent(in)&#160;</td>
          <td class="paramname"><em>cfrac</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real (kind=kind_phys), dimension(nlay), intent(in)&#160;</td>
          <td class="paramname"><em>cliqp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real (kind=kind_phys), dimension(nlay), intent(in)&#160;</td>
          <td class="paramname"><em>reliq</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real (kind=kind_phys), dimension(nlay), intent(in)&#160;</td>
          <td class="paramname"><em>cicep</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real (kind=kind_phys), dimension(nlay), intent(in)&#160;</td>
          <td class="paramname"><em>reice</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real (kind=kind_phys), dimension(nlay), intent(in)&#160;</td>
          <td class="paramname"><em>cdat1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real (kind=kind_phys), dimension(nlay), intent(in)&#160;</td>
          <td class="paramname"><em>cdat2</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real (kind=kind_phys), dimension(nlay), intent(in)&#160;</td>
          <td class="paramname"><em>cdat3</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real (kind=kind_phys), dimension(nlay), intent(in)&#160;</td>
          <td class="paramname"><em>cdat4</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real (kind=kind_phys), intent(in)&#160;</td>
          <td class="paramname"><em>cf1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>nlay</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>ipseed</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real (kind=kind_phys), dimension(nlay,nbdsw), intent(out)&#160;</td>
          <td class="paramname"><em>taucw</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real (kind=kind_phys), dimension(nlay,nbdsw), intent(out)&#160;</td>
          <td class="paramname"><em>ssacw</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real (kind=kind_phys), dimension(nlay,nbdsw), intent(out)&#160;</td>
          <td class="paramname"><em>asycw</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real (kind=kind_phys), dimension(nlay), intent(out)&#160;</td>
          <td class="paramname"><em>cldfrc</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real (kind=kind_phys), dimension(nlay,ngptsw), intent(out)&#160;</td>
          <td class="paramname"><em>cldfmc</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">cfrac</td><td>layer cloud fraction <br />
 for physparam::iswcliq &gt; 0 (prognostic cloud scheme) - - - </td></tr>
    <tr><td class="paramname">cliqp</td><td>layer in-cloud liq water path ( \(g/m^2\)) </td></tr>
    <tr><td class="paramname">reliq</td><td>mean eff radius for liq cloud (micron) </td></tr>
    <tr><td class="paramname">cicep</td><td>layer in-cloud ice water path ( \(g/m^2\)) </td></tr>
    <tr><td class="paramname">reice</td><td>mean eff radius for ice cloud (micron) </td></tr>
    <tr><td class="paramname">cdat1</td><td>layer rain drop water path ( \(g/m^2\)) </td></tr>
    <tr><td class="paramname">cdat2</td><td>effective radius for rain drop (micron) </td></tr>
    <tr><td class="paramname">cdat3</td><td>layer snow flake water path( \(g/m^2\)) </td></tr>
    <tr><td class="paramname">cdat4</td><td>mean eff radius for snow flake(micron) <br />
 for physparam::iswcliq = 0 (diagnostic cloud scheme) - - - </td></tr>
    <tr><td class="paramname">cliqp</td><td>not used </td></tr>
    <tr><td class="paramname">cicep</td><td>not used </td></tr>
    <tr><td class="paramname">reliq</td><td>not used </td></tr>
    <tr><td class="paramname">reice</td><td>not used </td></tr>
    <tr><td class="paramname">cdat1</td><td>layer cloud optical depth </td></tr>
    <tr><td class="paramname">cdat2</td><td>layer cloud single scattering albedo </td></tr>
    <tr><td class="paramname">cdat3</td><td>layer cloud asymmetry factor </td></tr>
    <tr><td class="paramname">cdat4</td><td>optional use </td></tr>
    <tr><td class="paramname">cf1</td><td>effective total cloud cover at surface </td></tr>
    <tr><td class="paramname">nlay</td><td>vertical layer number </td></tr>
    <tr><td class="paramname">ipseed</td><td>permutation seed for generating random numbers (isubcsw&gt;0) </td></tr>
    <tr><td class="paramname">taucw</td><td>cloud optical depth, w/o delta scaled </td></tr>
    <tr><td class="paramname">ssacw</td><td>weighted cloud single scattering albedo (ssa = ssacw / taucw) </td></tr>
    <tr><td class="paramname">asycw</td><td>weighted cloud asymmetry factor (asy = asycw / ssacw) </td></tr>
    <tr><td class="paramname">cldfrc</td><td>cloud fraction of grid mean value </td></tr>
    <tr><td class="paramname">cldfmc</td><td>cloud fraction for each sub-column </td></tr>
  </table>
  </dd>
</dl>
<h1><a class="anchor" id="General_cldprop"></a>
General Algorithm</h1>
<ol type="1">
<li>Compute cloud radiative properties for a cloudy column.<ul>
<li>Compute optical properties for rain and snow. <br />
 For rain: tauran/ssaran/asyran <br />
 For snow: tausnw/ssasnw/asysnw</li>
<li>Calculation of absorption coefficients due to water clouds <br />
 For water clouds: tauliq/ssaliq/asyliq</li>
<li>Calculation of absorption coefficients due to ice clouds <br />
 For ice clouds: tauice/ssaice/asyice</li>
<li>For Prognostic cloud scheme: sum up the cloud optical property: <br />
 \( taucw=tauliq+tauice+tauran+tausnw \) <br />
 \( ssacw=ssaliq+ssaice+ssaran+ssasnw \) <br />
 \( asycw=asyliq+asyice+asyran+asysnw \)</li>
</ul>
</li>
<li>if physparam::isubcsw &gt; 0, call <a class="el" href="group__module__radlw__main.html#ga9318778651bca6ec1f1776da6c21dfda" title="This suroutine computes sub-colum cloud profile flag array. ">mcica_subcol()</a> to distribute cloud properties to each g-point. </li>
</ol>

<p class="definition">Definition at line <a class="el" href="radsw__main_8f_source.html#l01568">1568</a> of file <a class="el" href="radsw__main_8f_source.html">radsw_main.f</a>.</p>

<p class="reference">References <a class="el" href="radsw__datatb_8f_source.html#l01906">module_radsw_cldprtb::a0r</a>, <a class="el" href="radsw__datatb_8f_source.html#l01897">module_radsw_cldprtb::a0s</a>, <a class="el" href="radsw__datatb_8f_source.html#l00270">module_radsw_cldprtb::abari</a>, <a class="el" href="radsw__datatb_8f_source.html#l00249">module_radsw_cldprtb::asyice2</a>, <a class="el" href="radsw__datatb_8f_source.html#l00261">module_radsw_cldprtb::asyice3</a>, <a class="el" href="radsw__datatb_8f_source.html#l00238">module_radsw_cldprtb::asyliq1</a>, <a class="el" href="radsw__datatb_8f_source.html#l01908">module_radsw_cldprtb::b0r</a>, <a class="el" href="radsw__datatb_8f_source.html#l01899">module_radsw_cldprtb::b0s</a>, <a class="el" href="radsw__datatb_8f_source.html#l00272">module_radsw_cldprtb::bbari</a>, <a class="el" href="radsw__datatb_8f_source.html#l01910">module_radsw_cldprtb::c0r</a>, <a class="el" href="radsw__datatb_8f_source.html#l01901">module_radsw_cldprtb::c0s</a>, <a class="el" href="radsw__datatb_8f_source.html#l00274">module_radsw_cldprtb::cbari</a>, <a class="el" href="radsw__datatb_8f_source.html#l00276">module_radsw_cldprtb::dbari</a>, <a class="el" href="radsw__datatb_8f_source.html#l00278">module_radsw_cldprtb::ebari</a>, <a class="el" href="radsw__datatb_8f_source.html#l00243">module_radsw_cldprtb::extice2</a>, <a class="el" href="radsw__datatb_8f_source.html#l00255">module_radsw_cldprtb::extice3</a>, <a class="el" href="radsw__datatb_8f_source.html#l00232">module_radsw_cldprtb::extliq1</a>, <a class="el" href="radsw__datatb_8f_source.html#l00280">module_radsw_cldprtb::fbari</a>, <a class="el" href="radsw__main_8f_source.html#l00462">idxebc</a>, <a class="el" href="radsw__main_8f_source.html#l01928">mcica_subcol()</a>, <a class="el" href="radsw__param_8f_source.html#l00130">module_radsw_parameters::nbhgh</a>, <a class="el" href="radsw__param_8f_source.html#l00128">module_radsw_parameters::nblow</a>, <a class="el" href="radsw__param_8f_source.html#l00134">module_radsw_parameters::ngptsw</a>, <a class="el" href="radsw__datatb_8f_source.html#l00246">module_radsw_cldprtb::ssaice2</a>, <a class="el" href="radsw__datatb_8f_source.html#l00258">module_radsw_cldprtb::ssaice3</a>, and <a class="el" href="radsw__datatb_8f_source.html#l00235">module_radsw_cldprtb::ssaliq1</a>.</p>

<p class="reference">Referenced by <a class="el" href="radsw__main_8f_source.html#l00594">swrad()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="group__module__radsw__main_ga89ca572fa54a63a21009caa0760d405b_cgraph.png" border="0" usemap="#group__module__radsw__main_ga89ca572fa54a63a21009caa0760d405b_cgraph" alt=""/></div>
<!-- MAP 0 -->
</div>

</div>
</div>
<a id="gadf2f35094ed7dc31e8f52781745cf021"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gadf2f35094ed7dc31e8f52781745cf021">&#9670;&nbsp;</a></span>mcica_subcol()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">subroutine module_radsw_main::mcica_subcol </td>
          <td>(</td>
          <td class="paramtype">real (kind=kind_phys), dimension(nlay), intent(in)&#160;</td>
          <td class="paramname"><em>cldf</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>nlay</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>ipseed</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">logical, dimension(nlay,ngptsw), intent(out)&#160;</td>
          <td class="paramname"><em>lcloudy</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">cldf</td><td>layer cloud fraction </td></tr>
    <tr><td class="paramname">nlay</td><td>number of model vertical layers </td></tr>
    <tr><td class="paramname">ipseed</td><td>permute seed for random num generator </td></tr>
    <tr><td class="paramname">lcloudy</td><td>sub-colum cloud profile flag array </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="radsw__main_8f_source.html#l01928">1928</a> of file <a class="el" href="radsw__main_8f_source.html">radsw_main.f</a>.</p>

<p class="reference">References <a class="el" href="radsw__param_8f_source.html#l00134">module_radsw_parameters::ngptsw</a>.</p>

<p class="reference">Referenced by <a class="el" href="radsw__main_8f_source.html#l01568">cldprop()</a>.</p>

</div>
</div>
<a id="ga5b0d35149515607d94f42b6ee5a40665"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga5b0d35149515607d94f42b6ee5a40665">&#9670;&nbsp;</a></span>rswinit()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine, public module_radsw_main::rswinit </td>
          <td>(</td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>me</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">me</td><td>print control for parallel process </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="radsw__main_8f_source.html#l01379">1379</a> of file <a class="el" href="radsw__main_8f_source.html">radsw_main.f</a>.</p>

<p class="reference">References <a class="el" href="radsw__main_8f_source.html#l00443">bpade</a>, <a class="el" href="radsw__main_8f_source.html#l00495">exp_tbl</a>, <a class="el" href="radsw__main_8f_source.html#l00500">heatfac</a>, and <a class="el" href="radsw__param_8f_source.html#l00140">module_radsw_parameters::ntbmx</a>.</p>

<p class="reference">Referenced by <a class="el" href="_g_f_s__radiation__driver_8_f90_source.html#l00417">module_radiation_driver::radinit()</a>.</p>

</div>
</div>
<a id="ga5eb9918ebc222138a9dad016440e1a74"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga5eb9918ebc222138a9dad016440e1a74">&#9670;&nbsp;</a></span>setcoef()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">subroutine module_radsw_main::setcoef </td>
          <td>(</td>
          <td class="paramtype">real (kind=kind_phys), dimension(:), intent(in)&#160;</td>
          <td class="paramname"><em>pavel</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real (kind=kind_phys), dimension(:), intent(in)&#160;</td>
          <td class="paramname"><em>tavel</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real (kind=kind_phys), dimension(:), intent(in)&#160;</td>
          <td class="paramname"><em>h2ovmr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>nlay</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>nlp1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(out)&#160;</td>
          <td class="paramname"><em>laytrop</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, dimension(nlay), intent(out)&#160;</td>
          <td class="paramname"><em>jp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, dimension(nlay), intent(out)&#160;</td>
          <td class="paramname"><em>jt</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, dimension(nlay), intent(out)&#160;</td>
          <td class="paramname"><em>jt1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real (kind=kind_phys), dimension(nlay), intent(out)&#160;</td>
          <td class="paramname"><em>fac00</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real (kind=kind_phys), dimension(nlay), intent(out)&#160;</td>
          <td class="paramname"><em>fac01</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real (kind=kind_phys), dimension(nlay), intent(out)&#160;</td>
          <td class="paramname"><em>fac10</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real (kind=kind_phys), dimension(nlay), intent(out)&#160;</td>
          <td class="paramname"><em>fac11</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real (kind=kind_phys), dimension(nlay), intent(out)&#160;</td>
          <td class="paramname"><em>selffac</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real (kind=kind_phys), dimension(nlay), intent(out)&#160;</td>
          <td class="paramname"><em>selffrac</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, dimension(nlay), intent(out)&#160;</td>
          <td class="paramname"><em>indself</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real (kind=kind_phys), dimension(nlay), intent(out)&#160;</td>
          <td class="paramname"><em>forfac</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real (kind=kind_phys), dimension(nlay), intent(out)&#160;</td>
          <td class="paramname"><em>forfrac</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, dimension(nlay), intent(out)&#160;</td>
          <td class="paramname"><em>indfor</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">pavel</td><td>layer pressure (mb) </td></tr>
    <tr><td class="paramname">tavel</td><td>layer temperature (k) </td></tr>
    <tr><td class="paramname">h2ovmr</td><td>layer w.v. volumn mixing ratio (kg/kg) </td></tr>
    <tr><td class="paramname">nlay</td><td>total number of vertical layers </td></tr>
    <tr><td class="paramname">nlp1</td><td>total number of vertical levels </td></tr>
    <tr><td class="paramname">laytrop</td><td>tropopause layer index (unitless) </td></tr>
    <tr><td class="paramname">jp</td><td>indices of lower reference pressure </td></tr>
    <tr><td class="paramname">jt,jt1</td><td>indices of lower reference temperatures at levels of jp and jp+1 </td></tr>
    <tr><td class="paramname">facij</td><td>factors mltiply the reference ks,i,j=0/1 for lower/higher of the 2 appropriate temperature and altitudes. </td></tr>
    <tr><td class="paramname">selffac</td><td>scale factor for w. v. self-continuum equals (w.v. density)/(atmospheric density at 296k and 1013 mb) </td></tr>
    <tr><td class="paramname">seffrac</td><td>factor for temperature interpolation of reference w.v. self-continuum data </td></tr>
    <tr><td class="paramname">indself</td><td>index of lower ref temp for selffac </td></tr>
    <tr><td class="paramname">forfac</td><td>scale factor for w. v. foreign-continuum </td></tr>
    <tr><td class="paramname">forfrac</td><td>factor for temperature interpolation of reference w.v. foreign-continuum data </td></tr>
    <tr><td class="paramname">indfor</td><td>index of lower ref temp for forfac </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="radsw__main_8f_source.html#l02111">2111</a> of file <a class="el" href="radsw__main_8f_source.html">radsw_main.f</a>.</p>

<p class="reference">References <a class="el" href="radsw__datatb_8f_source.html#l00083">module_radsw_ref::preflog</a>, and <a class="el" href="radsw__datatb_8f_source.html#l00085">module_radsw_ref::tref</a>.</p>

<p class="reference">Referenced by <a class="el" href="radsw__main_8f_source.html#l00594">swrad()</a>.</p>

</div>
</div>
<a id="gaeb992f35bdf7dbf9ea8709d7d91dedfd"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gaeb992f35bdf7dbf9ea8709d7d91dedfd">&#9670;&nbsp;</a></span>spcvrtc()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">subroutine module_radsw_main::spcvrtc </td>
          <td>(</td>
          <td class="paramtype">real (kind=kind_phys), intent(in)&#160;</td>
          <td class="paramname"><em>ssolar</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real (kind=kind_phys), intent(in)&#160;</td>
          <td class="paramname"><em>cosz</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real (kind=kind_phys), intent(in)&#160;</td>
          <td class="paramname"><em>sntz</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real (kind=kind_phys), dimension(2), intent(in)&#160;</td>
          <td class="paramname"><em>albbm</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real (kind=kind_phys), dimension(2), intent(in)&#160;</td>
          <td class="paramname"><em>albdf</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real (kind=kind_phys), dimension(ngptsw), intent(in)&#160;</td>
          <td class="paramname"><em>sfluxzen</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real (kind=kind_phys), dimension(nlay), intent(in)&#160;</td>
          <td class="paramname"><em>cldfrc</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real (kind=kind_phys), intent(in)&#160;</td>
          <td class="paramname"><em>cf1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real (kind=kind_phys), intent(in)&#160;</td>
          <td class="paramname"><em>cf0</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real (kind=kind_phys), dimension(nlay,ngptsw), intent(in)&#160;</td>
          <td class="paramname"><em>taug</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real (kind=kind_phys), dimension(nlay,ngptsw), intent(in)&#160;</td>
          <td class="paramname"><em>taur</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real (kind=kind_phys), dimension(nlay,nbdsw), intent(in)&#160;</td>
          <td class="paramname"><em>tauae</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real (kind=kind_phys), dimension(nlay,nbdsw), intent(in)&#160;</td>
          <td class="paramname"><em>ssaae</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real (kind=kind_phys), dimension(nlay,nbdsw), intent(in)&#160;</td>
          <td class="paramname"><em>asyae</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real (kind=kind_phys), dimension(nlay,nbdsw), intent(in)&#160;</td>
          <td class="paramname"><em>taucw</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real (kind=kind_phys), dimension(nlay,nbdsw), intent(in)&#160;</td>
          <td class="paramname"><em>ssacw</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real (kind=kind_phys), dimension(nlay,nbdsw), intent(in)&#160;</td>
          <td class="paramname"><em>asycw</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>nlay</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>nlp1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real (kind=kind_phys), dimension(nlp1,nbdsw), intent(out)&#160;</td>
          <td class="paramname"><em>fxupc</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real (kind=kind_phys), dimension(nlp1,nbdsw), intent(out)&#160;</td>
          <td class="paramname"><em>fxdnc</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real (kind=kind_phys), dimension(nlp1,nbdsw), intent(out)&#160;</td>
          <td class="paramname"><em>fxup0</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real (kind=kind_phys), dimension(nlp1,nbdsw), intent(out)&#160;</td>
          <td class="paramname"><em>fxdn0</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real (kind=kind_phys), intent(out)&#160;</td>
          <td class="paramname"><em>ftoauc</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real (kind=kind_phys), intent(out)&#160;</td>
          <td class="paramname"><em>ftoau0</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real (kind=kind_phys), intent(out)&#160;</td>
          <td class="paramname"><em>ftoadc</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real (kind=kind_phys), intent(out)&#160;</td>
          <td class="paramname"><em>fsfcuc</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real (kind=kind_phys), intent(out)&#160;</td>
          <td class="paramname"><em>fsfcu0</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real (kind=kind_phys), intent(out)&#160;</td>
          <td class="paramname"><em>fsfcdc</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real (kind=kind_phys), intent(out)&#160;</td>
          <td class="paramname"><em>fsfcd0</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real (kind=kind_phys), dimension(2), intent(out)&#160;</td>
          <td class="paramname"><em>sfbmc</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real (kind=kind_phys), dimension(2), intent(out)&#160;</td>
          <td class="paramname"><em>sfdfc</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real (kind=kind_phys), dimension(2), intent(out)&#160;</td>
          <td class="paramname"><em>sfbm0</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real (kind=kind_phys), dimension(2), intent(out)&#160;</td>
          <td class="paramname"><em>sfdf0</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real (kind=kind_phys), intent(out)&#160;</td>
          <td class="paramname"><em>suvbfc</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real (kind=kind_phys), intent(out)&#160;</td>
          <td class="paramname"><em>suvbf0</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">ssolar</td><td>incoming solar flux at top </td></tr>
    <tr><td class="paramname">cosz</td><td>cosine solar zenith angle </td></tr>
    <tr><td class="paramname">sntz</td><td>secant solar zenith angle </td></tr>
    <tr><td class="paramname">albbm</td><td>surface albedo for direct beam radiation </td></tr>
    <tr><td class="paramname">albdf</td><td>surface albedo for diffused radiation </td></tr>
    <tr><td class="paramname">sfluxzen</td><td>spectral distribution of incoming solar flux </td></tr>
    <tr><td class="paramname">cldfrc</td><td>layer cloud fraction </td></tr>
    <tr><td class="paramname">cf1</td><td>&gt;0: cloudy sky, otherwise: clear sky </td></tr>
    <tr><td class="paramname">cf0</td><td>=1-cf1 </td></tr>
    <tr><td class="paramname">taug</td><td>spectral optical depth for gases </td></tr>
    <tr><td class="paramname">taur</td><td>optical depth for rayleigh scattering </td></tr>
    <tr><td class="paramname">tauae</td><td>aerosols optical depth </td></tr>
    <tr><td class="paramname">ssaae</td><td>aerosols single scattering albedo </td></tr>
    <tr><td class="paramname">asyae</td><td>aerosols asymmetry factor </td></tr>
    <tr><td class="paramname">taucw</td><td>weighted cloud optical depth </td></tr>
    <tr><td class="paramname">ssacw</td><td>weighted cloud single scat albedo </td></tr>
    <tr><td class="paramname">asycw</td><td>weighted cloud asymmetry factor </td></tr>
    <tr><td class="paramname">nlay,nlp1</td><td>number of layers/levels </td></tr>
    <tr><td class="paramname">fxupc</td><td>tot sky upward flux </td></tr>
    <tr><td class="paramname">fxdnc</td><td>tot sky downward flux </td></tr>
    <tr><td class="paramname">fxup0</td><td>clr sky upward flux </td></tr>
    <tr><td class="paramname">fxdn0</td><td>clr sky downward flux </td></tr>
    <tr><td class="paramname">ftoauc</td><td>tot sky toa upwd flux </td></tr>
    <tr><td class="paramname">ftoau0</td><td>clr sky toa upwd flux </td></tr>
    <tr><td class="paramname">ftoadc</td><td>toa downward (incoming) solar flux </td></tr>
    <tr><td class="paramname">fsfcuc</td><td>tot sky sfc upwd flux </td></tr>
    <tr><td class="paramname">fsfcu0</td><td>clr sky sfc upwd flux </td></tr>
    <tr><td class="paramname">fsfcdc</td><td>tot sky sfc dnwd flux </td></tr>
    <tr><td class="paramname">fsfcd0</td><td>clr sky sfc dnwd flux </td></tr>
    <tr><td class="paramname">sfbmc</td><td>tot sky sfc dnwd beam flux (nir/uv+vis) </td></tr>
    <tr><td class="paramname">sfdfc</td><td>tot sky sfc dnwd diff flux (nir/uv+vis) </td></tr>
    <tr><td class="paramname">sfbm0</td><td>clr sky sfc dnwd beam flux (nir/uv+vis) </td></tr>
    <tr><td class="paramname">sfdf0</td><td>clr sky sfc dnwd diff flux (nir/uv+vis) </td></tr>
    <tr><td class="paramname">suvbfc</td><td>tot sky sfc dnwd uv-b flux </td></tr>
    <tr><td class="paramname">suvbf0</td><td>clr sky sfc dnwd uv-b flux </td></tr>
  </table>
  </dd>
</dl>
<h1><a class="anchor" id="General_spcvrtc"></a>
General Algorithm</h1>
<ol type="1">
<li>Initialize output fluxes.</li>
<li>Compute clear-sky optical parameters, layer reflectance and transmittance.<ul>
<li>Set up toa direct beam and surface values (beam and diff)</li>
<li>Delta scaling for clear-sky condition</li>
<li>General two-stream expressions for physparam::iswmode</li>
<li>Compute homogeneous reflectance and transmittance for both conservative and non-conservative scattering</li>
<li>Pre-delta-scaling clear and cloudy direct beam transmittance</li>
<li>Call swflux() to compute the upward and downward radiation fluxes</li>
</ul>
</li>
<li>Compute total sky optical parameters, layer reflectance and transmittance.<ul>
<li>Set up toa direct beam and surface values (beam and diff)</li>
<li>Delta scaling for total-sky condition</li>
<li>General two-stream expressions for physparam::iswmode</li>
<li>Compute homogeneous reflectance and transmittance for conservative scattering and non-conservative scattering</li>
<li>Pre-delta-scaling clear and cloudy direct beam transmittance</li>
<li>Call swflux() to compute the upward and downward radiation fluxes</li>
</ul>
</li>
<li>Process and save outputs. </li>
</ol>

<p class="definition">Definition at line <a class="el" href="radsw__main_8f_source.html#l02304">2304</a> of file <a class="el" href="radsw__main_8f_source.html">radsw_main.f</a>.</p>

<p class="reference">References <a class="el" href="radsw__main_8f_source.html#l00443">bpade</a>, <a class="el" href="radsw__main_8f_source.html#l00495">exp_tbl</a>, <a class="el" href="radsw__main_8f_source.html#l00460">idxsfc</a>, <a class="el" href="radsw__param_8f_source.html#l00128">module_radsw_parameters::nblow</a>, <a class="el" href="radsw__param_8f_source.html#l00173">module_radsw_parameters::ngb</a>, <a class="el" href="radsw__param_8f_source.html#l00134">module_radsw_parameters::ngptsw</a>, <a class="el" href="radsw__param_8f_source.html#l00140">module_radsw_parameters::ntbmx</a>, <a class="el" href="radsw__main_8f_source.html#l00485">nuvb</a>, and <a class="el" href="radsw__main_8f_source.html#l03770">vrtqdr()</a>.</p>

<p class="reference">Referenced by <a class="el" href="radsw__main_8f_source.html#l00594">swrad()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="group__module__radsw__main_gaeb992f35bdf7dbf9ea8709d7d91dedfd_cgraph.png" border="0" usemap="#group__module__radsw__main_gaeb992f35bdf7dbf9ea8709d7d91dedfd_cgraph" alt=""/></div>
<!-- MAP 1 -->
</div>

</div>
</div>
<a id="ga859cc14063a58e9d0a252e4366b9fff3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga859cc14063a58e9d0a252e4366b9fff3">&#9670;&nbsp;</a></span>spcvrtm()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">subroutine module_radsw_main::spcvrtm </td>
          <td>(</td>
          <td class="paramtype">real (kind=kind_phys), intent(in)&#160;</td>
          <td class="paramname"><em>ssolar</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real (kind=kind_phys), intent(in)&#160;</td>
          <td class="paramname"><em>cosz</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real (kind=kind_phys), intent(in)&#160;</td>
          <td class="paramname"><em>sntz</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real (kind=kind_phys), dimension(2), intent(in)&#160;</td>
          <td class="paramname"><em>albbm</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real (kind=kind_phys), dimension(2), intent(in)&#160;</td>
          <td class="paramname"><em>albdf</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real (kind=kind_phys), dimension(ngptsw), intent(in)&#160;</td>
          <td class="paramname"><em>sfluxzen</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real (kind=kind_phys), dimension(nlay,ngptsw), intent(in)&#160;</td>
          <td class="paramname"><em>cldfmc</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real (kind=kind_phys), intent(in)&#160;</td>
          <td class="paramname"><em>cf1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real (kind=kind_phys), intent(in)&#160;</td>
          <td class="paramname"><em>cf0</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real (kind=kind_phys), dimension(nlay,ngptsw), intent(in)&#160;</td>
          <td class="paramname"><em>taug</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real (kind=kind_phys), dimension(nlay,ngptsw), intent(in)&#160;</td>
          <td class="paramname"><em>taur</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real (kind=kind_phys), dimension(nlay,nbdsw), intent(in)&#160;</td>
          <td class="paramname"><em>tauae</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real (kind=kind_phys), dimension(nlay,nbdsw), intent(in)&#160;</td>
          <td class="paramname"><em>ssaae</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real (kind=kind_phys), dimension(nlay,nbdsw), intent(in)&#160;</td>
          <td class="paramname"><em>asyae</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real (kind=kind_phys), dimension(nlay,nbdsw), intent(in)&#160;</td>
          <td class="paramname"><em>taucw</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real (kind=kind_phys), dimension(nlay,nbdsw), intent(in)&#160;</td>
          <td class="paramname"><em>ssacw</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real (kind=kind_phys), dimension(nlay,nbdsw), intent(in)&#160;</td>
          <td class="paramname"><em>asycw</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>nlay</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>nlp1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real (kind=kind_phys), dimension(nlp1,nbdsw), intent(out)&#160;</td>
          <td class="paramname"><em>fxupc</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real (kind=kind_phys), dimension(nlp1,nbdsw), intent(out)&#160;</td>
          <td class="paramname"><em>fxdnc</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real (kind=kind_phys), dimension(nlp1,nbdsw), intent(out)&#160;</td>
          <td class="paramname"><em>fxup0</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real (kind=kind_phys), dimension(nlp1,nbdsw), intent(out)&#160;</td>
          <td class="paramname"><em>fxdn0</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real (kind=kind_phys), intent(out)&#160;</td>
          <td class="paramname"><em>ftoauc</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real (kind=kind_phys), intent(out)&#160;</td>
          <td class="paramname"><em>ftoau0</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real (kind=kind_phys), intent(out)&#160;</td>
          <td class="paramname"><em>ftoadc</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real (kind=kind_phys), intent(out)&#160;</td>
          <td class="paramname"><em>fsfcuc</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real (kind=kind_phys), intent(out)&#160;</td>
          <td class="paramname"><em>fsfcu0</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real (kind=kind_phys), intent(out)&#160;</td>
          <td class="paramname"><em>fsfcdc</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real (kind=kind_phys), intent(out)&#160;</td>
          <td class="paramname"><em>fsfcd0</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real (kind=kind_phys), dimension(2), intent(out)&#160;</td>
          <td class="paramname"><em>sfbmc</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real (kind=kind_phys), dimension(2), intent(out)&#160;</td>
          <td class="paramname"><em>sfdfc</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real (kind=kind_phys), dimension(2), intent(out)&#160;</td>
          <td class="paramname"><em>sfbm0</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real (kind=kind_phys), dimension(2), intent(out)&#160;</td>
          <td class="paramname"><em>sfdf0</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real (kind=kind_phys), intent(out)&#160;</td>
          <td class="paramname"><em>suvbfc</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real (kind=kind_phys), intent(out)&#160;</td>
          <td class="paramname"><em>suvbf0</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">ssolar</td><td>incoming solar flux at top </td></tr>
    <tr><td class="paramname">cosz</td><td>cosine solar zenith angle </td></tr>
    <tr><td class="paramname">sntz</td><td>secant solar zenith angle </td></tr>
    <tr><td class="paramname">albbm</td><td>surface albedo for direct beam radiation </td></tr>
    <tr><td class="paramname">albdf</td><td>surface albedo for diffused radiation </td></tr>
    <tr><td class="paramname">sfluxzen</td><td>spectral distribution of incoming solar flux </td></tr>
    <tr><td class="paramname">cldfmc</td><td>layer cloud fraction for g-point </td></tr>
    <tr><td class="paramname">cf1</td><td>&gt;0: cloudy sky, otherwise: clear sky </td></tr>
    <tr><td class="paramname">cf0</td><td>=1-cf1 </td></tr>
    <tr><td class="paramname">taug</td><td>spectral optical depth for gases </td></tr>
    <tr><td class="paramname">taur</td><td>optical depth for rayleigh scattering </td></tr>
    <tr><td class="paramname">tauae</td><td>aerosols optical depth </td></tr>
    <tr><td class="paramname">ssaae</td><td>aerosols single scattering albedo </td></tr>
    <tr><td class="paramname">asyae</td><td>aerosols asymmetry factor </td></tr>
    <tr><td class="paramname">taucw</td><td>weighted cloud optical depth </td></tr>
    <tr><td class="paramname">ssacw</td><td>weighted cloud single scat albedo </td></tr>
    <tr><td class="paramname">asycw</td><td>weighted cloud asymmetry factor </td></tr>
    <tr><td class="paramname">nlay,nlp1</td><td>number of layers/levels </td></tr>
    <tr><td class="paramname">fxupc</td><td>tot sky upward flux </td></tr>
    <tr><td class="paramname">fxdnc</td><td>tot sky downward flux </td></tr>
    <tr><td class="paramname">fxup0</td><td>clr sky upward flux </td></tr>
    <tr><td class="paramname">fxdn0</td><td>clr sky downward flux </td></tr>
    <tr><td class="paramname">ftoauc</td><td>tot sky toa upwd flux </td></tr>
    <tr><td class="paramname">ftoau0</td><td>clr sky toa upwd flux </td></tr>
    <tr><td class="paramname">ftoadc</td><td>toa downward (incoming) solar flux </td></tr>
    <tr><td class="paramname">fsfcuc</td><td>tot sky sfc upwd flux </td></tr>
    <tr><td class="paramname">fsfcu0</td><td>clr sky sfc upwd flux </td></tr>
    <tr><td class="paramname">fsfcdc</td><td>tot sky sfc dnwd flux </td></tr>
    <tr><td class="paramname">fsfcd0</td><td>clr sky sfc dnwd flux </td></tr>
    <tr><td class="paramname">sfbmc</td><td>tot sky sfc dnwd beam flux (nir/uv+vis) </td></tr>
    <tr><td class="paramname">sfdfc</td><td>tot sky sfc dnwd diff flux (nir/uv+vis) </td></tr>
    <tr><td class="paramname">sfbm0</td><td>clr sky sfc dnwd beam flux (nir/uv+vis) </td></tr>
    <tr><td class="paramname">sfdf0</td><td>clr sky sfc dnwd diff flux (nir/uv+vis) </td></tr>
    <tr><td class="paramname">suvbfc</td><td>tot sky sfc dnwd uv-b flux </td></tr>
    <tr><td class="paramname">suvbf0</td><td>clr sky sfc dnwd uv-b flux </td></tr>
  </table>
  </dd>
</dl>
<ol type="1">
<li>Initialize output fluxes.</li>
<li>Compute clear-sky optical parameters, layer reflectance and transmittance.<ul>
<li>Set up toa direct beam and surface values (beam and diff)</li>
<li>Delta scaling for clear-sky condition</li>
<li>General two-stream expressions for physparam::iswmode</li>
<li>Compute homogeneous reflectance and transmittance for both conservative and non-conservative scattering</li>
<li>Pre-delta-scaling clear and cloudy direct beam transmittance</li>
<li>Call swflux() to compute the upward and downward radiation fluxes</li>
</ul>
</li>
<li>Compute total sky optical parameters, layer reflectance and transmittance.<ul>
<li>Set up toa direct beam and surface values (beam and diff)</li>
<li>Delta scaling for total-sky condition</li>
<li>General two-stream expressions for physparam::iswmode</li>
<li>Compute homogeneous reflectance and transmittance for conservative scattering and non-conservative scattering</li>
<li>Pre-delta-scaling clear and cloudy direct beam transmittance</li>
<li>Call swflux() to compute the upward and downward radiation fluxes</li>
</ul>
</li>
<li>Process and save outputs. </li>
</ol>

<p class="definition">Definition at line <a class="el" href="radsw__main_8f_source.html#l03066">3066</a> of file <a class="el" href="radsw__main_8f_source.html">radsw_main.f</a>.</p>

<p class="reference">References <a class="el" href="radsw__main_8f_source.html#l00443">bpade</a>, <a class="el" href="radsw__main_8f_source.html#l00495">exp_tbl</a>, <a class="el" href="radsw__main_8f_source.html#l00460">idxsfc</a>, <a class="el" href="radsw__param_8f_source.html#l00128">module_radsw_parameters::nblow</a>, <a class="el" href="radsw__param_8f_source.html#l00173">module_radsw_parameters::ngb</a>, <a class="el" href="radsw__param_8f_source.html#l00134">module_radsw_parameters::ngptsw</a>, <a class="el" href="radsw__param_8f_source.html#l00140">module_radsw_parameters::ntbmx</a>, <a class="el" href="radsw__main_8f_source.html#l00485">nuvb</a>, and <a class="el" href="radsw__main_8f_source.html#l03770">vrtqdr()</a>.</p>

<p class="reference">Referenced by <a class="el" href="radsw__main_8f_source.html#l00594">swrad()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="group__module__radsw__main_ga859cc14063a58e9d0a252e4366b9fff3_cgraph.png" border="0" usemap="#group__module__radsw__main_ga859cc14063a58e9d0a252e4366b9fff3_cgraph" alt=""/></div>
<!-- MAP 2 -->
</div>

</div>
</div>
<a id="ga784397878835a8cdd0b14a7b9eafb4e3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga784397878835a8cdd0b14a7b9eafb4e3">&#9670;&nbsp;</a></span>swrad()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine, public module_radsw_main::swrad </td>
          <td>(</td>
          <td class="paramtype">real (kind=kind_phys), dimension(npts,nlay), intent(in)&#160;</td>
          <td class="paramname"><em>plyr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real (kind=kind_phys), dimension(npts,nlp1), intent(in)&#160;</td>
          <td class="paramname"><em>plvl</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real (kind=kind_phys), dimension(npts,nlay), intent(in)&#160;</td>
          <td class="paramname"><em>tlyr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real (kind=kind_phys), dimension(npts,nlp1), intent(in)&#160;</td>
          <td class="paramname"><em>tlvl</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real (kind=kind_phys), dimension(npts,nlay), intent(in)&#160;</td>
          <td class="paramname"><em>qlyr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real (kind=kind_phys), dimension(npts,nlay), intent(in)&#160;</td>
          <td class="paramname"><em>olyr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real (kind=kind_phys), dimension(npts,nlay,9), intent(in)&#160;</td>
          <td class="paramname"><em>gasvmr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real (kind=kind_phys), dimension(npts,nlay,11)&#160;</td>
          <td class="paramname"><em>clouds</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, dimension(:), intent(in)&#160;</td>
          <td class="paramname"><em>icseed</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real (kind=kind_phys), dimension(npts,nlay,nbdsw,3), intent(in)&#160;</td>
          <td class="paramname"><em>aerosols</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real (kind=kind_phys), dimension(npts,4), intent(in)&#160;</td>
          <td class="paramname"><em>sfcalb</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real (kind=kind_phys), dimension(npts), intent(in)&#160;</td>
          <td class="paramname"><em>cosz</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real (kind=kind_phys), intent(in)&#160;</td>
          <td class="paramname"><em>solcon</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>NDAY</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, dimension(:), intent(in)&#160;</td>
          <td class="paramname"><em>idxday</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>npts</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>nlay</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>nlp1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">logical, intent(in)&#160;</td>
          <td class="paramname"><em>lprnt</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real (kind=kind_phys), dimension(npts,nlay), intent(out)&#160;</td>
          <td class="paramname"><em>hswc</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type (<a class="el" href="structmodule__radsw__parameters_1_1topfsw__type.html">topfsw_type</a>), dimension(npts), intent(out)&#160;</td>
          <td class="paramname"><em>topflx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type (<a class="el" href="structmodule__radsw__parameters_1_1sfcfsw__type.html">sfcfsw_type</a>), dimension(npts), intent(out)&#160;</td>
          <td class="paramname"><em>sfcflx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real (kind=kind_phys), dimension(npts,nlay), intent(out), optional&#160;</td>
          <td class="paramname"><em>HSW0</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real (kind=kind_phys), dimension(npts,nlay,nbdsw), intent(out), optional&#160;</td>
          <td class="paramname"><em>HSWB</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type (<a class="el" href="structmodule__radsw__parameters_1_1profsw__type.html">profsw_type</a>), dimension(npts,nlp1), intent(out), optional&#160;</td>
          <td class="paramname"><em>FLXPRF</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type (<a class="el" href="structmodule__radsw__parameters_1_1cmpfsw__type.html">cmpfsw_type</a>), dimension(npts), intent(out), optional&#160;</td>
          <td class="paramname"><em>FDNCMP</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">plyr</td><td>model layer mean pressure in mb </td></tr>
    <tr><td class="paramname">plvl</td><td>model level pressure in mb </td></tr>
    <tr><td class="paramname">tlyr</td><td>model layer mean temperature in K </td></tr>
    <tr><td class="paramname">tlvl</td><td>model level temperature in K (not in use) </td></tr>
    <tr><td class="paramname">qlyr</td><td>layer specific humidity in gm/gm </td></tr>
    <tr><td class="paramname">olyr</td><td>layer ozone concentration in gm/gm </td></tr>
    <tr><td class="paramname">gasvmr</td><td>atmospheric constent gases <br />
 (:,:,1) - co2 volume mixing ratio <br />
 (:,:,2) - n2o volume mixing ratio <br />
 (:,:,3) - ch4 volume mixing ratio <br />
 (:,:,4) - o2 volume mixing ratio <br />
 (:,:,5) - co volume mixing ratio (not used) <br />
 (:,:,6) - cfc11 volume mixing ratio (not used) <br />
 (:,:,7) - cfc12 volume mixing ratio (not used) <br />
 (:,:,8) - cfc22 volume mixing ratio (not used) <br />
 (:,:,9) - ccl4 volume mixing ratio (not used) </td></tr>
    <tr><td class="paramname">clouds</td><td>cloud profile <br />
 (:,:,1) - layer total cloud fraction <br />
 (:,:,2) - layer in-cloud liq water path ( \(g/m^2\)) <br />
 (:,:,3) - mean eff radius for liq cloud (micron) <br />
 (:,:,4) - layer in-cloud ice water path ( \(g/m^2\)) <br />
 (:,:,5) - mean eff radius for ice cloud (micron) <br />
 (:,:,6) - layer rain drop water path ( \(g/m^2\)) <br />
 (:,:,7) - mean eff radius for rain drop (micron) <br />
 (:,:,8) - layer snow flake water path ( \(g/m^2\)) <br />
 (:,:,9) - mean eff radius for snow flake (micron) </td></tr>
    <tr><td class="paramname">icseed</td><td>auxiliary special cloud related array. </td></tr>
    <tr><td class="paramname">aerosols</td><td>aerosol optical properties <br />
 (:,:,:,1) - optical depth <br />
 (:,:,:,2) - single scattering albedo <br />
 (:,:,:,3) - asymmetry parameter </td></tr>
    <tr><td class="paramname">sfcalb</td><td>surface albedo in fraction <br />
 (:,1) - near ir direct beam albedo <br />
 (:,2) - near ir diffused albedo <br />
 (:,3) - uv+vis direct beam albedo <br />
 (:,4) - uv+vis diffused albedo </td></tr>
    <tr><td class="paramname">cosz</td><td>cosine of solar zenith angle </td></tr>
    <tr><td class="paramname">solcon</td><td>solar constant ( \(W/m^2\)) </td></tr>
    <tr><td class="paramname">NDAY</td><td>num of daytime points </td></tr>
    <tr><td class="paramname">idxday</td><td>index array for daytime points </td></tr>
    <tr><td class="paramname">npts</td><td>number of horizontal points </td></tr>
    <tr><td class="paramname">nlay,nlp1</td><td>vertical layer/lavel numbers </td></tr>
    <tr><td class="paramname">lprnt</td><td>logical check print flag </td></tr>
    <tr><td class="paramname">hswc</td><td>total sky heating rates (k/sec or k/day) </td></tr>
    <tr><td class="paramname">topflx</td><td>radiation fluxes at toa ( \(W/m^2\)), components: <br />
 upfxc - total sky upward flux at toa <br />
 dnflx - total sky downward flux at toa <br />
 upfx0 - clear sky upward flux at toa </td></tr>
    <tr><td class="paramname">sfcflx</td><td>radiation fluxes at sfc ( \(W/m^2\)), components: <br />
 upfxc - total sky upward flux at sfc <br />
 dnfxc - total sky downward flux at sfc <br />
 upfx0 - clear sky upward flux at sfc <br />
 dnfx0 - clear sky downward flux at sfc </td></tr>
    <tr><td class="paramname">hswb</td><td>spectral band total sky heating rates </td></tr>
    <tr><td class="paramname">hsw0</td><td>clear sky heating rates (k/sec or k/day) </td></tr>
    <tr><td class="paramname">flxprf</td><td>level radiation fluxes ( \( W/m^2 \)), components: <br />
 dnfxc - total sky downward flux at interface <br />
 upfxc - total sky upward flux at interface <br />
 dnfx0 - clear sky downward flux at interface <br />
 upfx0 - clear sky upward flux at interface </td></tr>
    <tr><td class="paramname">fdncmp</td><td>surface downward fluxes ( \(W/m^2\)), components: <br />
 uvbfc - total sky downward uv-b flux at sfc <br />
 uvbf0 - clear sky downward uv-b flux at sfc <br />
 nirbm - downward surface nir direct beam flux <br />
 nirdf - downward surface nir diffused flux <br />
 visbm - downward surface uv+vis direct beam flux <br />
 visdf - downward surface uv+vis diffused flux </td></tr>
  </table>
  </dd>
</dl>
<h1><a class="anchor" id="General_swrad"></a>
General Algorithm</h1>
<ol type="1">
<li>Compute solar constant adjustment factor (s0fac) according to solcon.</li>
<li>Initial output arrays (and optional) as zero.</li>
<li>Change random number seed value for each radiation invocation (isubcsw =1 or 2).</li>
<li>Prepare surface albedo: bm,df - dir,dif; 1,2 - nir,uvv.</li>
<li>Prepare atmospheric profile for use in rrtm.</li>
<li>Set absorber and gas column amount, convert from volume mixing ratio to molec/cm2 based on coldry (scaled to 1.0e-20)<ul>
<li>colamt(nlay,maxgas):column amounts of absorbing gases 1 to maxgas are for h2o,co2,o3,n2o,ch4,o2,co, respectively ( \( mol/cm^2 \))</li>
</ul>
</li>
<li>Read aerosol optical properties from 'aerosols'.</li>
<li>Read cloud optical properties from 'clouds'.</li>
<li>Compute fractions of clear sky view:<ul>
<li>random overlapping</li>
<li>max/ran overlapping</li>
<li>maximum overlapping</li>
</ul>
</li>
<li>For cloudy sky column, call <a class="el" href="group__module__radlw__main.html#ga6bfdea656cc7e1f773ffcc797e072e91" title="This subroutine computes the cloud optical depth(s) for each cloudy layer and g-point interval...">cldprop()</a> to compute the cloud optical properties for each cloudy layer.</li>
<li>Call <a class="el" href="group__module__radlw__main.html#gaeb7b74288cf87988c14bf6e24a2039ae" title="This subroutine computes various coefficients needed in radiative transfer calculations. ">setcoef()</a> to compute various coefficients needed in radiative transfer calculations.</li>
<li>Call <a class="el" href="group__module__radlw__main.html#gab09f986fb87e796a30c889086c92aeb1" title="This subroutine contains optical depths developed for the rapid radiative transfer model...">taumol()</a> to calculate optical depths for gaseous absorption and rayleigh scattering</li>
<li>Call the 2-stream radiation transfer model:<ul>
<li>if physparam::isubcsw .le.0, using standard cloud scheme, call <a class="el" href="group__module__radsw__main.html#gaeb992f35bdf7dbf9ea8709d7d91dedfd" title="This subroutine computes the shortwave radiative fluxes using two-stream method. ">spcvrtc()</a>.</li>
<li>if physparam::isubcsw .gt.0, using mcica cloud scheme, call <a class="el" href="group__module__radsw__main.html#ga859cc14063a58e9d0a252e4366b9fff3" title="This subroutine computes the shortwave radiative fluxes using two-stream method of h...">spcvrtm()</a>.</li>
</ul>
</li>
<li>Save outputs. </li>
</ol>

<p class="definition">Definition at line <a class="el" href="radsw__main_8f_source.html#l00594">594</a> of file <a class="el" href="radsw__main_8f_source.html">radsw_main.f</a>.</p>

<p class="reference">References <a class="el" href="radsw__main_8f_source.html#l01568">cldprop()</a>, <a class="el" href="radsw__main_8f_source.html#l00500">heatfac</a>, <a class="el" href="radsw__main_8f_source.html#l00504">ipsdsw0</a>, <a class="el" href="radsw__main_8f_source.html#l00448">s0</a>, <a class="el" href="radsw__main_8f_source.html#l02111">setcoef()</a>, <a class="el" href="radsw__main_8f_source.html#l02304">spcvrtc()</a>, <a class="el" href="radsw__main_8f_source.html#l03066">spcvrtm()</a>, and <a class="el" href="radsw__main_8f_source.html#l03906">taumol()</a>.</p>

<p class="reference">Referenced by <a class="el" href="_g_f_s__radiation__driver_8_f90_source.html#l01015">module_radiation_driver::gfs_radiation_driver()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="group__module__radsw__main_ga784397878835a8cdd0b14a7b9eafb4e3_cgraph.png" border="0" usemap="#group__module__radsw__main_ga784397878835a8cdd0b14a7b9eafb4e3_cgraph" alt=""/></div>
<!-- MAP 3 -->
</div>

</div>
</div>
<a id="gaa82121d21c1e8f2ca938378249fea135"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gaa82121d21c1e8f2ca938378249fea135">&#9670;&nbsp;</a></span>taumol()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">subroutine module_radsw_main::taumol </td>
          <td>(</td>
          <td class="paramtype">real (kind=kind_phys), dimension(nlay,maxgas), intent(in)&#160;</td>
          <td class="paramname"><em>colamt</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real (kind=kind_phys), dimension(nlay), intent(in)&#160;</td>
          <td class="paramname"><em>colmol</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real (kind=kind_phys), dimension(nlay), intent(in)&#160;</td>
          <td class="paramname"><em>fac00</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real (kind=kind_phys), dimension(nlay), intent(in)&#160;</td>
          <td class="paramname"><em>fac01</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real (kind=kind_phys), dimension(nlay), intent(in)&#160;</td>
          <td class="paramname"><em>fac10</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real (kind=kind_phys), dimension(nlay), intent(in)&#160;</td>
          <td class="paramname"><em>fac11</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, dimension(nlay), intent(in)&#160;</td>
          <td class="paramname"><em>jp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, dimension(nlay), intent(in)&#160;</td>
          <td class="paramname"><em>jt</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, dimension(nlay), intent(in)&#160;</td>
          <td class="paramname"><em>jt1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>laytrop</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real (kind=kind_phys), dimension(nlay), intent(in)&#160;</td>
          <td class="paramname"><em>forfac</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real (kind=kind_phys), dimension(nlay), intent(in)&#160;</td>
          <td class="paramname"><em>forfrac</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, dimension(nlay), intent(in)&#160;</td>
          <td class="paramname"><em>indfor</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real (kind=kind_phys), dimension(nlay), intent(in)&#160;</td>
          <td class="paramname"><em>selffac</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real (kind=kind_phys), dimension(nlay), intent(in)&#160;</td>
          <td class="paramname"><em>selffrac</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, dimension(nlay), intent(in)&#160;</td>
          <td class="paramname"><em>indself</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>nlay</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real (kind=kind_phys), dimension(ngptsw), intent(out)&#160;</td>
          <td class="paramname"><em>sfluxzen</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real (kind=kind_phys), dimension(nlay,ngptsw), intent(out)&#160;</td>
          <td class="paramname"><em>taug</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real (kind=kind_phys), dimension(nlay,ngptsw), intent(out)&#160;</td>
          <td class="paramname"><em>taur</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">colamt</td><td>column amounts of absorbing gases the index are for h2o, co2, o3, n2o, ch4, and o2, respectively \((mol/cm^2)\) </td></tr>
    <tr><td class="paramname">colmol</td><td>total column amount (dry air+water vapor) </td></tr>
    <tr><td class="paramname">facij</td><td>for each layer, these are factors that are needed to compute the interpolation factors that multiply the appropriate reference k-values. a value of 0/1 for i,j indicates that the corresponding factor multiplies reference k-value for the lower/higher of the two appropriate temperatures, and altitudes, respectively. </td></tr>
    <tr><td class="paramname">jp</td><td>the index of the lower (in altitude) of the two appropriate ref pressure levels needed for interpolation. </td></tr>
    <tr><td class="paramname">jt,jt1</td><td>the indices of the lower of the two approp ref temperatures needed for interpolation (for pressure levels jp and jp+1, respectively) </td></tr>
    <tr><td class="paramname">laytrop</td><td>tropopause layer index </td></tr>
    <tr><td class="paramname">forfac</td><td>scale factor needed to foreign-continuum. </td></tr>
    <tr><td class="paramname">forfrac</td><td>factor needed for temperature interpolation </td></tr>
    <tr><td class="paramname">indfor</td><td>index of the lower of the two appropriate reference temperatures needed for foreign-continuum interpolation </td></tr>
    <tr><td class="paramname">selffac</td><td>scale factor needed to h2o self-continuum. </td></tr>
    <tr><td class="paramname">selffrac</td><td>factor needed for temperature interpolation of reference h2o self-continuum data </td></tr>
    <tr><td class="paramname">indself</td><td>index of the lower of the two appropriate reference temperatures needed for the self-continuum interpolation </td></tr>
    <tr><td class="paramname">nlay</td><td>number of vertical layers </td></tr>
    <tr><td class="paramname">sfluxzen</td><td>spectral distribution of incoming solar flux </td></tr>
    <tr><td class="paramname">taug</td><td>spectral optical depth for gases </td></tr>
    <tr><td class="paramname">taur</td><td>opt depth for rayleigh scattering </td></tr>
  </table>
  </dd>
</dl>
<h1><a class="anchor" id="gen_al"></a>
General Algorithm</h1>
<ul>
<li>Call taumol## (##: 16-29) to calculate layer optical depth.<ul>
<li>call <a class="el" href="group__module__radsw__main.html#ga8702f5f6285ff1a5cbfad740545fffb6" title="The subroutine computes the optical depth in band 16: 2600-3250 cm-1 (low - h2o,ch4; high - ch4) ...">taumol16()</a></li>
<li>call <a class="el" href="radsw__main_8f.html#ae46d1c061726bcde426caadd80b1fd80" title="The subroutine computes the optical depth in band 17: 3250-4000 cm-1 (low - h2o,co2; high - h2o...">taumol17()</a></li>
<li>call <a class="el" href="radsw__main_8f.html#a06f6f2b0ef60df93c267a667a2e1aa36" title="The subroutine computes the optical depth in band 18: 4000-4650 cm-1 (low - h2o,ch4; high - ch4) ...">taumol18()</a></li>
<li>call <a class="el" href="radsw__main_8f.html#a776a0d78fda9f4fd0f1153b55be597df" title="The subroutine computes the optical depth in band 19: 4650-5150 cm-1 (low - h2o,co2; high - co2) ...">taumol19()</a></li>
<li>call <a class="el" href="radsw__main_8f.html#a6eb9a29728a986ea6b15240adebd4a0c" title="The subroutine computes the optical depth in band 20: 5150-6150 cm-1 (low - h2o; high - h2o) ...">taumol20()</a></li>
<li>call <a class="el" href="radsw__main_8f.html#a54619c48147f35da2d7855dc488c0ff4" title="The subroutine computes the optical depth in band 21: 6150-7700 cm-1 (low - h2o,co2; high - h2o...">taumol21()</a></li>
<li>call <a class="el" href="radsw__main_8f.html#a3b5392346eee35eb13a2a54175b6338b" title="The subroutine computes the optical depth in band 22: 7700-8050 cm-1 (low - h2o,o2; high - o2) ...">taumol22()</a></li>
<li>call <a class="el" href="radsw__main_8f.html#adf5d73763c80ec079b72dda7d74cba94" title="The subroutine computes the optical depth in band 23: 8050-12850 cm-1 (low - h2o; high - nothing) ...">taumol23()</a></li>
<li>call <a class="el" href="radsw__main_8f.html#ae0abf1a08aa5d6ca14bfea83d0603716" title="The subroutine computes the optical depth in band 24: 12850-16000 cm-1 (low - h2o,o2; high - o2) ">taumol24()</a></li>
<li>call <a class="el" href="radsw__main_8f.html#a21b72d6de9247eccb20de836ea76cf7a" title="The subroutine computes the optical depth in band 25: 16000-22650 cm-1 (low - h2o; high - nothing) ...">taumol25()</a></li>
<li>call <a class="el" href="radsw__main_8f.html#a20261640145a5d10e091ef3c67763175" title="The subroutine computes the optical depth in band 26: 22650-29000 cm-1 (low - nothing; high - nothing...">taumol26()</a></li>
<li>call <a class="el" href="radsw__main_8f.html#a7d2cea6cc0cfde853d25a14ba0efcca2" title="The subroutine computes the optical depth in band 27: 29000-38000 cm-1 (low - o3; high - o3) ...">taumol27()</a></li>
<li>call <a class="el" href="radsw__main_8f.html#a2113c76707f43cf91fe5926ab69d1b8b" title="The subroutine computes the optical depth in band 28: 38000-50000 cm-1 (low - o3,o2; high - o3...">taumol28()</a></li>
<li>call <a class="el" href="radsw__main_8f.html#a08e2db10432d07392f29a49bc5b5c640" title="The subroutine computes the optical depth in band 29: 820-2600 cm-1 (low - h2o; high - co2) ...">taumol29()</a> </li>
</ul>
</li>
</ul>

<p class="definition">Definition at line <a class="el" href="radsw__main_8f_source.html#l03906">3906</a> of file <a class="el" href="radsw__main_8f_source.html">radsw_main.f</a>.</p>

<p class="reference">References <a class="el" href="radsw__datatb_8f_source.html#l01996">module_radsw_sflux::ibx</a>, <a class="el" href="radsw__datatb_8f_source.html#l01989">module_radsw_sflux::ix1</a>, <a class="el" href="radsw__datatb_8f_source.html#l01993">module_radsw_sflux::ix2</a>, <a class="el" href="radsw__datatb_8f_source.html#l01985">module_radsw_sflux::layreffr</a>, <a class="el" href="radsw__param_8f_source.html#l00130">module_radsw_parameters::nbhgh</a>, <a class="el" href="radsw__param_8f_source.html#l00128">module_radsw_parameters::nblow</a>, <a class="el" href="radsw__param_8f_source.html#l00168">module_radsw_parameters::ngs</a>, <a class="el" href="radsw__datatb_8f_source.html#l02005">module_radsw_sflux::sfluxref01</a>, <a class="el" href="radsw__datatb_8f_source.html#l02008">module_radsw_sflux::sfluxref02</a>, <a class="el" href="radsw__datatb_8f_source.html#l02011">module_radsw_sflux::sfluxref03</a>, <a class="el" href="radsw__datatb_8f_source.html#l01971">module_radsw_sflux::specwt</a>, <a class="el" href="radsw__datatb_8f_source.html#l01968">module_radsw_sflux::strrat</a>, <a class="el" href="radsw__main_8f_source.html#l04158">taumol16()</a>, <a class="el" href="radsw__main_8f_source.html#l04255">taumol17()</a>, <a class="el" href="radsw__main_8f_source.html#l04378">taumol18()</a>, <a class="el" href="radsw__main_8f_source.html#l04474">taumol19()</a>, <a class="el" href="radsw__main_8f_source.html#l04570">taumol20()</a>, <a class="el" href="radsw__main_8f_source.html#l04652">taumol21()</a>, <a class="el" href="radsw__main_8f_source.html#l04774">taumol22()</a>, <a class="el" href="radsw__main_8f_source.html#l04883">taumol23()</a>, <a class="el" href="radsw__main_8f_source.html#l04946">taumol24()</a>, <a class="el" href="radsw__main_8f_source.html#l05042">taumol25()</a>, <a class="el" href="radsw__main_8f_source.html#l05098">taumol26()</a>, <a class="el" href="radsw__main_8f_source.html#l05134">taumol27()</a>, <a class="el" href="radsw__main_8f_source.html#l05196">taumol28()</a>, and <a class="el" href="radsw__main_8f_source.html#l05305">taumol29()</a>.</p>

<p class="reference">Referenced by <a class="el" href="radsw__main_8f_source.html#l00594">swrad()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="group__module__radsw__main_gaa82121d21c1e8f2ca938378249fea135_cgraph.png" border="0" usemap="#group__module__radsw__main_gaa82121d21c1e8f2ca938378249fea135_cgraph" alt=""/></div>
<!-- MAP 4 -->
</div>

</div>
</div>
<a id="gad227ccde86a01f47c1ab3b4bed5ba1be"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gad227ccde86a01f47c1ab3b4bed5ba1be">&#9670;&nbsp;</a></span>vrtqdr()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">subroutine module_radsw_main::vrtqdr </td>
          <td>(</td>
          <td class="paramtype">real (kind=kind_phys), dimension(nlp1), intent(in)&#160;</td>
          <td class="paramname"><em>zrefb</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real (kind=kind_phys), dimension(nlp1), intent(in)&#160;</td>
          <td class="paramname"><em>zrefd</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real (kind=kind_phys), dimension(nlp1), intent(in)&#160;</td>
          <td class="paramname"><em>ztrab</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real (kind=kind_phys), dimension(nlp1), intent(in)&#160;</td>
          <td class="paramname"><em>ztrad</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real (kind=kind_phys), dimension(nlp1), intent(in)&#160;</td>
          <td class="paramname"><em>zldbt</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real (kind=kind_phys), dimension(nlp1), intent(in)&#160;</td>
          <td class="paramname"><em>ztdbt</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>NLAY</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>NLP1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real (kind=kind_phys), dimension(nlp1), intent(out)&#160;</td>
          <td class="paramname"><em>zfu</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real (kind=kind_phys), dimension(nlp1), intent(out)&#160;</td>
          <td class="paramname"><em>zfd</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">zrefb</td><td>layer direct beam reflectivity </td></tr>
    <tr><td class="paramname">zrefd</td><td>layer diffuse reflectivity </td></tr>
    <tr><td class="paramname">ztrab</td><td>layer direct beam transmissivity </td></tr>
    <tr><td class="paramname">ztrad</td><td>layer diffuse transmissivity </td></tr>
    <tr><td class="paramname">zldbt</td><td>layer mean beam transmittance </td></tr>
    <tr><td class="paramname">ztdbt</td><td>total beam transmittance at levels </td></tr>
    <tr><td class="paramname">NLAY,NLP1</td><td>number of layers/levels </td></tr>
    <tr><td class="paramname">zfu</td><td>upward flux at layer interface </td></tr>
    <tr><td class="paramname">zfd</td><td>downward flux at layer interface </td></tr>
  </table>
  </dd>
</dl>
<h1><a class="anchor" id="General_swflux"></a>
General Algorithm</h1>
<ol type="1">
<li>Link lowest layer with surface.</li>
<li>Pass from bottom to top.</li>
<li>Upper boundary conditions</li>
<li>Pass from top to bottom</li>
<li>Up and down-welling fluxes at levels. </li>
</ol>

<p class="definition">Definition at line <a class="el" href="radsw__main_8f_source.html#l03770">3770</a> of file <a class="el" href="radsw__main_8f_source.html">radsw_main.f</a>.</p>

<p class="reference">Referenced by <a class="el" href="radsw__main_8f_source.html#l02304">spcvrtc()</a>, and <a class="el" href="radsw__main_8f_source.html#l03066">spcvrtm()</a>.</p>

</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">Generated by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.13 </li>
  </ul>
</div>
</body>
</html>

<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.13"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>GFS Physics Documentation: RRTMG Shortwave/Longwave Radiation Scheme</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { init_search(); });
</script>
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    extensions: ["tex2jax.js"],
    jax: ["input/TeX","output/HTML-CSS"],
});
</script><script type="text/javascript" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="ccpp_dox_extra_style.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="ncep.jpg"/></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">GFS Physics Documentation
   </div>
  </td>
   <td>        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
</td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.13 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('group___r_r_t_m_g.html','');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#groups">Modules</a>  </div>
  <div class="headertitle">
<div class="title">RRTMG Shortwave/Longwave Radiation Scheme</div>  </div>
</div><!--header-->
<div class="contents">

<p>The GFS radiation scheme.  
<a href="#details">More...</a></p>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<p>Radiative processes are among the most complex and computationally intensive parts of all model physics. As an essential component of modeling the atmosphere, radiation directly and indirectly connects all physics processes with model dynamics, and it regulates the overall earth-atmosphere energy exchanges and transformations.</p>
<p>The radiation package in GFS physics has standardized component modules (Table 1). The radiation driver module (<a class="el" href="group__module__radiation__driver.html">module_radiation_driver</a>) is the interface with the Interoperable Physics Driver (IPD) for NGGPS, and it has three subroutines called by IPD (Figure 1):</p><ul>
<li><a class="el" href="group__module__radiation__driver.html#ga3d4ef1d77b7d7ef09fafcb4413e1cbf2" title="This subroutine initialize a model&#39;s radiation process through calling of specific initialization sub...">radinit()</a> is called in subroutine nuopc_phys_init to set up radiation related fixed parameters.</li>
<li><a class="el" href="group__module__radiation__driver.html#ga28280ee9ea8ee0d183ab9d541a31b718" title="This subroutine checks and updates time sensitive data used by radiation computations. This subroutine needs to be placed inside the time advancement loop but outside of the horizontal grid loop. It is invoked at radiation calling frequncy but before any actual radiative transfer computations. ">radupdate()</a> is called in subroutine nuopc_rad_update to update values between timesteps.</li>
<li>grrad() is called in subroutine nuopc_rad_run, and it is the driver of radiation calculation. <div class="image">
<img src="ipd_rad.png" alt="ipd_rad.png" width="10cm"/>
<div class="caption">
Figure 1: Schematic illustration of the communication between the GFS radiation package and IPD </div></div>
</li>
</ul>
<p>The schematic radiation module structure is shown in Table 1. </p><div class="image">
<img src="schematic_Rad_mod.png" alt="schematic_Rad_mod.png" width="10cm"/>
<div class="caption">
Table 1: Schematic Radiation Module Structure</div></div>
<p>GFS radiation package is intended to provide a fast and accurate method of determining the total radiative flux at any given location. These calculations provide both the total radiative flux at the ground surface, which is needed to establish the surface energy budget, and the vertical radiative flux divergence, which is used to calculate the radiative heating and cooling rates of a given atmospheric layer. The magnitude of the terms in the surface energy budget can set the stage for moist deep convection and are crucial to the formation of low-level clouds. In addition, the vertical radiative flux divergence can produce substantial cooling, particularly at the tops of clouds, which can have strong dynamical effects on cloud evolution.</p>
<p>It uses a correlated-k distribution method and a transmittance lookup table that is linearly scaled by optical depth to achieve high accuracy and efficiency. The algorithm contains 140 unevenly distributed quadrature points (reduced from the original set of 256) to integrate the cumulative probability distribution functions of absorption over 16 spectral bands. It employs the Clough-Kneizys-Davies (CKD_2.4) continuum model (Clough et al. 1992 <a class="el" href="citelist.html#CITEREF_clough_et_al_1992">[15]</a>) to compute absorption by water vapor at the continuum band. Longwave cloud radiative properties external to the RRTM depend on cloud liquid/ice water path and the effective radius of ice particles and water droplets (Hu and Stamnes 1993 <a class="el" href="citelist.html#CITEREF_hu_and_stamnes_1993">[31]</a>; Ebert and Curry 1992 <a class="el" href="citelist.html#CITEREF_ebert_and_curry_1992">[17]</a>).</p>
<p>Changes to Radiation Parameterization since 2007: <br />
 The longwave (LW) and the shortwave (SW) radiation parameterizations in NCEP's operational GFS are both modified and optimized versions of the Rapid Radiative Transfer Model for GCMs (RRTMG_LW v2.3 and RRTMG_SW v2.3, respectively) developed at AER (Iacono et al. 2008 <a class="el" href="citelist.html#CITEREF_iacono_et_al_2008">[33]</a>,Mlawer et al. 1997 <a class="el" href="citelist.html#CITEREF_mlawer_et_al_1997">[46]</a>, Iacono et al., 2000 <a class="el" href="citelist.html#CITEREF_iacono_et_al_2000">[32]</a>, Clough et al., 2005 <a class="el" href="citelist.html#CITEREF_clough_et_al_2005">[16]</a>). The LW algorithm contains 140 unevenly distributed g-points (quadrature points) in 16 broad spectral bands, while the SW algorithm includes 112 g-points in 14 bands. In addition to the major atmospheric absorbing gases of ozone, water vapor, and carbon dioxide, the algorithm also includes various minor absorbing species such as methane, nitrous oxide, oxygen, and in the longwave up to four types of halocarbons (CFCs). To represent statistically the unresolved subgrid cloud variability when dealing multi layered clouds, a Monte-Carlo Independent Column Approximation (McICA) method is used in the RRTMG radiative transfer. A maximum-random cloud overlap method is used in both LW and SW radiation calculations. Cloud condensate path and effective radius for water and ice are used for the calculation of cloud-radiative properties. Hu and Stamnes's method (1993) <a class="el" href="citelist.html#CITEREF_hu_and_stamnes_1993">[31]</a> is used to treat water clouds in both LW and SW parameterizations. For ice clouds. Fu's parameterizations (1996,1998) <a class="el" href="citelist.html#CITEREF_fu_1996">[21]</a> <a class="el" href="citelist.html#CITEREF_fu_et_al_1998">[20]</a> are used in the SW and LW, respectively.</p>
<p>In the operational GFS, a climatological tropospheric aerosol with a 5-degree horizontal resolution is used in both LW and SW radiations. A generalized spectral mapping formulation was developed to compute radiative properties of various aerosol components for each of the radiation spectral bands. A separate stratospheric volcanic aerosol parameterization was added that is capable of handling volcanic events. In SW, a new table of incoming solar constants is derived covering time period of 1850-2019 (Vandendool, personal communivation). An eleven-year solar cycle approximation will be used for time out of the window period in long term climate simulations. The SW albedo parameterization uses surface vegetation type based seasonal climatology similar to that described in the NCEP OFFICE Note 441 (Hou et al. 2002 <a class="el" href="citelist.html#CITEREF_hou_et_al_2002">[30]</a>) but with a modification in the treatment of solar zenith angle dependency over snow-free land surface (Yang et al. 2008 <a class="el" href="citelist.html#CITEREF_yang_et_al_2008">[63]</a>). Similarly, vegetation type based non-black-body surface emissivity is used for the LW radiation. Concentrations of atmospheric greenhouse gases are either obtained from global network measurements, such as carbon dioxide (CO2), or taking the climatological constants, the actual CO2 value for the forecast time is an estimation based on the most recent five-year observations. In the lower atmosphere (&lt;3km) a monthly mean CO2 distribution in 15 degree horizontal resolution is used, while a global mean monthly value is used in the upper atmosphere. </p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="groups"></a>
Modules</h2></td></tr>
<tr class="memitem:group__module__radiation__driver"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__module__radiation__driver.html">module_radiation_driver</a></td></tr>
<tr class="memdesc:group__module__radiation__driver"><td class="mdescLeft">&#160;</td><td class="mdescRight">The GFS radiation driver module. <br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">Generated by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.13 </li>
  </ul>
</div>
</body>
</html>

<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.13"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>GFS Physics Documentation: Precipitation (snow or rain) Production</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { init_search(); });
</script>
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    extensions: ["tex2jax.js"],
    jax: ["input/TeX","output/HTML-CSS"],
});
</script><script type="text/javascript" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="ccpp_dox_extra_style.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="ncep.jpg"/></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">GFS Physics Documentation
   </div>
  </td>
   <td>        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
</td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.13 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('group__precip.html','');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">Precipitation (snow or rain) Production</div>  </div>
</div><!--header-->
<div class="contents">

<p>This subroutine computes the conversion from condensation to precipitation (snow or rain) or evaporation of rain.  
<a href="#details">More...</a></p>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<p>The parameterization of precipitation is required in order to remove water from the atmosphere and transport it to the ground. In the scheme discussed here, simplifications in the precipitation parameterization are used due to computational limitations required by operational NWP models. First, consideration of particle size and shape can be avoided by using the bulk parameterization method introduced by Kessler (1969) <a class="el" href="citelist.html#CITEREF_kessler_1969">[35]</a>. Second, only two types of precipitation, rain and snow, are considered in this scheme. Third, only the most important microphysical processes associated with the formation of rain and snow are included. Figure 2 presents the microphysical processes considered in the precipitation parameterization. </p><div class="image">
<img src="precpd-micop.png" alt="precpd-micop.png" width="500cm"/>
<div class="caption">
Figure 2: Microphysical processes simulated in the precipitation scheme </div></div>
<p> Basically, there are four types of microphysical processes considered here:</p><ul>
<li>production of rain from cloud water ( \(P_{racw}\), \(P_{raut}\), \(P_{sacw}\))</li>
<li>production of snow from cloud ice ( \(P_{saut}\), \(P_{saci}\))</li>
<li>melting of snow to form rain below the freezing level ( \(P_{sm1}\), \(P_{sm2}\))</li>
<li>the evaporation of precipitation ( \(E_{rr}\), \(E_{rs}\))</li>
</ul>
<p>The following two equations can be used to calculate the precipitation rates of rain and snow at each module level: </p><p class="formulaDsp">
\[ P_{r}(\eta)=\frac{p_{s}-p_{t}}{g\eta_{s}}\int_{\eta}^{\eta_{t}}(P_{raut}+P_{racw}+P_{sacw}+P_{sm1}+P_{sm2}-E_{rr})d\eta \]
</p>
<p> and </p><p class="formulaDsp">
\[ P_{s}(\eta)=\frac{p_{s}-p_{t}}{g\eta_{s}}\int_{\eta}^{\eta_{t}}(P_{saut}+P_{saci}-P_{sm1}-P_{sm2}-E_{rs})d\eta \]
</p>
<p> where \(p_{s}\) and \(p_{t}\) are the surface pressure and the pressure at the top of model domain, respectively, and \(g\) is gravity. The implementation of the precipitation scheme also includes a simplified procedure of computing \(P_{r}\) and \(P_{s}\) (Zhao and Carr(1997) <a class="el" href="citelist.html#CITEREF_zhao_and_carr_1997">[66]</a>). </p>
<table class="memberdecls">
<tr class="memitem:ga5b7dbb93ea6f466ef61be5b331cbc265"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__precip.html#ga5b7dbb93ea6f466ef61be5b331cbc265">precpd</a> (im, ix, km, dt, del, prsl, q, cwm, t, rn, sr, rainp, u00k, psautco, prautco, evpco, wminco, lprnt, jpr)</td></tr>
<tr class="separator:ga5b7dbb93ea6f466ef61be5b331cbc265"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<h2 class="groupheader">Function/Subroutine Documentation</h2>
<a id="ga5b7dbb93ea6f466ef61be5b331cbc265"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga5b7dbb93ea6f466ef61be5b331cbc265">&#9670;&nbsp;</a></span>precpd()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine precpd </td>
          <td>(</td>
          <td class="paramtype">integer&#160;</td>
          <td class="paramname"><em>im</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer&#160;</td>
          <td class="paramname"><em>ix</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer&#160;</td>
          <td class="paramname"><em>km</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real (kind=kind_phys)&#160;</td>
          <td class="paramname"><em>dt</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real (kind=kind_phys), dimension(ix,km)&#160;</td>
          <td class="paramname"><em>del</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real (kind=kind_phys), dimension(ix,km)&#160;</td>
          <td class="paramname"><em>prsl</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real (kind=kind_phys), dimension(ix,km)&#160;</td>
          <td class="paramname"><em>q</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real (kind=kind_phys), dimension(ix,km)&#160;</td>
          <td class="paramname"><em>cwm</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real (kind=kind_phys), dimension(ix,km)&#160;</td>
          <td class="paramname"><em>t</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real (kind=kind_phys), dimension(im)&#160;</td>
          <td class="paramname"><em>rn</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real (kind=kind_phys), dimension(im)&#160;</td>
          <td class="paramname"><em>sr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real (kind=kind_phys), dimension(im,km)&#160;</td>
          <td class="paramname"><em>rainp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real (kind=kind_phys), dimension(im,km)&#160;</td>
          <td class="paramname"><em>u00k</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real (kind=kind_phys), dimension(im)&#160;</td>
          <td class="paramname"><em>psautco</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real (kind=kind_phys), dimension(im)&#160;</td>
          <td class="paramname"><em>prautco</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real (kind=kind_phys)&#160;</td>
          <td class="paramname"><em>evpco</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real (kind=kind_phys), dimension(2)&#160;</td>
          <td class="paramname"><em>wminco</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">logical&#160;</td>
          <td class="paramname"><em>lprnt</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer&#160;</td>
          <td class="paramname"><em>jpr</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">im</td><td>horizontal number of used pts </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">ix</td><td>horizontal dimension </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">km</td><td>vertical layer dimension </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">dt</td><td>time step in seconds </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">del</td><td>pressure layer thickness (bottom to top) </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">prsl</td><td>pressure values for model layers (bottom to top) </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">q</td><td>specific humidity (updated in the code) </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">cwm</td><td>condensate mixing ratio (updated in the code) </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">t</td><td>temperature (updated in the code) </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">rn</td><td>precipitation over one time-step dt (m/dt) </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">sr</td><td>"snow ratio", ratio of snow to total precipitation </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">rainp</td><td>rainwater path </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">u00k</td><td>the critical value of relative humidity for large-scale condensation </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">psautco</td><td>auto conversion coeff from ice to snow <br />
 = 4.0E-4; defined in module_MP_GFS.F90 </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">prautco</td><td>auto conversion coeff from cloud to rain <br />
 = 1.0E-4; defined in module_MP_GFS.F90 </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">evpco</td><td>coeff for evaporation of largescale rain <br />
 = 2.0E-5; defined in module_MP_GFS.F90 </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">wminco</td><td>coeff for water and ice minimum threshold to conversion from condensate to precipitation <br />
 = \1.0E-5, 1.0E-5\; defined in module_MP_GFS.F90 </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">lprnt</td><td>logical print flag </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">jpr</td><td>check print point for debugging </td></tr>
  </table>
  </dd>
</dl>
<h1><a class="anchor" id="general"></a>
General Algorithm</h1>
<ol type="1">
<li>Select columns where rain can be produced, where <p class="formulaDsp">
\[ cwm &gt; \min (wmin, wmini) \]
</p>
 where the cloud water and ice conversion threshold: <p class="formulaDsp">
\[ wmin=wminco(1)\times prsl\times 10^{-5} \]
</p>
 <p class="formulaDsp">
\[ wmini=wminco(2)\times prsl\times 10^{-5} \]
</p>
</li>
<li>Compute ice-water identification number IW (see algorithm in <a class="el" href="group__condense.html">Grid-Scale Condensation and Evaporation of Cloud</a>).</li>
<li>Calculate cloud fraction \(b\) (see algorithm in <a class="el" href="group__condense.html">Grid-Scale Condensation and Evaporation of Cloud</a>)</li>
<li>Precipitation production by auto conversion and accretion<ul>
<li>The autoconversion of cloud ice to snow ( \(P_{saut}\)) is simulated using the equation from Lin et al. (1983) <a class="el" href="citelist.html#CITEREF_lin_et_al_1983">[39]</a> <p class="formulaDsp">
\[ P_{saut}=a_{1}(cwm-wmini) \]
</p>
 Since snow production in this process is caused by the increase in size of cloud ice particles due to depositional growth and aggregation of small ice particles, \(P_{saut}\) is a function of temperature as determined by coefficient \(a_{1}\), given by <p class="formulaDsp">
\[ a_{1}=psautco \times dt \times exp\left[ 0.025\left(T-273.15\right)\right] \]
</p>
</li>
<li>The accretion of cloud ice by snow ( \(P_{saci}\)) in the regions where cloud ice exists is simulated by <p class="formulaDsp">
\[ P_{saci}=C_{s}cwm P_{s} \]
</p>
 where \(P_{s}\) is the precipitation rate of snow. The collection coefficient \(C_{s}\) is a function of temperature since the open structures of ice crystals at relative warm temperatures are more likely to stick, given a collision, than crystals of other shapes (Rogers 1979 <a class="el" href="citelist.html#CITEREF_rogers_1979">[53]</a>). Above the freezing level, \(C_{s}\) is expressed by <p class="formulaDsp">
\[ C_{s}=c_{1}exp\left[ 0.025\left(T-273.15\right)\right] \]
</p>
 where \(c_{1}=1.25\times 10^{-3} m^{2}kg^{-1}s^{-1}\) are used. \(C_{s}\) is set to zero below the freezing level.</li>
<li>Following Sundqvist et al. (1989) <a class="el" href="citelist.html#CITEREF_sundqvist_et_al_1989">[59]</a>, the autoconversion of cloud water to rain ( \(P_{raut}\)) can be parameterized from the cloud water mixing ratio \(m\) and cloud coverage \(b\), that is, <p class="formulaDsp">
\[ P_{raut}=(prautco \times dt )\times (cwm-wmin)\left\{1-exp[-(\frac{cwm-wmin}{m_{r}b})^{2}]\right\} \]
</p>
 where \(m_{r}\) is \(3.0\times 10^{-4}\).</li>
<li>Calculate the accretion of cloud water by rain \(P_{racw}\), can be expressed using the cloud mixing ratio \(cwm\) and rainfall rate \(P_{r}\): <p class="formulaDsp">
\[ P_{saci}=C_{s}cwmP_{r} \]
</p>
 where \(C_{r}=5.0\times10^{-4}m^{2}kg^{-1}s{-1}\) is the collection coeffiecient. Note that this process is not included in current operational physcics.</li>
</ul>
</li>
<li>Evaporation of precipitation ( \(E_{rr}\) and \(E_{rs}\)) <br />
 Evaporation of precipitation is an important process that moistens the layers below cloud base. Through this process, some of the precipitating water is evaporated back to the atmosphere and the precipitation efficiency is reduced.<ul>
<li>Evaporation of rain is calculated using the equation (Sundqvist 1988 <a class="el" href="citelist.html#CITEREF_sundqvist_1988">[60]</a>): <p class="formulaDsp">
\[ E_{rr}= evpco \times (u-f)(P_{r})^{\beta} \]
</p>
 where \(u\) is u00k, \(f\) is the relative humidity. \(\beta = 0.5\) are empirical parameter.</li>
<li>Evaporation of snow is calculated using the equation: <p class="formulaDsp">
\[ E_{rs}=[C_{rs1}+C_{rs2}(T-273.15)](\frac{u-f}{u})P_{s} \]
</p>
 where \(C_{rs1}=5\times 10^{-6}m^{2}kg^{-1}s^{-1}\) and \(C_{rs2}=6.67\times 10^{-10}m^{2}kg^{-1}K^{-1}s^{-1}\). The evaporation of melting snow below the freezing level is ignored in this scheme because of the difficulty in the latent heat treatment since the surface of a melting snowflake is usually covered by a thin layer of liquid water.</li>
</ul>
</li>
<li>Melting of snow ( \(P_{sm1}\) and \(P_{sm2}\)) <br />
 In this scheme, we allow snow melting to take place in certain temperature regions below the freezing level in two ways. In both cases, the melted snow is assumed to become raindrops.<ul>
<li>One is the continuous melting of snow due to the increase in temperature as it falls down through the freezing level. This process is parameterized as a function of temperature and snow precipitation rate, that is, <p class="formulaDsp">
\[ P_{sm1}=C_{sm}(T-273.15)^{2}P_{s} \]
</p>
 where \(C_{sm}=5\times 10^{-8}m^{2}kg^{-1}K^{-2}s^{-1}\) cause the falling snow to melt almost completely before it reaches the \(T=278.15 K\) level.</li>
<li>Another is the immediate melting of melting snow by collection of the cloud water below the freezing level. In order to calculate the melting rate, the collection rate of cloud water by melting snow is computed first. Similar to the collection of cloud water by rain, the collection of cloud water by melting snow can be parameterized to be proportional to the cloud water mixing ratio \(m\) and the precipitation rate of snow \(P_{s}\): <p class="formulaDsp">
\[ P_{sacw}=C_{r}cwmP_{s} \]
</p>
 where \(C_{r}\) is the collection coefficient, \(C_{r}=5.0\times 10^{-4}m^{2}kg^{-1}s^{-1}\) . The melting rate of snow then can be computed from <p class="formulaDsp">
\[ P_{sm2}=C_{ws}P_{sacw} \]
</p>
 where \(C_{ws}=0.025\).</li>
<li>Update t and q. <p class="formulaDsp">
\[ t=t-\frac{L}{C_{p}}(E_{rr}+E_{rs}+P_{sm1})\times dt \]
</p>
 <p class="formulaDsp">
\[ q=q+(E_{rr}+E_{rs})\times dt \]
</p>
</li>
</ul>
</li>
<li>Compute precipitation at surface ( \(rn\))and determine fraction of frozen precipitation ( \(sr\)). <p class="formulaDsp">
\[ rn= (P_{r}(\eta_{sfc})+P_{s}(\eta_{sfc}))/10^3 \]
</p>
 <p class="formulaDsp">
\[ sr=\frac{P_{s}(\eta_{sfc})}{P_{s}(\eta_{sfc})+P_{r}(\eta_{sfc})} \]
</p>
 </li>
</ol>

<p class="definition">Definition at line <a class="el" href="precpd_8f_source.html#l00080">80</a> of file <a class="el" href="precpd_8f_source.html">precpd.f</a>.</p>

</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">Generated by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.13 </li>
  </ul>
</div>
</body>
</html>

<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.13"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>GFS Physics Documentation: Hybrid Eddy-diffusivity Mass-flux Scheme</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { init_search(); });
</script>
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    extensions: ["tex2jax.js"],
    jax: ["input/TeX","output/HTML-CSS"],
});
</script><script type="text/javascript" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="ccpp_dox_extra_style.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="ncep.jpg"/></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">GFS Physics Documentation
   </div>
  </td>
   <td>        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
</td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.13 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('group___h_e_d_m_e.html','');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#func-members">Functions/Subroutines</a>  </div>
  <div class="headertitle">
<div class="title">Hybrid Eddy-diffusivity Mass-flux Scheme</div>  </div>
</div><!--header-->
<div class="contents">

<p>The Hybrid EDMF scheme is a first-order turbulent transport scheme used for subgrid-scale vertical turbulent mixing in the PBL and above. It blends the traditional first-order approach that has been used and improved over the last several years with a more recent scheme that uses a mass-flux approach to calculate the countergradient diffusion terms.  
<a href="#details">More...</a></p>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<p>The PBL scheme's main task is to calculate tendencies of temperature, moisture, and momentum due to vertical diffusion throughout the column (not just the PBL). The scheme is an amalgamation of decades of work, starting from the initial first-order PBL scheme of Troen and Mahrt (1986) <a class="el" href="citelist.html#CITEREF_troen_and_mahrt_1986">[61]</a>, implemented according to Hong and Pan (1996) <a class="el" href="citelist.html#CITEREF_hong_and_pan_1996">[29]</a> and modified by Han and Pan (2011) <a class="el" href="citelist.html#CITEREF_han_and_pan_2011">[24]</a> and Han et al. (2015) <a class="el" href="citelist.html#CITEREF_han_et_al_2015">[25]</a> to include top-down mixing due to stratocumulus layers from Lock et al. (2000) <a class="el" href="citelist.html#CITEREF_lock_et_al_2000">[41]</a> and replacement of counter-gradient terms with a mass flux scheme according to Siebesma et al. (2007) <a class="el" href="citelist.html#CITEREF_siebesma_et_al_2007">[57]</a> and Soares et al. (2004) <a class="el" href="citelist.html#CITEREF_soares_et_al_2004">[58]</a>. Recently, heating due to TKE dissipation was also added according to Han et al. (2015) <a class="el" href="citelist.html#CITEREF_han_et_al_2015">[25]</a>.</p>
<h1><a class="anchor" id="diagram"></a>
Calling Hierarchy Diagram</h1>
<div class="image">
<img src="Hybrid_EDMF_Flowchart.png" alt="Hybrid_EDMF_Flowchart.png" height="2cm"/>
<div class="caption">
Diagram depicting how the Hybrid EDMF PBL scheme is called from the GSM physics time loop</div></div>
 <h1><a class="anchor" id="intraphysics"></a>
Intraphysics Communication</h1>
<p>This space is reserved for a description of how this scheme uses information from other scheme types and/or how information calculated in this scheme is used in other scheme types. </p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions/Subroutines</h2></td></tr>
<tr class="memitem:ga80bebdc639adaba3ed0ed2ea2f24315e"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group___h_e_d_m_e.html#ga80bebdc639adaba3ed0ed2ea2f24315e">tridi2</a> (l, n, cl, cm, cu, r1, r2, au, a1, a2)</td></tr>
<tr class="memdesc:ga80bebdc639adaba3ed0ed2ea2f24315e"><td class="mdescLeft">&#160;</td><td class="mdescRight">Routine to solve the tridiagonal system to calculate temperature and moisture at \( t + \Delta t \); part of two-part process to calculate time tendencies due to vertical diffusion.  <a href="#ga80bebdc639adaba3ed0ed2ea2f24315e">More...</a><br /></td></tr>
<tr class="separator:ga80bebdc639adaba3ed0ed2ea2f24315e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga367b6dabfff601023af323f900db86d2"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group___h_e_d_m_e.html#ga367b6dabfff601023af323f900db86d2">moninedmf</a> (ix, im, km, ntrac, ntcw, dv, du, tau, rtg, u1, v1, t1, q1, swh, hlw, xmu, psk, rbsoil, zorl, u10m, v10m, fm, fh, tsea, qss, heat, evap, stress, spd1, kpbl, prsi, del, prsl, prslk, phii, phil, delt, dspheat, dusfc, dvsfc, dtsfc, dqsfc, hpbl, hgamt, hgamq, dkt, kinver, xkzm_m, xkzm_h, xkzm_s, lprnt, ipr, xkzminv, moninq_fac)</td></tr>
<tr class="memdesc:ga367b6dabfff601023af323f900db86d2"><td class="mdescLeft">&#160;</td><td class="mdescRight">This subroutine contains all of logic for the Hybrid EDMF PBL scheme except for the calculation of the updraft properties and mass flux.  <a href="#ga367b6dabfff601023af323f900db86d2">More...</a><br /></td></tr>
<tr class="separator:ga367b6dabfff601023af323f900db86d2"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<h2 class="groupheader">Function/Subroutine Documentation</h2>
<a id="ga367b6dabfff601023af323f900db86d2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga367b6dabfff601023af323f900db86d2">&#9670;&nbsp;</a></span>moninedmf()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine moninedmf </td>
          <td>(</td>
          <td class="paramtype">integer&#160;</td>
          <td class="paramname"><em>ix</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer&#160;</td>
          <td class="paramname"><em>im</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer&#160;</td>
          <td class="paramname"><em>km</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer&#160;</td>
          <td class="paramname"><em>ntrac</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer&#160;</td>
          <td class="paramname"><em>ntcw</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(kind=kind_phys), dimension(im,km)&#160;</td>
          <td class="paramname"><em>dv</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(kind=kind_phys), dimension(im,km)&#160;</td>
          <td class="paramname"><em>du</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(kind=kind_phys), dimension(im,km)&#160;</td>
          <td class="paramname"><em>tau</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(kind=kind_phys), dimension(im,km,ntrac)&#160;</td>
          <td class="paramname"><em>rtg</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(kind=kind_phys), dimension(ix,km)&#160;</td>
          <td class="paramname"><em>u1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(kind=kind_phys), dimension(ix,km)&#160;</td>
          <td class="paramname"><em>v1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(kind=kind_phys), dimension(ix,km)&#160;</td>
          <td class="paramname"><em>t1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(kind=kind_phys), dimension(ix,km,ntrac)&#160;</td>
          <td class="paramname"><em>q1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(kind=kind_phys), dimension(ix,km)&#160;</td>
          <td class="paramname"><em>swh</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(kind=kind_phys), dimension(ix,km)&#160;</td>
          <td class="paramname"><em>hlw</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(kind=kind_phys), dimension(im)&#160;</td>
          <td class="paramname"><em>xmu</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(kind=kind_phys), dimension(im)&#160;</td>
          <td class="paramname"><em>psk</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(kind=kind_phys), dimension(im)&#160;</td>
          <td class="paramname"><em>rbsoil</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(kind=kind_phys), dimension(im)&#160;</td>
          <td class="paramname"><em>zorl</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(kind=kind_phys), dimension(im)&#160;</td>
          <td class="paramname"><em>u10m</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(kind=kind_phys), dimension(im)&#160;</td>
          <td class="paramname"><em>v10m</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(kind=kind_phys), dimension(im)&#160;</td>
          <td class="paramname"><em>fm</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(kind=kind_phys), dimension(im)&#160;</td>
          <td class="paramname"><em>fh</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(kind=kind_phys), dimension(im)&#160;</td>
          <td class="paramname"><em>tsea</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(kind=kind_phys), dimension(im)&#160;</td>
          <td class="paramname"><em>qss</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(kind=kind_phys), dimension(im)&#160;</td>
          <td class="paramname"><em>heat</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(kind=kind_phys), dimension(im)&#160;</td>
          <td class="paramname"><em>evap</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(kind=kind_phys), dimension(im)&#160;</td>
          <td class="paramname"><em>stress</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(kind=kind_phys), dimension(im)&#160;</td>
          <td class="paramname"><em>spd1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, dimension(im)&#160;</td>
          <td class="paramname"><em>kpbl</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(kind=kind_phys), dimension(ix,km+1)&#160;</td>
          <td class="paramname"><em>prsi</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(kind=kind_phys), dimension(ix,km)&#160;</td>
          <td class="paramname"><em>del</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(kind=kind_phys), dimension(ix,km)&#160;</td>
          <td class="paramname"><em>prsl</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(kind=kind_phys), dimension(ix,km)&#160;</td>
          <td class="paramname"><em>prslk</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(kind=kind_phys), dimension(ix,km+1)&#160;</td>
          <td class="paramname"><em>phii</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(kind=kind_phys), dimension(ix,km)&#160;</td>
          <td class="paramname"><em>phil</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(kind=kind_phys)&#160;</td>
          <td class="paramname"><em>delt</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">logical&#160;</td>
          <td class="paramname"><em>dspheat</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(kind=kind_phys), dimension(im)&#160;</td>
          <td class="paramname"><em>dusfc</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(kind=kind_phys), dimension(im)&#160;</td>
          <td class="paramname"><em>dvsfc</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(kind=kind_phys), dimension(im)&#160;</td>
          <td class="paramname"><em>dtsfc</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(kind=kind_phys), dimension(im)&#160;</td>
          <td class="paramname"><em>dqsfc</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(kind=kind_phys), dimension(im)&#160;</td>
          <td class="paramname"><em>hpbl</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(kind=kind_phys), dimension(im)&#160;</td>
          <td class="paramname"><em>hgamt</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(kind=kind_phys), dimension(im)&#160;</td>
          <td class="paramname"><em>hgamq</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(kind=kind_phys), dimension(im,km-1)&#160;</td>
          <td class="paramname"><em>dkt</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, dimension(im)&#160;</td>
          <td class="paramname"><em>kinver</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(kind=kind_phys)&#160;</td>
          <td class="paramname"><em>xkzm_m</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(kind=kind_phys)&#160;</td>
          <td class="paramname"><em>xkzm_h</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(kind=kind_phys)&#160;</td>
          <td class="paramname"><em>xkzm_s</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">logical&#160;</td>
          <td class="paramname"><em>lprnt</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer&#160;</td>
          <td class="paramname"><em>ipr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>xkzminv</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(kind=kind_phys)&#160;</td>
          <td class="paramname"><em>moninq_fac</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>The scheme works on a basic level by calculating background diffusion coefficients and updating them according to which processes are occurring in the column. The most important difference in diffusion coefficients occurs between those levels in the PBL and those above the PBL, so the PBL height calculation is of utmost importance. An initial estimate is calculated in a "predictor" step in order to calculate Monin-Obukhov similarity values and a corrector step recalculates the PBL height based on updated surface thermal characteristics. Using the PBL height and the similarity parameters, the diffusion coefficients are updated below the PBL top based on Hong and Pan (1996) <a class="el" href="citelist.html#CITEREF_hong_and_pan_1996">[29]</a> (including counter-gradient terms). Diffusion coefficients in the free troposphere (above the PBL top) are calculated according to Louis (1979) <a class="el" href="citelist.html#CITEREF_louis_1979">[43]</a> with updated Richardson number-dependent functions. If it is diagnosed that PBL top-down mixing is occurring according to Lock et al. (2000) <a class="el" href="citelist.html#CITEREF_lock_et_al_2000">[41]</a> , then then diffusion coefficients are updated accordingly. Finally, for convective boundary layers (defined as when the Obukhov length exceeds a threshold), the counter-gradient terms are replaced using the mass flux scheme of Siebesma et al. (2007) <a class="el" href="citelist.html#CITEREF_siebesma_et_al_2007">[57]</a> . In order to return time tendencies, a fully implicit solution is found using tridiagonal matrices, and time tendencies are "backed out." Before returning, the time tendency of temperature is updated to reflect heating due to TKE dissipation following Han et al. (2015) <a class="el" href="citelist.html#CITEREF_han_et_al_2015">[25]</a> .</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">ix</td><td>horizontal dimension </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">im</td><td>number of used points </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">km</td><td>vertical layer dimension </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">ntrac</td><td>number of tracers </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">ntcw</td><td>cloud condensate index in the tracer array </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">dv</td><td>v-momentum tendency ( \( m s^{-2} \)) </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">du</td><td>u-momentum tendency ( \( m s^{-2} \)) </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">tau</td><td>temperature tendency ( \( K s^{-1} \)) </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">rtg</td><td>moisture tendency ( \( kg kg^{-1} s^{-1} \)) </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">u1</td><td>u component of layer wind ( \( m s^{-1} \)) </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">v1</td><td>v component of layer wind ( \( m s^{-1} \)) </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">t1</td><td>layer mean temperature ( \( K \)) </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">q1</td><td>layer mean tracer concentration (units?) </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">swh</td><td>total sky shortwave heating rate ( \( K s^-1 \)) </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">hlw</td><td>total sky longwave heating rate ( \( K s^-1 \)) </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">xmu</td><td>time step zenith angle adjust factor for shortwave </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">psk</td><td>Exner function at surface interface? </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">rbsoil</td><td>surface bulk Richardson number </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">zorl</td><td>surface roughness (units?) </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">u10m</td><td>10-m u wind ( \( m s^{-1} \)) </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">v10m</td><td>10-m v wind ( \( m s^{-1} \)) </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">fm</td><td>fm parameter from PBL scheme </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">fh</td><td>fh parameter from PBL scheme </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">tsea</td><td>ground surface temperature (K) </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">qss</td><td>surface saturation humidity (units?) </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">heat</td><td>surface sensible heat flux (units?) </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">evap</td><td>evaporation from latent heat flux (units?) </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">stress</td><td>surface wind stress? ( \( cm*v^2\) in sfc_diff subroutine) (units?) </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">spd1</td><td>surface wind speed? (units?) </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">kpbl</td><td>PBL top index </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">prsi</td><td>pressure at layer interfaces (units?) </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">del</td><td>pressure difference between level k and k+1 (units?) </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">prsl</td><td>mean layer pressure (units?) </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">prslk</td><td>Exner function at layer </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">phii</td><td>interface geopotential height (units?) </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">phil</td><td>layer geopotential height (units?) </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">delt</td><td>physics time step (s) </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">dspheat</td><td>flag for TKE dissipative heating </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">dusfc</td><td>surface u-momentum tendency (units?) </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">dvsfc</td><td>surface v-momentum tendency (units?) </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">dtsfc</td><td>surface temperature tendency (units?) </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">dqsfc</td><td>surface moisture tendency (units?) </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">hpbl</td><td>PBL top height (m) </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">hgamt</td><td>counter gradient mixing term for temperature (units?) </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">hgamq</td><td>counter gradient mixing term for moisture (units?) </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">dkt</td><td>diffusion coefficient for temperature (units?) </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">kinver</td><td>index location of temperature inversion </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">xkzm_m</td><td>background vertical diffusion coefficient for momentum (units?) </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">xkzm_h</td><td>background vertical diffusion coefficeint for heat, moisture (units?) </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">xkzm_s</td><td>sigma threshold for background momentum diffusion (units?) </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">lprnt</td><td>flag to print some output </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">ipr</td><td>index of point to print</td></tr>
  </table>
  </dd>
</dl>
<h1><a class="anchor" id="general"></a>
General Algorithm</h1>
<ol type="1">
<li>Compute preliminary variables from input arguments.</li>
<li>Calculate the first estimate of the PBL height ("Predictor step").</li>
<li>Calculate Monin-Obukhov similarity parameters.</li>
<li>Update thermal properties of surface parcel and recompute PBL height ("Corrector step").</li>
<li>Determine whether stratocumulus layers exist and compute quantities needed for enhanced diffusion.</li>
<li>Calculate the inverse Prandtl number.</li>
<li>Compute diffusion coefficients below the PBL top.</li>
<li>Compute diffusion coefficients above the PBL top.</li>
<li>If the PBL is convective, call the mass flux scheme to replace the countergradient terms.</li>
<li>Compute enhanced diffusion coefficients related to stratocumulus-topped PBLs.</li>
<li>Solve for the temperature and moisture tendencies due to vertical mixing.</li>
<li>Calculate heating due to TKE dissipation and add to the tendency for temperature.</li>
<li>Solve for the horizontal momentum tendencies and add them to output tendency terms. </li>
</ol>
<h1><a class="anchor" id="detailed"></a>
Detailed Algorithm</h1>
<h2>Compute preliminary variables from input arguments</h2>
<ul>
<li>Compute physical height of the layer centers and interfaces from the geopotential height (zi and zl)</li>
<li>Compute reciprocal of \( \Delta z \) (rdzt)</li>
<li>Compute reciprocal of pressure (tx1, tx2)</li>
<li>Compute background vertical diffusivities for scalars and momentum (xkzo and xkzmo)</li>
<li>The background scalar vertical diffusivity is limited to be less than or equal to xkzminv</li>
<li>Some output variables and logical flags are initialized</li>
<li>Compute \(\theta\) (theta), \(q_l\) (qlx), \(q_t\) (qtx), \(\theta_e\) (thetae), \(\theta_v\) (thvx), \(\theta_{l,v}\) (thlvx)</li>
<li>Initialize diffusion coefficients to 0 and calculate the total radiative heating rate (dku, dkt, radx)</li>
<li>Set lcld to first index above 2.5km</li>
<li>Compute \(\frac{\partial \theta_v}{\partial z}\) (bf) and the wind shear squared (shr2)</li>
<li>Calculate \(\frac{g}{\theta}\) (govrth), \(\beta = \frac{\Delta t}{\Delta z}\) (beta), \(u_*\) (ustar), total surface flux (sflux), and set pblflag to false if the total surface energy flux is into the surface</li>
</ul>
<h2>Calculate the first estimate of the PBL height (``Predictor step")</h2>
<p>The calculation of the boundary layer height follows Troen and Mahrt (1986) <a class="el" href="citelist.html#CITEREF_troen_and_mahrt_1986">[61]</a> section 3. The approach is to find the level in the column where a modified bulk Richardson number exceeds a critical value.</p>
<p>The temperature of the thermal is of primary importance. For the initial estimate of the PBL height, the thermal is assumed to have one of two temperatures. If the boundary layer is stable, the thermal is assumed to have a temperature equal to the surface virtual temperature. Otherwise, the thermal is assumed to have the same virtual potential temperature as the lowest model level. For the stable case, the critical bulk Richardson number becomes a function of the wind speed and roughness length, otherwise it is set to a tunable constant.</p>
<p>Given the thermal's properties and the critical Richardson number, a loop is executed to find the first level above the surface where the modified Richardson number is greater than the critical Richardson number, using equation 10a from Troen and Mahrt (1986) <a class="el" href="citelist.html#CITEREF_troen_and_mahrt_1986">[61]</a> (also equation 8 from Hong and Pan (1996) <a class="el" href="citelist.html#CITEREF_hong_and_pan_1996">[29]</a>): </p><p class="formulaDsp">
\[ h = Ri\frac{T_0\left|\vec{v}(h)\right|^2}{g\left(\theta_v(h) - \theta_s\right)} \]
</p>
<p> where \(h\) is the PBL height, \(Ri\) is the Richardson number, \(T_0\) is the virtual potential temperature near the surface, \(\left|\vec{v}\right|\) is the wind speed, and \(\theta_s\) is for the thermal. Rearranging this equation to calculate the modified Richardson number at each level, k, for comparison with the critical value yields: </p><p class="formulaDsp">
\[ Ri_k = gz(k)\frac{\left(\theta_v(k) - \theta_s\right)}{\theta_v(1)*\vec{v}(k)} \]
</p>
<p>Once the level is found, some linear interpolation is performed to find the exact height of the boundary layer top (where \(Ri = Ri_{cr}\)) and the PBL height and the PBL top index are saved (hpblx and kpblx, respectively)</p>
<h2>Calculate Monin-Obukhov similarity parameters</h2>
<p>Using the initial guess for the PBL height, Monin-Obukhov similarity parameters are calculated. They are needed to refine the PBL height calculation and for calculating diffusion coefficients.</p>
<p>First, calculate the Monin-Obukhov nondimensional stability parameter, commonly referred to as \(\zeta\) using the following equation from Businger et al. (1971) <a class="el" href="citelist.html#CITEREF_businger_et_al_1971">[9]</a> (equation 28): </p><p class="formulaDsp">
\[ \zeta = Ri_{sfc}\frac{F_m^2}{F_h} = \frac{z}{L} \]
</p>
<p> where \(F_m\) and \(F_h\) are surface Monin-Obukhov stability functions calculated in <a class="el" href="sfc__diff_8f_source.html">sfc_diff.f</a> and \(L\) is the Obukhov length. Then, the nondimensional gradients of momentum and temperature (phim and phih) are calculated using equations 5 and 6 from Hong and Pan (1996) <a class="el" href="citelist.html#CITEREF_hong_and_pan_1996">[29]</a> depending on the surface layer stability. Then, the velocity scale valid for the surface layer ( \(w_s\), wscale) is calculated using equation 3 from Hong and Pan (1996) <a class="el" href="citelist.html#CITEREF_hong_and_pan_1996">[29]</a>. For the neutral and unstable PBL above the surface layer, the convective velocity scale, \(w_*\), is calculated according to: </p><p class="formulaDsp">
\[ w_* = \left(\frac{g}{\theta_0}h\overline{w&#39;\theta_0&#39;}\right)^{1/3} \]
</p>
<p> and the mixed layer velocity scale is then calculated with equation 6 from Troen and Mahrt (1986) <a class="el" href="citelist.html#CITEREF_troen_and_mahrt_1986">[61]</a> </p><p class="formulaDsp">
\[ w_s = (u_*^3 + 7\epsilon k w_*^3)^{1/3} \]
</p>
<h2>Update thermal properties of surface parcel and recompute PBL height ("Corrector step").</h2>
<p>Next, the counter-gradient terms for temperature and humidity are calculated using equation 4 of Hong and Pan (1996) <a class="el" href="citelist.html#CITEREF_hong_and_pan_1996">[29]</a> and are used to calculate the "scaled virtual temperature excess near the surface" (equation 9 in Hong and Pan (1996) <a class="el" href="citelist.html#CITEREF_hong_and_pan_1996">[29]</a>) so that the properties of the thermal are updated to recalculate the PBL height.</p>
<p>The PBL height calculation follows the same procedure as the predictor step, except that it uses an updated virtual potential temperature for the thermal.</p>
<h2>Determine whether stratocumulus layers exist and compute quantities needed for enhanced diffusion</h2>
<ul>
<li>Starting at the PBL top and going downward, if the level is less than 2.5 km and \(q_l&gt;q_{l,cr}\) then set kcld = k (find the cloud top index in the PBL). If no cloud water above the threshold is found, scuflg is set to F.</li>
<li>Starting at the PBL top and going downward, if the level is less than the cloud top, find the level of the minimum radiative heating rate within the cloud. If the level of the minimum is the lowest model level or the minimum radiative heating rate is positive, then set scuflg to F.</li>
<li>Starting at the PBL top and going downward, count the number of levels below the minimum radiative heating rate level that have cloud water above the threshold. If there are none, then set the scuflg to F.</li>
<li>Find the height of the interface where the minimum in radiative heating rate is located. If this height is less than the second model interface height, then set the scuflg to F.</li>
<li>Calculate the hypothetical \(\theta_v\) at the minimum radiative heating level that a parcel would reach due to radiative cooling after a typical cloud turnover time spent at that level.</li>
<li>Determine the distance that a parcel would sink downwards starting from the level of minimum radiative heating rate by comparing the hypothetical minimum \(\theta_v\) calculated above with the environmental \(\theta_v\).</li>
<li>Calculate the cloud thickness, where the cloud top is the in-cloud minimum radiative heating level and the bottom is determined previously.</li>
<li>Find the largest between the cloud thickness and the distance of a sinking parcel, then determine the smallest of that number and the height of the minimum in radiative heating rate. Set this number to \(zd\). Using \(zd\), calculate the characteristic velocity scale of cloud-top radiative cooling-driven turbulence.</li>
</ul>
<h2>Calculate the inverse Prandtl number</h2>
<p>For an unstable PBL, the Prandtl number is calculated according to Hong and Pan (1996) <a class="el" href="citelist.html#CITEREF_hong_and_pan_1996">[29]</a>, equation 10, whereas for a stable boundary layer, the Prandtl number is simply \(Pr = \frac{\phi_h}{\phi_m}\).</p>
<h2>Compute diffusion coefficients below the PBL top</h2>
<p>Below the PBL top, the diffusion coefficients ( \(K_m\) and \(K_h\)) are calculated according to equation 2 in Hong and Pan (1996) <a class="el" href="citelist.html#CITEREF_hong_and_pan_1996">[29]</a> where a different value for \(w_s\) (PBL vertical velocity scale) is used depending on the PBL stability. \(K_h\) is calculated from \(K_m\) using the Prandtl number. The calculated diffusion coefficients are checked so that they are bounded by maximum values and the local background diffusion coefficients.</p>
<h2>Compute diffusion coefficients above the PBL top</h2>
<p>Diffusion coefficients above the PBL top are computed as a function of local stability (gradient Richardson number), shear, and a length scale from Louis (1979) <a class="el" href="citelist.html#CITEREF_louis_1979">[43]</a> : </p><p class="formulaDsp">
\[ K_{m,h}=l^2f_{m,h}(Ri_g)\left|\frac{\partial U}{\partial z}\right| \]
</p>
<p> The functions used ( \(f_{m,h}\)) depend on the local stability. First, the gradient Richardson number is calculated as </p><p class="formulaDsp">
\[ Ri_g=\frac{\frac{g}{T}\frac{\partial \theta_v}{\partial z}}{\frac{\partial U}{\partial z}^2} \]
</p>
<p> where \(U\) is the horizontal wind. For the unstable case ( \(Ri_g &lt; 0\)), the Richardson number-dependent functions are given by </p><p class="formulaDsp">
\[ f_h(Ri_g) = 1 + \frac{8\left|Ri_g\right|}{1 + 1.286\sqrt{\left|Ri_g\right|}}\\ \]
</p>
 <p class="formulaDsp">
\[ f_m(Ri_g) = 1 + \frac{8\left|Ri_g\right|}{1 + 1.746\sqrt{\left|Ri_g\right|}}\\ \]
</p>
<p> For the stable case, the following formulas are used </p><p class="formulaDsp">
\[ f_h(Ri_g) = \frac{1}{\left(1 + 5Ri_g\right)^2}\\ \]
</p>
 <p class="formulaDsp">
\[ Pr = \frac{K_h}{K_m} = 1 + 2.1Ri_g \]
</p>
<p> The source for the formulas used for the Richardson number-dependent functions is unclear. They are different than those used in Hong and Pan (1996) <a class="el" href="citelist.html#CITEREF_hong_and_pan_1996">[29]</a> as the previous documentation suggests. They follow equation 14 of Louis (1979) <a class="el" href="citelist.html#CITEREF_louis_1979">[43]</a> for the unstable case, but it is unclear where the values of the coefficients \(b\) and \(c\) from that equation used in this scheme originate. Finally, the length scale, \(l\) is calculated according to the following formula from Hong and Pan (1996) <a class="el" href="citelist.html#CITEREF_hong_and_pan_1996">[29]</a> </p><p class="formulaDsp">
\[ \frac{1}{l} = \frac{1}{kz} + \frac{1}{l_0}\\ \]
</p>
 <p class="formulaDsp">
\[ or\\ \]
</p>
 <p class="formulaDsp">
\[ l=\frac{l_0kz}{l_0+kz} \]
</p>
<p> where \(l_0\) is currently 30 m for stable conditions and 150 m for unstable. Finally, the diffusion coefficients are kept in a range bounded by the background diffusion and the maximum allowable values.</p>
<h2>If the PBL is convective, call the mass flux scheme to replace the countergradient terms.</h2>
<p>If the PBL is convective, the updraft properties are initialized to be the same as the state variables and the subroutine mfpbl is called.</p>
<p>For details of the mfpbl subroutine, step into its documentation <a class="el" href="mfpbl_8f.html#a5787e718b62c0502c0734303a16cd8ed" title="This subroutine is used for calculating the mass flux and updraft properties. ">mfpbl</a></p>
<h2>Compute enhanced diffusion coefficients related to stratocumulus-topped PBLs</h2>
<p>If a stratocumulus layer has been identified in the PBL, the diffusion coefficients in the PBL are modified in the following way.</p>
<ol type="1">
<li>First, the criteria for CTEI is checked, using the threshold from equation 13 of Macvean and Mason (1990) <a class="el" href="citelist.html#CITEREF_macvean_and_mason_1990">[44]</a>. If the criteria is met, the cloud top diffusion is increased: <p class="formulaDsp">
\[ K_h^{Sc} = -c\frac{\Delta F_R}{\rho c_p}\frac{1}{\frac{\partial \theta_v}{\partial z}} \]
</p>
 where the constant \(c\) is set to 0.2 if the CTEI criterion is not met and 1.0 if it is.</li>
<li>Calculate the diffusion coefficients due to stratocumulus mixing according to equation 5 in Lock et al. (2000) <a class="el" href="citelist.html#CITEREF_lock_et_al_2000">[41]</a> for every level below the stratocumulus top using the characteristic stratocumulus velocity scale previously calculated. The diffusion coefficient for momentum is calculated assuming a constant inverse Prandtl number of 0.75.</li>
</ol>
<p>After \(K_h^{Sc}\) has been determined from the surface to the top of the stratocumulus layer, it is added to the value for the diffusion coefficient calculated previously using surface-based mixing [see equation 6 of Lock et al. (2000) <a class="el" href="citelist.html#CITEREF_lock_et_al_2000">[41]</a> ].</p>
<h2>Solve for the temperature and moisture tendencies due to vertical mixing.</h2>
<p>The tendencies of heat, moisture, and momentum due to vertical diffusion are calculated using a two-part process. First, a solution is obtained using an implicit time-stepping scheme, then the time tendency terms are "backed out". The tridiagonal matrix elements for the implicit solution for temperature and moisture are prepared in this section, with differing algorithms depending on whether the PBL was convective (substituting the mass flux term for counter-gradient term), unstable but not convective (using the computed counter-gradient terms), or stable (no counter-gradient terms).</p>
<p>The tridiagonal system is solved by calling the internal <a class="el" href="moninedmf_8f.html#ab77885fe7ace4ef00558157788778408" title="Routine to solve the tridiagonal system to calculate u- and v-momentum at ; part of two-part process ...">tridin</a> subroutine.</p>
<p>After returning with the solution, the tendencies for temperature and moisture are recovered.</p>
<h2>Calculate heating due to TKE dissipation and add to the tendency for temperature</h2>
<p>Following Han et al. (2015) <a class="el" href="citelist.html#CITEREF_han_et_al_2015">[25]</a> , turbulence dissipation contributes to the tendency of temperature in the following way. First, turbulence dissipation is calculated by equation 17 of Han et al. (2015) <a class="el" href="citelist.html#CITEREF_han_et_al_2015">[25]</a> for the PBL and equation 16 for the surface layer.</p>
<p>Next, the temperature tendency is updated following equation 14.</p>
<h2>Solve for the horizontal momentum tendencies and add them to the output tendency terms</h2>
<p>As with the temperature and moisture tendencies, the horizontal momentum tendencies are calculated by solving tridiagonal matrices after the matrices are prepared in this section.</p>
<p>Finally, the tendencies are recovered from the tridiagonal solutions. </p>

<p class="definition">Definition at line <a class="el" href="moninedmf_8f_source.html#l00097">97</a> of file <a class="el" href="moninedmf_8f_source.html">moninedmf.f</a>.</p>

<p class="reference">References <a class="el" href="mfpbl_8f_source.html#l00041">mfpbl()</a>, <a class="el" href="moninedmf_8f_source.html#l01200">tridi2()</a>, and <a class="el" href="moninedmf_8f_source.html#l01243">tridin()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="group___h_e_d_m_e_ga367b6dabfff601023af323f900db86d2_cgraph.png" border="0" usemap="#group___h_e_d_m_e_ga367b6dabfff601023af323f900db86d2_cgraph" alt=""/></div>
<!-- MAP 0 -->
</div>

</div>
</div>
<a id="ga80bebdc639adaba3ed0ed2ea2f24315e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga80bebdc639adaba3ed0ed2ea2f24315e">&#9670;&nbsp;</a></span>tridi2()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine tridi2 </td>
          <td>(</td>
          <td class="paramtype">integer&#160;</td>
          <td class="paramname"><em>l</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer&#160;</td>
          <td class="paramname"><em>n</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(kind=kind_phys), dimension(l,2:n)&#160;</td>
          <td class="paramname"><em>cl</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(kind=kind_phys), dimension(l,n)&#160;</td>
          <td class="paramname"><em>cm</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(kind=kind_phys), dimension(l,n-1)&#160;</td>
          <td class="paramname"><em>cu</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(kind=kind_phys), dimension(l,n)&#160;</td>
          <td class="paramname"><em>r1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(kind=kind_phys), dimension(l,n)&#160;</td>
          <td class="paramname"><em>r2</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(kind=kind_phys), dimension(l,n-1)&#160;</td>
          <td class="paramname"><em>au</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(kind=kind_phys), dimension(l,n)&#160;</td>
          <td class="paramname"><em>a1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(kind=kind_phys), dimension(l,n)&#160;</td>
          <td class="paramname"><em>a2</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Origin of subroutine unknown. </p>

<p class="definition">Definition at line <a class="el" href="moninedmf_8f_source.html#l01200">1200</a> of file <a class="el" href="moninedmf_8f_source.html">moninedmf.f</a>.</p>

<p class="reference">Referenced by <a class="el" href="moninedmf_8f_source.html#l00097">moninedmf()</a>.</p>

</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">Generated by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.13 </li>
  </ul>
</div>
</body>
</html>

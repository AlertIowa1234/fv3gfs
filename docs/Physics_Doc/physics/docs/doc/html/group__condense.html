<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.13"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>GFS Physics Documentation: Grid-Scale Condensation and Evaporation of Cloud</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { init_search(); });
</script>
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    extensions: ["tex2jax.js"],
    jax: ["input/TeX","output/HTML-CSS"],
});
</script><script type="text/javascript" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="ccpp_dox_extra_style.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="ncep.jpg"/></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">GFS Physics Documentation
   </div>
  </td>
   <td>        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
</td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.13 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('group__condense.html','');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">Grid-Scale Condensation and Evaporation of Cloud<div class="ingroups"><a class="el" href="group___zhao-_carr.html">Zhao-Carr-Sundqvist Microphysics</a></div></div>  </div>
</div><!--header-->
<div class="contents">

<p>This subroutine computes grid-scale condensation and evaporation of cloud condensate.  
<a href="#details">More...</a></p>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<p>There are two sources of condensation, one from large-scale processes and the other from convective processes. Both of them produce either cloud water or cloud ice, depending on the cloud substance at and above the grid point at current and previous time steps, and on the temperature. Evaporation of cloud is allowed at points where the relative humidity is lower than the critical value required for condensation. </p>
<table class="memberdecls">
<tr class="memitem:gac51672b28449a810caf82a7292078ccf"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__condense.html#gac51672b28449a810caf82a7292078ccf">gscond</a> (im, ix, km, dt, dtf, prsl, ps, q, cwm, t, tp, qp, psp, tp1, qp1, psp1, u, lprnt, ipr)</td></tr>
<tr class="separator:gac51672b28449a810caf82a7292078ccf"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<h2 class="groupheader">Function/Subroutine Documentation</h2>
<a id="gac51672b28449a810caf82a7292078ccf"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gac51672b28449a810caf82a7292078ccf">&#9670;&nbsp;</a></span>gscond()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine gscond </td>
          <td>(</td>
          <td class="paramtype">integer&#160;</td>
          <td class="paramname"><em>im</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer&#160;</td>
          <td class="paramname"><em>ix</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer&#160;</td>
          <td class="paramname"><em>km</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real (kind=kind_phys)&#160;</td>
          <td class="paramname"><em>dt</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real (kind=kind_phys)&#160;</td>
          <td class="paramname"><em>dtf</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real (kind=kind_phys), dimension(ix,km)&#160;</td>
          <td class="paramname"><em>prsl</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real (kind=kind_phys), dimension(im)&#160;</td>
          <td class="paramname"><em>ps</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real (kind=kind_phys), dimension(ix,km)&#160;</td>
          <td class="paramname"><em>q</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real (kind=kind_phys), dimension(ix,km)&#160;</td>
          <td class="paramname"><em>cwm</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real (kind=kind_phys), dimension(ix,km)&#160;</td>
          <td class="paramname"><em>t</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real (kind=kind_phys), dimension(ix,km)&#160;</td>
          <td class="paramname"><em>tp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real (kind=kind_phys), dimension(ix,km)&#160;</td>
          <td class="paramname"><em>qp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real (kind=kind_phys), dimension(im)&#160;</td>
          <td class="paramname"><em>psp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real (kind=kind_phys), dimension(ix,km)&#160;</td>
          <td class="paramname"><em>tp1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real (kind=kind_phys), dimension(ix,km)&#160;</td>
          <td class="paramname"><em>qp1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real (kind=kind_phys), dimension(im)&#160;</td>
          <td class="paramname"><em>psp1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real (kind=kind_phys), dimension(im,km)&#160;</td>
          <td class="paramname"><em>u</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">logical&#160;</td>
          <td class="paramname"><em>lprnt</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer&#160;</td>
          <td class="paramname"><em>ipr</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">ix</td><td>horizontal dimension </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">im</td><td>horizontal number of used pts </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">km</td><td>vertical layer dimension </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">dt</td><td>physics time step in seconds </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">dtf</td><td>dynamics time step in seconds </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">prsl</td><td>pressure values for model layers </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">ps</td><td>surface pressure (Pa) </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">q</td><td>model layer specific humidity (gm/gm) </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">cwm</td><td>model layer cloud condensate </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">t</td><td>model layer mean temperature (K) </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">tp</td><td>model layer mean temperature (K) saved for restart </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">qp</td><td>model layer specific humidity (gm/gm) saved for restart </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">psp</td><td>surface pressure (Pa) saved for restart </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">tp1</td><td>updated model layer mean temperature (K) saved for restart </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">qp1</td><td>updated model layer specific humidity (gm/gm) saved for restart </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">psp1</td><td>updated surface pressure (Pa) saved for restart </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">u</td><td>the critical value of relative humidity for large-scale condensation </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">lprnt</td><td>logical print flag </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">ipr</td><td>check print point for debugging</td></tr>
  </table>
  </dd>
</dl>
<h1><a class="anchor" id="def"></a>
Definition of symbols</h1>
<ul>
<li>\(C_{g}\): grid-scale condensation rate ( \(s^{-1}\))</li>
<li>\(E_{c}\): evaporation rate of cloud ( \(s^{-1}\)) </li>
</ul>
<h1><a class="anchor" id="gen_algorithm"></a>
General Algorithm</h1>
<ol type="1">
<li>Begining of grid-scale condensation/evaporation loop (start of k-loop, i-loop)</li>
<li>Compute ice-water identification number IW. <br />
 The distinction between cloud water and cloud ice is made by the cloud identification number IW, which is zero for cloud water and unity for cloud ice (Table 2 in zhao and Carr (1997) <a class="el" href="citelist.html#CITEREF_zhao_and_carr_1997">[66]</a>):<ul>
<li>All clouds are defined to consist of liquid water below the freezing level ( \(T\geq 0^oC\)) and of ice particles above the \(T=-15^oC\) level.</li>
<li>In the temperature region between \(-15^oC\) and \(0^oC\), clouds may be composed of liquid water or ice. If there are cloud ice particles above this point at the previous or current time step, or if the cloud at this point at the previous time step consists of ice particles, then the cloud substance at this point is considered to be ice particles because of the cloud seeding effect and the memory of its content. Otherwise, all clouds in this region are considered to contain supercooled cloud water.</li>
</ul>
</li>
<li>Condensation and evaporation of cloud<ul>
<li>Compute the changes in t, q and p ( \(A_{t}\), \(A_{q}\) and \(A_{p}\)) caused by all the processes except grid-scale condensation and evaporation. <p class="formulaDsp">
\[ A_{t}=(t-tp)/dt \]
</p>
 <p class="formulaDsp">
\[ A_{q}=(q-qp)/dt \]
</p>
 <p class="formulaDsp">
\[ A_{p}=(prsl-\frac{prsl}{ps} \times psp)/dt \]
</p>
</li>
<li>Calculate the saturation specific humidity \(q_{s}\) and the relative humidity \(f\) using IW.</li>
<li>According to Sundqvist et al. (1989) <a class="el" href="citelist.html#CITEREF_sundqvist_et_al_1989">[59]</a>, estimate cloud fraction \(b\) at a grid point from relative humidity \(f\) using the equation <p class="formulaDsp">
\[ b=1-\left ( \frac{f_{s}-f}{f_{s}-u} \right )^{1/2} \]
</p>
 for \(f&gt;u\); and \(b=0\) for \(f&lt;u\). where \(f_{s}=1.0\) is the relative humidity in a cloud region and \(u\) ,which is an input parameter accounts for the effects of subgrid-scale variations in moisture on large-scale condensation. Since both temperature and moisture may vary at scales smaller than the model grid scale, it is possible for condensation to occur before the grid-average relative humidity reaches 100%. Therefore \(u\) needs to be less than 1.0 to account for the subgrid-scale variation of temperature and moisture fields and allow subgrid-scale condensation.</li>
<li>If cloud fraction \(b\leq 1.0\times10^{-3}\), then evaporate any existing cloud condensate using evaporation rate \(E_{c}\) as computed below. <br />
 If \(q_{0}\) represents the specific humidity at relative humidity \(u\), then <p class="formulaDsp">
\[ q_{0}=uq_{s} \]
</p>
 <br />
 if the cloud water/ice at this point is enough to be evaporated until \(u\) is reached, then the evaporation rate \(E_{c}\), assuming that the evaporation process occurs in one time step, is determined by <p class="formulaDsp">
\[ E_{c}=\frac{q_{0}-q}{dt} \]
</p>
 <br />
 Using \(q_{0}=uq_{s}\) and the equation \(q=fq_{s}\), \(E_{c}\) then becomes <p class="formulaDsp">
\[ E_{c}=\frac{q_{s}}{dt}(u-f) \]
</p>
 where \(dt\) is the time step for precipitation calculation in the model. It is a simplified version of a higher-order cloud evaporation algorithm (Rutledge and Hobbs 1983 <a class="el" href="citelist.html#CITEREF_rutledge_and_hobbs_1983">[54]</a>). In the case where all clouds will evaporate before \(u\) is reached, the following equation is used: <p class="formulaDsp">
\[ E_{c}=\frac{cwm}{dt} \]
</p>
</li>
<li>If cloud fraction \(b&gt;1.0\times10^{-3}\), condense water vapor in to cloud condensate ( \(C_{g}\)). <br />
 Using \(q=fq_{s}\), \(q_{s}=\epsilon e_{s}/p\), and the Clausius-Clapeyron equation \(de_{s}/dT=\epsilon Le_{s}/RT^{2}\), where \(q_{s}\) is the saturation specific humidity, \(e_{s}\) is the saturation vapor pressure, \(R\) is the specific gas constant for dry air, \(f\) is the relative humidity, and \(\epsilon=0.622\), the expression for \(C_{g}\) has the form <p class="formulaDsp">
\[ C_{g}=\frac{M-q_{s}f_{t}}{1+(f\epsilon L^{2}q_{s}/RC_{p}T^{2})}+E_{c} \]
</p>
 where <p class="formulaDsp">
\[ M=A_{q}-\frac{f\epsilon Lq_{s}}{RT^{2}}A_{t}+\frac{fq_{s}}{p}A_{p} \]
</p>
 To close the system, an equation for the relative humidity tendency \(f_{t}\) was derived by Sundqvist et al. (1989) <a class="el" href="citelist.html#CITEREF_sundqvist_et_al_1989">[59]</a> using the hypothesis that the quantity \(M+E_{c}\) is divided into one part, \(bM\),which condenses in the already cloudy portion of a grid square, and another part, \((1-b)M+E_{c}\),which is used to increase the relative humidity of the cloud-free portion and the cloudiness in the square. The equation is written as <p class="formulaDsp">
\[ f_{t}=\frac{2(1-b)(f_{s}-u)[(1-b)M+E_{c}]}{2q_{s}(1-b)(f_{s}-u)+cwm/b} \]
</p>
</li>
<li>Check and correct if over condensation occurs.</li>
<li>Update t, q and cwm (according to Eqs(6) and (7) in Zhao and Carr (1997) <a class="el" href="citelist.html#CITEREF_zhao_and_carr_1997">[66]</a>) <p class="formulaDsp">
\[ cwm=cwm+(C_{g}-E_{c})\times dt \]
</p>
 <p class="formulaDsp">
\[ q=q-(C_{g}-E_{c})\times dt \]
</p>
 <p class="formulaDsp">
\[ t=t+\frac{L}{C_{p}}(C_{g}-E_{c})\times dt \]
</p>
 <br />
 where \(L\) is the latent heat of condensation/deposition, and \(C_{p}\) is the specific heat of air at constant pressure.</li>
</ul>
</li>
<li>End of the condensation/evaporation loop (end of i-loop,k-loop)</li>
<li>Store \(t\), \(q\), \(ps\) for next time step. </li>
</ol>

<p class="definition">Definition at line <a class="el" href="gscond_8f_source.html#l00086">86</a> of file <a class="el" href="gscond_8f_source.html">gscond.f</a>.</p>

</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">Generated by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.13 </li>
  </ul>
</div>
</body>
</html>

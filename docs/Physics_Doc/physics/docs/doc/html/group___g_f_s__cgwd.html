<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.13"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>GFS Physics Documentation: GFS Convective Gravity Wave Drag</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { init_search(); });
</script>
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    extensions: ["tex2jax.js"],
    jax: ["input/TeX","output/HTML-CSS"],
});
</script><script type="text/javascript" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="ccpp_dox_extra_style.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="ncep.jpg"/></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">GFS Physics Documentation
   </div>
  </td>
   <td>        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
</td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.13 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('group___g_f_s__cgwd.html','');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">GFS Convective Gravity Wave Drag<div class="ingroups"><a class="el" href="group___g_f_s__gwd.html">GFS Orographic Gravity Wave Drag</a></div></div>  </div>
</div><!--header-->
<div class="contents">

<p>This subroutine is the parameterization of convective gravity wave drag based on the theory given by Chun and Baik (1998) <a class="el" href="citelist.html#CITEREF_chun_and_baik_1998">[12]</a> modified for implementation into the GFS/CFS by Ake Johansson(Aug 2005).  
<a href="#details">More...</a></p>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<ul>
<li>The parameterization of stationary convectively-forced GWD follows the development of Chun and Baik (1998) <a class="el" href="citelist.html#CITEREF_chun_and_baik_1998">[12]</a> , which was tested in GCMs by Chun et al. (2001,2004) <a class="el" href="citelist.html#CITEREF_chun_et_al_2001">[13]</a> <a class="el" href="citelist.html#CITEREF_chun_et_al_2004">[14]</a> was implemented in GFS by Ake Johansson (2008) and the work of the GCWMB staff. Modest positive effects from using the parameterization are seen in the tropical upper troposphere and lower stratosphere.</li>
</ul>
<p>Parameterizing subgrid-scale convection-induced gravity wave momentum flux for use in large-scale models inherently requires some information from subgrid-scale cumulus parameterization. The methodology for parameterizing the zonal momentum flux induced by thermal forcing can be summarized as follows. From the cloud-base to cloud-top height, the effect of the momentum flux induced by subgrid-scale diabatic forcing is not considered because subgrid-scale cumulus convection in large-scale models is only activated in a conditionally unstable atmosphere. Below the cloud base, the momentum flux is also not considered because of the wave momentum cancellation. At the cloud top, the momentum flux is obtained by eq.(18) and (19) in Chun and Baik (1998) <a class="el" href="citelist.html#CITEREF_chun_and_baik_1998">[12]</a>. Above the cloud top, there are two ways to construct the momentum flux profile. One way is to specify a vertical structure of the momentum flux normalized by the cloud-top value, similar to what has been done for mountain drag parameterization. The other way is to apply the wave saturation hypothesis in order to find wave breaking levels in terms of the Richardon number criterion using the nonlinearity factor of thermally induced waves. </p>
<table class="memberdecls">
<tr class="memitem:ga722b7730110e3c91524ccf414eab9dfe"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group___g_f_s__cgwd.html#ga722b7730110e3c91524ccf414eab9dfe">gwdc</a> (im, ix, iy, km, lat, u1, v1, t1, q1, deltim,</td></tr>
<tr class="separator:ga722b7730110e3c91524ccf414eab9dfe"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<h2 class="groupheader">Function/Subroutine Documentation</h2>
<a id="ga722b7730110e3c91524ccf414eab9dfe"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga722b7730110e3c91524ccf414eab9dfe">&#9670;&nbsp;</a></span>gwdc()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine gwdc </td>
          <td>(</td>
          <td class="paramtype">integer&#160;</td>
          <td class="paramname"><em>im</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer&#160;</td>
          <td class="paramname"><em>ix</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer&#160;</td>
          <td class="paramname"><em>iy</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer&#160;</td>
          <td class="paramname"><em>km</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer&#160;</td>
          <td class="paramname"><em>lat</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(kind=kind_phys), dimension(ix,km)&#160;</td>
          <td class="paramname"><em>u1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(kind=kind_phys), dimension(ix,km)&#160;</td>
          <td class="paramname"><em>v1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(kind=kind_phys), dimension(ix,km)&#160;</td>
          <td class="paramname"><em>t1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(kind=kind_phys), dimension(ix,km)&#160;</td>
          <td class="paramname"><em>q1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(kind=kind_phys)&#160;</td>
          <td class="paramname"><em>deltim</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">IM</td><td>horizontal number of used pts </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">IX</td><td>horizontal dimension </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">IY</td><td>horizontal number of used pts </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">KM</td><td>vertical layer dimension </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">LAT</td><td>latitude index - used for debug prints </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">U1</td><td>u component of layer wind </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">V1</td><td>v component of layer wind </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">T1</td><td>layer mean temperature (K) </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">Q1</td><td>layer mean tracer concentration </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">PMID1</td><td>mean layer pressure </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">PINT1</td><td>pressure at layer interfaces </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">DPMID1</td><td>mean layer delta p </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">QMAX</td><td>maximum convective heating rate (k/s) in a horizontal grid point calculated from cumulus parameterization </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">KTOP</td><td>vertical level index for cloud top </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">KBOT</td><td>vertical level index for cloud bottom </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">KCNV</td><td>(0,1) dependent on whether convection occur or not </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">CLDF</td><td>deep convective cloud fraction at the cloud top </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">GRAV</td><td>gravity defined in physcon </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">CP</td><td>specific heat at constant pressure defined in physcon </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">RD</td><td>gas constant air defined in physcon </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">FV</td><td>con_fvirt = con_rv/con_rd-1 </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">DLENGTH</td><td>grid spacing in the direction of basic wind at the cloud top </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">LPRNT</td><td>logical print flag </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">IPR</td><td>check print point for debugging </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">FHOUR</td><td>forecast hour </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">UTGWC</td><td>zonal wind tendency </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">VTGWC</td><td>meridional wind tendency </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">TAUCTX</td><td>wave stress at the cloud top projected in the east </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">TAUCTY</td><td>wave stress at the cloud top projected in the north</td></tr>
  </table>
  </dd>
</dl>
<h1><a class="anchor" id="arg_table_gwdc_run"></a>
Arguments</h1>
<table class="doxtable">
<tr>
<th>local var name </th><th>longname </th><th>description </th><th>units </th><th>rank </th><th>type </th><th>kind </th><th>intent </th><th>optional  </th></tr>
<tr>
<td>im </td><td>horizontal_loop_extent </td><td>horizontal loop extent, start at 1 </td><td>index </td><td>0 </td><td>integer </td><td></td><td>in </td><td>F </td></tr>
</table>
<h1><a class="anchor" id="al_gwdc"></a>
General Algorithm</h1>
<ol type="1">
<li>Create local arrays with reversed vertical indices and Initialize local variables<ul>
<li>The top interface temperature, density, and Brunt-Vaisala frequencies ( \(N\)) are calculated assuming an isothermal atmosphere above the top mid level.</li>
<li>The bottom interface temperature, density, and Brunt-Vaisala frequencies ( \(N\)) are calculated assuming an isothermal atmosphere below the bottom mid level.</li>
<li>The interface level temperature, density, and Brunt-Vaisala frequencies ( \(N\)) are calculated based on linear interpolation of temperature in ln(P).</li>
<li>The mid-level Brunt-Vaisala frequencies ( \(N\)) are calculated based on interpolated interface temperatures.</li>
</ul>
</li>
<li>Calculate the cloud top wind components and speed. Here, ucltop, vcltop, and windcltop are wind components and wind speed at mid-level cloud top index</li>
<li>Calculate the basic state wind projected in the direction of the cloud top wind at mid level and interface level (U, UI), where: <br />
 U : Basic-wind speed profile. Basic-wind is parallel to the wind vector at the cloud top level. (mid level) <br />
 UI: Basic-wind speed profile. Basic-wind is parallel to the wind vector at the cloud top level. ( interface level )</li>
<li>Calculate the local Richardson number <p class="formulaDsp">
\[ Ri=N^2/\eta^2 \]
</p>
 where \(\eta\) is the vertical shear ( \(dU/dz\)).</li>
<li>Calculate the gravity wave stress at the interface level cloud top.<ul>
<li>Wave stress at cloud top is calculated when the atmosphere is dynamically stable at the cloud top</li>
<li>The cloud top wave stress and nonlinear parameter are calculated using density, temperature, and wind that are defined at mid level just below the interface level in which cloud top wave stress is defined. The parameter \(\mu\) is the nonlinearity factor of thermally induced internal gravity waves defined by eq.(17) in Chun and Baik, 1998 <a class="el" href="citelist.html#CITEREF_chun_and_baik_1998">[12]</a> <p class="formulaDsp">
\[ \mu=\frac{gQ_{0}a_{1}}{c_{p}T_{0}NU^{2}} \]
</p>
 where \(Q_{0}\) is the maximum deep convective heating rate in a horizontal grid point calculated from cumulus parameterization. \(a_{1}\) is the half-width of the forcing function. \(g\) is gravity. \(c_{p}\) is specific heat at constant pressure. \(T_{0}\) is the layer mean temperature (T1). As eqs.(18) and (19) <a class="el" href="citelist.html#CITEREF_chun_and_baik_1998">[12]</a>, the zonal momentum flux is given by <p class="formulaDsp">
\[ \tau_{x}=-[\rho U^{3}/(N\triangle x)]G(\mu) \]
</p>
 where <p class="formulaDsp">
\[ G(\mu)=c_{1}c_2^2 \mu^{2} \]
</p>
 wher \(\rho\) is the local density. The tunable parameter \(c_1\) is related to the horizontal structure of thermal forcing. The tunable parameter \(c_2\) is related to the basic-state wind and stability and the bottom and top heights of thermal forcing. If the atmosphere is dynamically unstable at the cloud top, the convective GWD calculation is skipped at that grid point.</li>
<li>The stress is capped at tauctmax = - 5 \(n/m^2\) in order to prevent numerical instability.</li>
</ul>
</li>
<li>Calculate the minimum Richardson number including both the basic-state condition and wave effects. <p class="formulaDsp">
\[ Ri_{min}\approx\frac{Ri(1-\mu|c_{2}|)}{(1+\mu Ri^{1/2}|c_{2}|)^{2}} \]
</p>
</li>
<li>Calculate the gravity wave stress profile using the wave saturation hypothesis of Lindzen (1981) <a class="el" href="citelist.html#CITEREF_lindzen_1981">[40]</a>.<ul>
<li>When \(Ri_{min}\) is set to 1/4 based on Lindzen's (1981) <a class="el" href="citelist.html#CITEREF_lindzen_1981">[40]</a> saturation hypothesis, the nonlinearity factor for wave saturation can be derived by <p class="formulaDsp">
\[ \mu_{s}=\frac{1}{|c_{2}|}[2\sqrt{2+\frac{1}{\sqrt{Ri}}}-(2+\frac{1}{\sqrt{Ri}})] \]
</p>
 Then the saturation zonal momentum flux is given by <p class="formulaDsp">
\[ \tau_{s}=-[\rho U^{3}/(N\triangle x)]c_{1}c_2^2\mu_s^2 \]
</p>
</li>
<li>If the minimum \(R_{i}\) at interface cloud top is less than or equal to 1/4, the convective GWD calculation is skipped at that grid point.</li>
<li>As an upper boundary condition, upward propagation of gravity wave energy is permitted.</li>
</ul>
</li>
<li>Calculate wind tendency in direction to the wind vector,zonal wind tendency and meridional wind tendency above the cloud top level due to convectively generated gravity waves.</li>
<li>Convert back local convective GWD tendency arrays to GFS model vertical indices. </li>
</ol>

<p class="definition">Definition at line <a class="el" href="gwdc_8f_source.html#l00086">86</a> of file <a class="el" href="gwdc_8f_source.html">gwdc.f</a>.</p>

</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">Generated by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.13 </li>
  </ul>
</div>
</body>
</html>

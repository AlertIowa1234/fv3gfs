<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.13"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>GFS Physics Documentation: module_radiation_clouds</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { init_search(); });
</script>
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    extensions: ["tex2jax.js"],
    jax: ["input/TeX","output/HTML-CSS"],
});
</script><script type="text/javascript" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="ccpp_dox_extra_style.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="ncep.jpg"/></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">GFS Physics Documentation
   </div>
  </td>
   <td>        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
</td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.13 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('group__module__radiation__clouds.html','');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#var-members">Variables</a>  </div>
  <div class="headertitle">
<div class="title">module_radiation_clouds</div>  </div>
</div><!--header-->
<div class="contents">

<p>This module computes cloud related quantities for radiation computations.  
<a href="#details">More...</a></p>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<p>Knowledge of cloud properties and their vertical structure is important for meteorological studies due to their impact on both the Earth's radiation budget and adiabatic heating within the atmosphere. Cloud properties in the US National Oceanic and Atmospheric Administration National Centers for Environmental Prediction Global Forecast System (GFS) include (i) cloud liquid/ice water path; (ii) the fraction of clouds; (iii) effective radius of water/ice droplet: </p><dl class="section version"><dt>Version</dt><dd>NCEP-Radiation_clouds v5.1 Nov 2012</dd></dl>
<p>This module has three externally accessible subroutines:</p><ul>
<li><a class="el" href="group__module__radiation__clouds.html#ga0e1ee94c9ca85849a219803325a61184" title="This subroutine is an initialization program for cloud-radiation calculations and sets up boundary la...">cld_init()</a> &mdash; initialization routine</li>
<li><a class="el" href="group__module__radiation__clouds.html#gafa23f5bc69fa713abfa32939fd96ade8" title="This subroutine computes cloud related quantities using zhao/moorthi&#39;s prognostic cloud microphysics ...">progcld1()</a> &mdash; zhao/moorthi prognostic cloud scheme</li>
<li><a class="el" href="group__module__radiation__clouds.html#ga3fd7643ce526761b17d04eec6a332333" title="This subroutine computes cloud related quantities using ferrier&#39;s prognostic cloud microphysics schem...">progcld2()</a> &mdash; ferrier prognostic cloud microphysics</li>
<li><a class="el" href="group__module__radiation__clouds.html#gaeab51a06b22516fbfc78ab2c9eaf2622" title="This subroutine computes cloud related quantities using zhao/moorthi&#39;s prognostic cloud microphysics ...">progcld3()</a> &mdash; zhao/moorthi prognostic cloud + pdfcld</li>
<li><a class="el" href="group__module__radiation__clouds.html#ga022c3706242426745001b7837ae801a3" title="This subroutine computes cloud fractions for radiation calculations. ">diagcld1()</a> &mdash; diagnostic cloud calculation routine</li>
</ul>
<p>and two internally accessable only subroutines:</p><ul>
<li><a class="el" href="group__module__radiation__clouds.html#gac231d967afcfb252dedba82e9085b34d" title="This subroutine computes high, mid, low, total, and boundary cloud fractions and cloud top/bottom lay...">gethml()</a> &mdash; get diagnostic hi, mid, low,total,BL clouds</li>
<li><a class="el" href="group__module__radiation__clouds.html#ga9b3f43844a53e79cd5c348f8c72ec408" title="cld-rh relations obtained from mitchell-hahn procedure. ">rhtable()</a> &mdash; rh lookup table for diag cloud scheme</li>
</ul>
<h1><a class="anchor" id="gen_al"></a>
General Algorithm</h1>
<ol type="1">
<li>Cloud Liquid/Ice Water Path (LWP,IWP) <br />
 We define the fraction of liquid and ice cloud as: <br />
 Fraction of ice cloud (F): \(F=(273.16K-T)/20\) <br />
 LWP = total cloud condensate path X (1-F) <br />
 IWP = total clod condensate path X F</li>
<li>GFS Cloud Fraction <br />
 The cloud fraction in a given grid box of the GFS model is computed using the parameterization scheme of Xu and Randall(1996) <a class="el" href="citelist.html#CITEREF_xu_and_randall_1996">[62]</a> : <p class="formulaDsp">
\[ \sigma =RH^{k_{1}}\left[1-exp\left(-\frac{k_{2}q_{l}}{\left[\left(1-RH\right)q_{s}\right]^{k_{3}}}\right)\right] \]
</p>
 Where \(RH\) is relative humidity, \(q_{l}\) is the cloud condensate, \(q_{s}\) is saturation specific humidity, \(k_{1}(=0.25)\), \(k_{2}(=100)\), \(k_{3}(=0.49)\) are the empirical parameters. The cloud condensate is partitioned into cloud water and ice in radiation based on temperature. Cloud drop effective radius ranges 5-10 microns over land depending on temperature. Ice crystal radius is function of ice water content (Heymsfield and McFarquhar (1996) <a class="el" href="citelist.html#CITEREF_heymsfield_and_mcfarquhar_1996">[28]</a>). Maximum-randomly cloud overlapping is used in both long-wave radiation and short-wave radiation. Convective clouds are not considered in radiation. <br />
</li>
<li>The parameterization of effective radius of water/ice droplet ( \(r_{e}\)) <br />
 Two methods has been used to parameterize cloud properties in the GFS model. The first method makes use of a diagnostic cloud scheme, in which cloud properties are determined based on model-predicted temperature, pressure, and boundary layer circulation from Harshvardhan et al. (1989) <a class="el" href="citelist.html#CITEREF_harshvardhan_et_al_1989">[26]</a> . The diagnostic scheme is now replaced with a prognostic scheme that uses cloud condensate information instead (NCEP Office Note 441). <br />
 For the parameterization of effective radius, \(r_{ew}\), of water droplet, we fix \(r_{ew}\) to a value of \(10\mu m\) over the oceans. Over the land, \(\) is defined as: <p class="formulaDsp">
\[ r_{ew} = 5+5\times F \]
</p>
 Thus, the effective radius of cloud water droplets will reach to a minimum values of \(5\mu m\) when F=0, and to a maximum value of \(10\mu m\) when the ice fraction is increasing. <br />
 For ice clouds, following Heymsfield and McFarquhar (1996) <a class="el" href="citelist.html#CITEREF_heymsfield_and_mcfarquhar_1996">[28]</a>, we have made the effective ice droplet radius to be an empirical function of ice water concentration (IWC) and environmental temperature as: <p class="formulaDsp">
\[ r_{ei}=\begin{cases}(1250/9.917)IWC^{0.109} &amp; T &lt;-50^0C \\(1250/9.337)IWC^{0.080} &amp; -50^0C \leq T&lt;-40^0C\\(1250/9.208)IWC^{0.055} &amp; -40^0C\leq T &lt;-30^0C\\(1250/9.387)IWC^{0.031} &amp; -30^0C \leq T\end{cases} \]
</p>
 where IWC and IWP satisfy: <p class="formulaDsp">
\[ IWP_{\triangle Z}=\int_{\triangle Z} IWCdZ \]
</p>
 </li>
</ol>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="var-members"></a>
Variables</h2></td></tr>
<tr class="memitem:gab4060544be25be2b0a87042fb3bd6242"><td class="memItemLeft" align="right" valign="top"><a id="gab4060544be25be2b0a87042fb3bd6242"></a>
real(kind=kind_phys), parameter&#160;</td><td class="memItemRight" valign="bottom"><b>module_radiation_clouds::gfac</b> =1.0e5/con_g</td></tr>
<tr class="separator:gab4060544be25be2b0a87042fb3bd6242"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga50ea21222eb91e6363e8bf1338b34a66"><td class="memItemLeft" align="right" valign="top"><a id="ga50ea21222eb91e6363e8bf1338b34a66"></a>
real(kind=kind_phys), parameter&#160;</td><td class="memItemRight" valign="bottom"><b>module_radiation_clouds::gord</b> =con_g/con_rd</td></tr>
<tr class="separator:ga50ea21222eb91e6363e8bf1338b34a66"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga66cf0f94619a3d865b0c593197a30576"><td class="memItemLeft" align="right" valign="top"><a id="ga66cf0f94619a3d865b0c593197a30576"></a>
integer, parameter, public&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__module__radiation__clouds.html#ga66cf0f94619a3d865b0c593197a30576">module_radiation_clouds::nf_clds</a> = 11</td></tr>
<tr class="memdesc:ga66cf0f94619a3d865b0c593197a30576"><td class="mdescLeft">&#160;</td><td class="mdescRight">number of fields in cloud array <br /></td></tr>
<tr class="separator:ga66cf0f94619a3d865b0c593197a30576"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga2739168b8205ee860eb8a160ea722a44"><td class="memItemLeft" align="right" valign="top"><a id="ga2739168b8205ee860eb8a160ea722a44"></a>
integer, parameter, public&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__module__radiation__clouds.html#ga2739168b8205ee860eb8a160ea722a44">module_radiation_clouds::nk_clds</a> = 3</td></tr>
<tr class="memdesc:ga2739168b8205ee860eb8a160ea722a44"><td class="mdescLeft">&#160;</td><td class="mdescRight">number of cloud vertical domains <br /></td></tr>
<tr class="separator:ga2739168b8205ee860eb8a160ea722a44"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga03bc5d19cbdc84a2032c8d591ba4c96a"><td class="memItemLeft" align="right" valign="top"><a id="ga03bc5d19cbdc84a2032c8d591ba4c96a"></a>
real(kind=kind_phys), dimension(nk_clds+1, 2), save&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__module__radiation__clouds.html#ga03bc5d19cbdc84a2032c8d591ba4c96a">module_radiation_clouds::ptopc</a></td></tr>
<tr class="memdesc:ga03bc5d19cbdc84a2032c8d591ba4c96a"><td class="mdescLeft">&#160;</td><td class="mdescRight">pressure limits of cloud domain interfaces (low,mid,high) in mb (0.1kPa) <br /></td></tr>
<tr class="separator:ga03bc5d19cbdc84a2032c8d591ba4c96a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gad4d5840310847f5bf39082114069ceb8"><td class="memItemLeft" align="right" valign="top"><a id="gad4d5840310847f5bf39082114069ceb8"></a>
real(kind=kind_phys), parameter&#160;</td><td class="memItemRight" valign="bottom"><b>module_radiation_clouds::climit</b> = 0.001</td></tr>
<tr class="separator:gad4d5840310847f5bf39082114069ceb8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga2f6f333d39f496f623036802fc05f209"><td class="memItemLeft" align="right" valign="top"><a id="ga2f6f333d39f496f623036802fc05f209"></a>
real(kind=kind_phys), parameter&#160;</td><td class="memItemRight" valign="bottom"><b>module_radiation_clouds::climit2</b> =0.05</td></tr>
<tr class="separator:ga2f6f333d39f496f623036802fc05f209"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga5667082e13ef37593bdfcc152e3dd449"><td class="memItemLeft" align="right" valign="top"><a id="ga5667082e13ef37593bdfcc152e3dd449"></a>
real(kind=kind_phys), parameter&#160;</td><td class="memItemRight" valign="bottom"><b>module_radiation_clouds::ovcst</b> = 1.0 - 1.0e-8</td></tr>
<tr class="separator:ga5667082e13ef37593bdfcc152e3dd449"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga1768a85f4d8af2ad40b62ae6e6667c1e"><td class="memItemLeft" align="right" valign="top"><a id="ga1768a85f4d8af2ad40b62ae6e6667c1e"></a>
real(kind=kind_phys), parameter&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__module__radiation__clouds.html#ga1768a85f4d8af2ad40b62ae6e6667c1e">module_radiation_clouds::reliq_def</a> = 10.0</td></tr>
<tr class="memdesc:ga1768a85f4d8af2ad40b62ae6e6667c1e"><td class="mdescLeft">&#160;</td><td class="mdescRight">default liq radius to 10 micron <br /></td></tr>
<tr class="separator:ga1768a85f4d8af2ad40b62ae6e6667c1e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga721e0fb4a34774f5b61f567b9cad8e7b"><td class="memItemLeft" align="right" valign="top"><a id="ga721e0fb4a34774f5b61f567b9cad8e7b"></a>
real(kind=kind_phys), parameter&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__module__radiation__clouds.html#ga721e0fb4a34774f5b61f567b9cad8e7b">module_radiation_clouds::reice_def</a> = 50.0</td></tr>
<tr class="memdesc:ga721e0fb4a34774f5b61f567b9cad8e7b"><td class="mdescLeft">&#160;</td><td class="mdescRight">default ice radius to 50 micron <br /></td></tr>
<tr class="separator:ga721e0fb4a34774f5b61f567b9cad8e7b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga93fcaedae02c0f9c4de9f39061379d6b"><td class="memItemLeft" align="right" valign="top"><a id="ga93fcaedae02c0f9c4de9f39061379d6b"></a>
real(kind=kind_phys), parameter&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__module__radiation__clouds.html#ga93fcaedae02c0f9c4de9f39061379d6b">module_radiation_clouds::rrain_def</a> = 1000.0</td></tr>
<tr class="memdesc:ga93fcaedae02c0f9c4de9f39061379d6b"><td class="mdescLeft">&#160;</td><td class="mdescRight">default rain radius to 1000 micron <br /></td></tr>
<tr class="separator:ga93fcaedae02c0f9c4de9f39061379d6b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga2b68c4a206e17cb59597f6c4dffc7c1a"><td class="memItemLeft" align="right" valign="top"><a id="ga2b68c4a206e17cb59597f6c4dffc7c1a"></a>
real(kind=kind_phys), parameter&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__module__radiation__clouds.html#ga2b68c4a206e17cb59597f6c4dffc7c1a">module_radiation_clouds::rsnow_def</a> = 250.0</td></tr>
<tr class="memdesc:ga2b68c4a206e17cb59597f6c4dffc7c1a"><td class="mdescLeft">&#160;</td><td class="mdescRight">default snow radius to 250 micron <br /></td></tr>
<tr class="separator:ga2b68c4a206e17cb59597f6c4dffc7c1a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gad2947b3c0a8382fbe12b76dd68b290e0"><td class="memItemLeft" align="right" valign="top"><a id="gad2947b3c0a8382fbe12b76dd68b290e0"></a>
integer, parameter&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__module__radiation__clouds.html#gad2947b3c0a8382fbe12b76dd68b290e0">module_radiation_clouds::nbin</a> =100</td></tr>
<tr class="memdesc:gad2947b3c0a8382fbe12b76dd68b290e0"><td class="mdescLeft">&#160;</td><td class="mdescRight">rh in one percent interval <br /></td></tr>
<tr class="separator:gad2947b3c0a8382fbe12b76dd68b290e0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gab4d14edea12bbcda5361cad523386c7c"><td class="memItemLeft" align="right" valign="top"><a id="gab4d14edea12bbcda5361cad523386c7c"></a>
integer, parameter&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__module__radiation__clouds.html#gab4d14edea12bbcda5361cad523386c7c">module_radiation_clouds::nlon</a> =2</td></tr>
<tr class="memdesc:gab4d14edea12bbcda5361cad523386c7c"><td class="mdescLeft">&#160;</td><td class="mdescRight">=1,2 for eastern and western hemispheres <br /></td></tr>
<tr class="separator:gab4d14edea12bbcda5361cad523386c7c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gad4274cb223949e858ecc2e6346bed610"><td class="memItemLeft" align="right" valign="top"><a id="gad4274cb223949e858ecc2e6346bed610"></a>
integer, parameter&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__module__radiation__clouds.html#gad4274cb223949e858ecc2e6346bed610">module_radiation_clouds::nlat</a> =4</td></tr>
<tr class="memdesc:gad4274cb223949e858ecc2e6346bed610"><td class="mdescLeft">&#160;</td><td class="mdescRight">=1,4 for 60n-30n,30n-equ,equ-30s,30s-60s <br /></td></tr>
<tr class="separator:gad4274cb223949e858ecc2e6346bed610"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gafb94f3d62afa49bef6c33f73a7ecad65"><td class="memItemLeft" align="right" valign="top"><a id="gafb94f3d62afa49bef6c33f73a7ecad65"></a>
integer, parameter&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__module__radiation__clouds.html#gafb94f3d62afa49bef6c33f73a7ecad65">module_radiation_clouds::mcld</a> =4</td></tr>
<tr class="memdesc:gafb94f3d62afa49bef6c33f73a7ecad65"><td class="mdescLeft">&#160;</td><td class="mdescRight">=1,4 for bl,low,mid,hi cld type <br /></td></tr>
<tr class="separator:gafb94f3d62afa49bef6c33f73a7ecad65"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gaaf2a6549a8c42b9eae3d40d21d1e9532"><td class="memItemLeft" align="right" valign="top"><a id="gaaf2a6549a8c42b9eae3d40d21d1e9532"></a>
integer, parameter&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__module__radiation__clouds.html#gaaf2a6549a8c42b9eae3d40d21d1e9532">module_radiation_clouds::nseal</a> =2</td></tr>
<tr class="memdesc:gaaf2a6549a8c42b9eae3d40d21d1e9532"><td class="mdescLeft">&#160;</td><td class="mdescRight">=1,2 for land,sea <br /></td></tr>
<tr class="separator:gaaf2a6549a8c42b9eae3d40d21d1e9532"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga2ce850be46f0144caa09309ae01958c2"><td class="memItemLeft" align="right" valign="top"><a id="ga2ce850be46f0144caa09309ae01958c2"></a>
real(kind=kind_phys), parameter&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__module__radiation__clouds.html#ga2ce850be46f0144caa09309ae01958c2">module_radiation_clouds::cldssa_def</a> = 0.99</td></tr>
<tr class="memdesc:ga2ce850be46f0144caa09309ae01958c2"><td class="mdescLeft">&#160;</td><td class="mdescRight">default cld single scat albedo <br /></td></tr>
<tr class="separator:ga2ce850be46f0144caa09309ae01958c2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gab94e45a81d8be82b6cb686b35fd78a80"><td class="memItemLeft" align="right" valign="top"><a id="gab94e45a81d8be82b6cb686b35fd78a80"></a>
real(kind=kind_phys), parameter&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__module__radiation__clouds.html#gab94e45a81d8be82b6cb686b35fd78a80">module_radiation_clouds::cldasy_def</a> = 0.84</td></tr>
<tr class="memdesc:gab94e45a81d8be82b6cb686b35fd78a80"><td class="mdescLeft">&#160;</td><td class="mdescRight">default cld asymmetry factor <br /></td></tr>
<tr class="separator:gab94e45a81d8be82b6cb686b35fd78a80"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gab2a798da0bb0125d1d5074b73c5951dc"><td class="memItemLeft" align="right" valign="top"><a id="gab2a798da0bb0125d1d5074b73c5951dc"></a>
real(kind=kind_phys), dimension(3)&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__module__radiation__clouds.html#gab2a798da0bb0125d1d5074b73c5951dc">module_radiation_clouds::xlabdy</a></td></tr>
<tr class="memdesc:gab2a798da0bb0125d1d5074b73c5951dc"><td class="mdescLeft">&#160;</td><td class="mdescRight">lat bndry between tuning regions <br /></td></tr>
<tr class="separator:gab2a798da0bb0125d1d5074b73c5951dc"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gaab28f783919380e5ff7f925f70355a57"><td class="memItemLeft" align="right" valign="top"><a id="gaab28f783919380e5ff7f925f70355a57"></a>
real(kind=kind_phys), dimension(3)&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__module__radiation__clouds.html#gaab28f783919380e5ff7f925f70355a57">module_radiation_clouds::xlobdy</a></td></tr>
<tr class="memdesc:gaab28f783919380e5ff7f925f70355a57"><td class="mdescLeft">&#160;</td><td class="mdescRight">lon bndry between tuning regions <br /></td></tr>
<tr class="separator:gaab28f783919380e5ff7f925f70355a57"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga1146f43b680b655d354a9c031ee4a463"><td class="memItemLeft" align="right" valign="top"><a id="ga1146f43b680b655d354a9c031ee4a463"></a>
real(kind=kind_phys), parameter&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__module__radiation__clouds.html#ga1146f43b680b655d354a9c031ee4a463">module_radiation_clouds::xlim</a> =5.0</td></tr>
<tr class="memdesc:ga1146f43b680b655d354a9c031ee4a463"><td class="mdescLeft">&#160;</td><td class="mdescRight">+/- xlim for transition <br /></td></tr>
<tr class="separator:ga1146f43b680b655d354a9c031ee4a463"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga6ec3c0444de53580befd4bb4d39844d3"><td class="memItemLeft" align="right" valign="top"><a id="ga6ec3c0444de53580befd4bb4d39844d3"></a>
real(kind=kind_phys), parameter&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__module__radiation__clouds.html#ga6ec3c0444de53580befd4bb4d39844d3">module_radiation_clouds::vvcld1</a> = 0.0003e0</td></tr>
<tr class="memdesc:ga6ec3c0444de53580befd4bb4d39844d3"><td class="mdescLeft">&#160;</td><td class="mdescRight">low cloud vertical velocity adjustment boundaries in mb/sec <br /></td></tr>
<tr class="separator:ga6ec3c0444de53580befd4bb4d39844d3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga67962e77fb073cc25cafaaba0c2fa833"><td class="memItemLeft" align="right" valign="top"><a id="ga67962e77fb073cc25cafaaba0c2fa833"></a>
real(kind=kind_phys), parameter&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__module__radiation__clouds.html#ga67962e77fb073cc25cafaaba0c2fa833">module_radiation_clouds::vvcld2</a> =-0.0005e0</td></tr>
<tr class="memdesc:ga67962e77fb073cc25cafaaba0c2fa833"><td class="mdescLeft">&#160;</td><td class="mdescRight">low cloud vertical velocity adjustment boundaries in mb/sec <br /></td></tr>
<tr class="separator:ga67962e77fb073cc25cafaaba0c2fa833"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga9673faf82ef00e0501763664743e3720"><td class="memItemLeft" align="right" valign="top"><a id="ga9673faf82ef00e0501763664743e3720"></a>
real(kind=kind_phys), dimension(nbin, nlon, nlat, mcld, nseal)&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__module__radiation__clouds.html#ga9673faf82ef00e0501763664743e3720">module_radiation_clouds::rhcl</a></td></tr>
<tr class="memdesc:ga9673faf82ef00e0501763664743e3720"><td class="mdescLeft">&#160;</td><td class="mdescRight">tuned relative humidity relation table for diagnostic cloud scheme <br /></td></tr>
<tr class="separator:ga9673faf82ef00e0501763664743e3720"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga3390b20d42afccb3ec569a5b69a93f6e"><td class="memItemLeft" align="right" valign="top"><a id="ga3390b20d42afccb3ec569a5b69a93f6e"></a>
integer&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__module__radiation__clouds.html#ga3390b20d42afccb3ec569a5b69a93f6e">module_radiation_clouds::llyr</a> = 2</td></tr>
<tr class="memdesc:ga3390b20d42afccb3ec569a5b69a93f6e"><td class="mdescLeft">&#160;</td><td class="mdescRight">upper limit of boundary layer clouds <br /></td></tr>
<tr class="separator:ga3390b20d42afccb3ec569a5b69a93f6e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga5cfafee79e8cf066ddd8440cdfdc41a0"><td class="memItemLeft" align="right" valign="top"><a id="ga5cfafee79e8cf066ddd8440cdfdc41a0"></a>
integer&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__module__radiation__clouds.html#ga5cfafee79e8cf066ddd8440cdfdc41a0">module_radiation_clouds::iovr</a> = 1</td></tr>
<tr class="memdesc:ga5cfafee79e8cf066ddd8440cdfdc41a0"><td class="mdescLeft">&#160;</td><td class="mdescRight">maximum-random cloud overlapping method <br /></td></tr>
<tr class="separator:ga5cfafee79e8cf066ddd8440cdfdc41a0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga0e1ee94c9ca85849a219803325a61184"><td class="memItemLeft" align="right" valign="top">subroutine, public&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__module__radiation__clouds.html#ga0e1ee94c9ca85849a219803325a61184">module_radiation_clouds::cld_init</a> (si, NLAY, imp_physics, me)</td></tr>
<tr class="memdesc:ga0e1ee94c9ca85849a219803325a61184"><td class="mdescLeft">&#160;</td><td class="mdescRight">This subroutine is an initialization program for cloud-radiation calculations and sets up boundary layer cloud top.  <a href="group__module__radiation__clouds.html#ga0e1ee94c9ca85849a219803325a61184">More...</a><br /></td></tr>
<tr class="separator:ga0e1ee94c9ca85849a219803325a61184"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gafa23f5bc69fa713abfa32939fd96ade8"><td class="memItemLeft" align="right" valign="top">subroutine, public&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__module__radiation__clouds.html#gafa23f5bc69fa713abfa32939fd96ade8">module_radiation_clouds::progcld1</a> (plyr, plvl, tlyr, tvly, qlyr, qstl, rhly, clw, xlat, xlon, slmsk, IX, NLAY, NLP1, uni_cld, lmfshal, lmfdeep2, cldcov, effrl, effri, effrr, effrs, effr_in, clouds, clds, mtop, mbot)</td></tr>
<tr class="memdesc:gafa23f5bc69fa713abfa32939fd96ade8"><td class="mdescLeft">&#160;</td><td class="mdescRight">This subroutine computes cloud related quantities using zhao/moorthi's prognostic cloud microphysics scheme.  <a href="group__module__radiation__clouds.html#gafa23f5bc69fa713abfa32939fd96ade8">More...</a><br /></td></tr>
<tr class="separator:gafa23f5bc69fa713abfa32939fd96ade8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga3fd7643ce526761b17d04eec6a332333"><td class="memItemLeft" align="right" valign="top">subroutine, public&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__module__radiation__clouds.html#ga3fd7643ce526761b17d04eec6a332333">module_radiation_clouds::progcld2</a> (plyr, plvl, tlyr, tvly, qlyr, qstl, rhly, clw, xlat, xlon, slmsk, f_ice, f_rain, r_rime, flgmin, IX, NLAY, NLP1, lmfshal, lmfdeep2, clouds, clds, mtop, mbot)</td></tr>
<tr class="memdesc:ga3fd7643ce526761b17d04eec6a332333"><td class="mdescLeft">&#160;</td><td class="mdescRight">This subroutine computes cloud related quantities using ferrier's prognostic cloud microphysics scheme.  <a href="group__module__radiation__clouds.html#ga3fd7643ce526761b17d04eec6a332333">More...</a><br /></td></tr>
<tr class="separator:ga3fd7643ce526761b17d04eec6a332333"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gaeab51a06b22516fbfc78ab2c9eaf2622"><td class="memItemLeft" align="right" valign="top">subroutine, public&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__module__radiation__clouds.html#gaeab51a06b22516fbfc78ab2c9eaf2622">module_radiation_clouds::progcld3</a> (plyr, plvl, tlyr, tvly, qlyr, qstl, rhly, clw, cnvw, cnvc, xlat, xlon, slmsk, ix, nlay, nlp1, deltaq, sup, kdt, me, clouds, clds, mtop, mbot)</td></tr>
<tr class="memdesc:gaeab51a06b22516fbfc78ab2c9eaf2622"><td class="mdescLeft">&#160;</td><td class="mdescRight">This subroutine computes cloud related quantities using zhao/moorthi's prognostic cloud microphysics scheme + pdfcld.  <a href="group__module__radiation__clouds.html#gaeab51a06b22516fbfc78ab2c9eaf2622">More...</a><br /></td></tr>
<tr class="separator:gaeab51a06b22516fbfc78ab2c9eaf2622"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gabc94febdae92fa27984f169e713a8774"><td class="memItemLeft" align="right" valign="top"><a id="gabc94febdae92fa27984f169e713a8774"></a>
subroutine, public&#160;</td><td class="memItemRight" valign="bottom"><b>module_radiation_clouds::progcld4</b> (plyr, plvl, tlyr, tvly, qlyr, qstl, rhly, clw, xlat, xlon, slmsk, cldtot, IX, NLAY, NLP1, clouds, clds, mtop, mbot)</td></tr>
<tr class="separator:gabc94febdae92fa27984f169e713a8774"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gaa054de52f7568837d7a82ee1e2117b90"><td class="memItemLeft" align="right" valign="top"><a id="gaa054de52f7568837d7a82ee1e2117b90"></a>
subroutine, public&#160;</td><td class="memItemRight" valign="bottom"><b>module_radiation_clouds::progcld4o</b> (plyr, plvl, tlyr, tvly, qlyr, qstl, rhly, clw, xlat, xlon, slmsk, ntrac, ntcw, ntiw, ntrw, ntsw, ntgl, ntclamt, IX, NLAY, NLP1, clouds, clds, mtop, mbot)</td></tr>
<tr class="separator:gaa054de52f7568837d7a82ee1e2117b90"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga0c2a2c0d1abf49c1d6bbeb12d3223893"><td class="memItemLeft" align="right" valign="top">subroutine, public&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__module__radiation__clouds.html#ga0c2a2c0d1abf49c1d6bbeb12d3223893">module_radiation_clouds::progcld5</a> (plyr, plvl, tlyr, qlyr, qstl, rhly, clw, xlat, xlon, slmsk, ntrac, ntcw, ntiw, ntrw, ntsw, ntgl, IX, NLAY, NLP1, uni_cld, lmfshal, lmfdeep2, cldcov, re_cloud, re_ice, re_snow, clouds, clds, mtop, mbot)</td></tr>
<tr class="separator:ga0c2a2c0d1abf49c1d6bbeb12d3223893"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gaa369e2e2910b3468614db856b378f3ba"><td class="memItemLeft" align="right" valign="top">subroutine, public&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__module__radiation__clouds.html#gaa369e2e2910b3468614db856b378f3ba">module_radiation_clouds::progclduni</a> (plyr, plvl, tlyr, tvly, ccnd, ncnd, xlat, xlon, slmsk, IX, NLAY, NLP1, cldtot, effrl, effri, effrr, effrs, effr_in, clouds, clds, mtop, mbot)</td></tr>
<tr class="memdesc:gaa369e2e2910b3468614db856b378f3ba"><td class="mdescLeft">&#160;</td><td class="mdescRight">This subroutine computes cloud related quantities using zhao/moorthi's prognostic cloud microphysics scheme.  <a href="group__module__radiation__clouds.html#gaa369e2e2910b3468614db856b378f3ba">More...</a><br /></td></tr>
<tr class="separator:gaa369e2e2910b3468614db856b378f3ba"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga022c3706242426745001b7837ae801a3"><td class="memItemLeft" align="right" valign="top">subroutine, public&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__module__radiation__clouds.html#ga022c3706242426745001b7837ae801a3">module_radiation_clouds::diagcld1</a> (plyr, plvl, tlyr, rhly, vvel, cv, cvt, cvb, xlat, xlon, slmsk, IX, NLAY, NLP1, clouds, clds, mtop, mbot)</td></tr>
<tr class="memdesc:ga022c3706242426745001b7837ae801a3"><td class="mdescLeft">&#160;</td><td class="mdescRight">This subroutine computes cloud fractions for radiation calculations.  <a href="group__module__radiation__clouds.html#ga022c3706242426745001b7837ae801a3">More...</a><br /></td></tr>
<tr class="separator:ga022c3706242426745001b7837ae801a3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gac231d967afcfb252dedba82e9085b34d"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__module__radiation__clouds.html#gac231d967afcfb252dedba82e9085b34d">module_radiation_clouds::gethml</a> (plyr, ptop1, cldtot, cldcnv, IX, NLAY, clds, mtop, mbot)</td></tr>
<tr class="memdesc:gac231d967afcfb252dedba82e9085b34d"><td class="mdescLeft">&#160;</td><td class="mdescRight">This subroutine computes high, mid, low, total, and boundary cloud fractions and cloud top/bottom layer indices for model diagnostic output. The three cloud domain boundaries are defined by ptopc. The cloud overlapping method is defined by control flag 'iovr', which is also used by LW and SW radiation programs.  <a href="group__module__radiation__clouds.html#gac231d967afcfb252dedba82e9085b34d">More...</a><br /></td></tr>
<tr class="separator:gac231d967afcfb252dedba82e9085b34d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga9b3f43844a53e79cd5c348f8c72ec408"><td class="memItemLeft" align="right" valign="top"><a id="ga9b3f43844a53e79cd5c348f8c72ec408"></a>
subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__module__radiation__clouds.html#ga9b3f43844a53e79cd5c348f8c72ec408">module_radiation_clouds::rhtable</a> (me, ier)</td></tr>
<tr class="memdesc:ga9b3f43844a53e79cd5c348f8c72ec408"><td class="mdescLeft">&#160;</td><td class="mdescRight">cld-rh relations obtained from mitchell-hahn procedure. <br /></td></tr>
<tr class="separator:ga9b3f43844a53e79cd5c348f8c72ec408"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<h2 class="groupheader">Function/Subroutine Documentation</h2>
<a id="ga0e1ee94c9ca85849a219803325a61184"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga0e1ee94c9ca85849a219803325a61184">&#9670;&nbsp;</a></span>cld_init()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine, public module_radiation_clouds::cld_init </td>
          <td>(</td>
          <td class="paramtype">real (kind=kind_phys), dimension(:), intent(in)&#160;</td>
          <td class="paramname"><em>si</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>NLAY</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>imp_physics</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>me</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">si</td><td>model vertical sigma layer interface </td></tr>
    <tr><td class="paramname">NLAY</td><td>vertical layer number </td></tr>
    <tr><td class="paramname">me</td><td>print control flag </td></tr>
  </table>
  </dd>
</dl>
<h1><a class="anchor" id="gen_cld_init"></a>
General Algorithm</h1>
<ol type="1">
<li>Call <a class="el" href="group__module__radiation__clouds.html#ga9b3f43844a53e79cd5c348f8c72ec408" title="cld-rh relations obtained from mitchell-hahn procedure. ">rhtable()</a> to set up tuned relative humidity table.</li>
<li>Compute the top of BL cld (llyr), which is the topmost non cld(low) layer for stratiform (at or above lowest 0.1 of the atmosphere). </li>
</ol>

<p class="definition">Definition at line <a class="el" href="radiation__clouds_8f_source.html#l00343">343</a> of file <a class="el" href="radiation__clouds_8f_source.html">radiation_clouds.f</a>.</p>

<p class="reference">References <a class="el" href="radiation__clouds_8f_source.html#l00322">iovr</a>, <a class="el" href="radiation__clouds_8f_source.html#l00320">llyr</a>, and <a class="el" href="radiation__clouds_8f_source.html#l04207">rhtable()</a>.</p>

<p class="reference">Referenced by <a class="el" href="_g_f_s__radiation__driver_8_f90_source.html#l00417">module_radiation_driver::radinit()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="group__module__radiation__clouds_ga0e1ee94c9ca85849a219803325a61184_cgraph.png" border="0" usemap="#group__module__radiation__clouds_ga0e1ee94c9ca85849a219803325a61184_cgraph" alt=""/></div>
<!-- MAP 0 -->
</div>

</div>
</div>
<a id="ga022c3706242426745001b7837ae801a3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga022c3706242426745001b7837ae801a3">&#9670;&nbsp;</a></span>diagcld1()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine, public module_radiation_clouds::diagcld1 </td>
          <td>(</td>
          <td class="paramtype">real (kind=kind_phys), dimension(:,:), intent(in)&#160;</td>
          <td class="paramname"><em>plyr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real (kind=kind_phys), dimension(:,:), intent(in)&#160;</td>
          <td class="paramname"><em>plvl</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real (kind=kind_phys), dimension(:,:), intent(in)&#160;</td>
          <td class="paramname"><em>tlyr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real (kind=kind_phys), dimension(:,:), intent(in)&#160;</td>
          <td class="paramname"><em>rhly</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real (kind=kind_phys), dimension(:,:), intent(in)&#160;</td>
          <td class="paramname"><em>vvel</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real (kind=kind_phys), dimension(:), intent(in)&#160;</td>
          <td class="paramname"><em>cv</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real (kind=kind_phys), dimension(:), intent(in)&#160;</td>
          <td class="paramname"><em>cvt</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real (kind=kind_phys), dimension(:), intent(in)&#160;</td>
          <td class="paramname"><em>cvb</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real (kind=kind_phys), dimension(:), intent(in)&#160;</td>
          <td class="paramname"><em>xlat</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real (kind=kind_phys), dimension(:), intent(in)&#160;</td>
          <td class="paramname"><em>xlon</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real (kind=kind_phys), dimension(:), intent(in)&#160;</td>
          <td class="paramname"><em>slmsk</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>IX</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>NLAY</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>NLP1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real (kind=kind_phys), dimension(:,:,:), intent(out)&#160;</td>
          <td class="paramname"><em>clouds</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real (kind=kind_phys), dimension(:,:), intent(out)&#160;</td>
          <td class="paramname"><em>clds</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, dimension(:,:), intent(out)&#160;</td>
          <td class="paramname"><em>mtop</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, dimension(:,:), intent(out)&#160;</td>
          <td class="paramname"><em>mbot</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">plyr</td><td>(IX,NLAY), model layer mean pressure in mb (100Pa) </td></tr>
    <tr><td class="paramname">plvl</td><td>(IX,NLP1), model level pressure in mb (100Pa) </td></tr>
    <tr><td class="paramname">tlyr</td><td>(IX,NLAY), model layer mean temperature in K </td></tr>
    <tr><td class="paramname">rhly</td><td>(IX,NLAY), layer relative humidity </td></tr>
    <tr><td class="paramname">vvel</td><td>(IX,NLAY), layer mean vertical velocity in mb/sec </td></tr>
    <tr><td class="paramname">cv</td><td>(IX), fraction of convective cloud </td></tr>
    <tr><td class="paramname">cvt,cvb</td><td>(IX), conv cloud top/bottom pressure in mb </td></tr>
    <tr><td class="paramname">xlat</td><td>(IX), grid latitude in radians, default to pi/2 -&gt; -pi/2 range, otherwise see in-line comment </td></tr>
    <tr><td class="paramname">xlon</td><td>(IX), grid longitude in radians, ok for both 0-&gt;2pi or -pi -&gt; +pi ranges </td></tr>
    <tr><td class="paramname">slmsk</td><td>(IX), sea/land mask array (sea:0,land:1,sea-ice:2) </td></tr>
    <tr><td class="paramname">IX</td><td>horizontal dimention </td></tr>
    <tr><td class="paramname">NLAY,NLP1</td><td>vertical layer/level dimensions </td></tr>
    <tr><td class="paramname">clouds</td><td>(IX,NLAY,NF_CLDS), cloud profiles <br />
 (:,:,1) - layer total cloud fraction <br />
 (:,:,2) - layer cloud optical depth <br />
 (:,:,3) - layer cloud single scattering albedo <br />
 (:,:,4) - layer cloud asymmetry factor </td></tr>
    <tr><td class="paramname">clds</td><td>(IX,5), fraction of clouds for low, mid, hi, tot, bl </td></tr>
    <tr><td class="paramname">mtop</td><td>(IX,3), vertical indices for low, mid, hi cloud tops </td></tr>
    <tr><td class="paramname">mbot</td><td>(IX,3), vertical indices for low, mid, hi cloud bases </td></tr>
  </table>
  </dd>
</dl>
<h1><a class="anchor" id="gen_diagcld1"></a>
General Algorithm</h1>
<ol type="1">
<li>Get rh-cld relation for this lat.</li>
<li>Linear transition between latitudinal regions.</li>
<li>Get rh-cld relationship for each grid point, interpolating longitudinally between regions if necessary.</li>
<li>Find top pressure for each cloud domain.</li>
<li>Compute stratiform cloud optical depth.</li>
<li>Calculate potential temperature and its lapse rate.</li>
<li>Diagnostic method to find cloud amount cldtot, cldcnv.<ul>
<li>Find the lowest low cloud top sigma level, computed for each lat cause domain definition changes with latitude.</li>
<li>Find the stratosphere cut off layer for high cloud (about 250mb). It is assumed to be above the layerwith dthdp less than -0.25 in the high cloud domain.</li>
<li>Put convective cloud into 'cldcnv', no merge at this point.</li>
<li>Calculate stratiform cloud and put into array 'cldtot' using the cld-rh relationship from table look-up, where tables obtained using k.mitchell frequency distribution tuning.</li>
<li>Compute vertical velocity adjustment on low clouds.</li>
<li>Calculate diagnostic cloud optical depth.</li>
</ul>
</li>
<li>Call <a class="el" href="group__module__radiation__clouds.html#gac231d967afcfb252dedba82e9085b34d" title="This subroutine computes high, mid, low, total, and boundary cloud fractions and cloud top/bottom lay...">gethml()</a>, to compute low, mid, high, total, and boundary layer cloud fractions and cloud top/bottom layer indices for low, mid, and high clouds. </li>
</ol>

<p class="definition">Definition at line <a class="el" href="radiation__clouds_8f_source.html#l03268">3268</a> of file <a class="el" href="radiation__clouds_8f_source.html">radiation_clouds.f</a>.</p>

<p class="reference">References <a class="el" href="radiation__clouds_8f_source.html#l00295">cldasy_def</a>, <a class="el" href="radiation__clouds_8f_source.html#l00293">cldssa_def</a>, <a class="el" href="radiation__clouds_8f_source.html#l03884">gethml()</a>, <a class="el" href="radiation__clouds_8f_source.html#l00320">llyr</a>, <a class="el" href="radiation__clouds_8f_source.html#l00288">mcld</a>, <a class="el" href="radiation__clouds_8f_source.html#l00282">nbin</a>, <a class="el" href="radiation__clouds_8f_source.html#l00284">nlon</a>, <a class="el" href="radiation__clouds_8f_source.html#l00290">nseal</a>, <a class="el" href="radiation__clouds_8f_source.html#l00263">ptopc</a>, <a class="el" href="radiation__clouds_8f_source.html#l00317">rhcl</a>, <a class="el" href="radiation__clouds_8f_source.html#l00309">vvcld1</a>, <a class="el" href="radiation__clouds_8f_source.html#l00311">vvcld2</a>, <a class="el" href="radiation__clouds_8f_source.html#l00300">xlabdy</a>, <a class="el" href="radiation__clouds_8f_source.html#l00304">xlim</a>, and <a class="el" href="radiation__clouds_8f_source.html#l00302">xlobdy</a>.</p>

<p class="reference">Referenced by <a class="el" href="_g_f_s__radiation__driver_8_f90_source.html#l01015">module_radiation_driver::gfs_radiation_driver()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="group__module__radiation__clouds_ga022c3706242426745001b7837ae801a3_cgraph.png" border="0" usemap="#group__module__radiation__clouds_ga022c3706242426745001b7837ae801a3_cgraph" alt=""/></div>
<!-- MAP 1 -->
</div>

</div>
</div>
<a id="gac231d967afcfb252dedba82e9085b34d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gac231d967afcfb252dedba82e9085b34d">&#9670;&nbsp;</a></span>gethml()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">subroutine module_radiation_clouds::gethml </td>
          <td>(</td>
          <td class="paramtype">real (kind=kind_phys), dimension(:,:), intent(in)&#160;</td>
          <td class="paramname"><em>plyr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real (kind=kind_phys), dimension(:,:), intent(in)&#160;</td>
          <td class="paramname"><em>ptop1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real (kind=kind_phys), dimension(:,:), intent(in)&#160;</td>
          <td class="paramname"><em>cldtot</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real (kind=kind_phys), dimension(:,:), intent(in)&#160;</td>
          <td class="paramname"><em>cldcnv</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>IX</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>NLAY</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real (kind=kind_phys), dimension(:,:), intent(out)&#160;</td>
          <td class="paramname"><em>clds</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, dimension(:,:), intent(out)&#160;</td>
          <td class="paramname"><em>mtop</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, dimension(:,:), intent(out)&#160;</td>
          <td class="paramname"><em>mbot</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">plyr</td><td>(IX,NLAY), model layer mean pressure in mb (100Pa) </td></tr>
    <tr><td class="paramname">ptop1</td><td>(IX,4), pressure limits of cloud domain interfaces (sfc,low,mid,high) in mb (100Pa) </td></tr>
    <tr><td class="paramname">cldtot</td><td>(IX,NLAY), total or stratiform cloud profile in fraction </td></tr>
    <tr><td class="paramname">cldcnv</td><td>(IX,NLAY), convective cloud (for diagnostic scheme only) </td></tr>
    <tr><td class="paramname">IX</td><td>horizontal dimension </td></tr>
    <tr><td class="paramname">NLAY</td><td>vertical layer dimensions </td></tr>
    <tr><td class="paramname">clds</td><td>(IX,5), fraction of clouds for low, mid, hi, tot, bl </td></tr>
    <tr><td class="paramname">mtop</td><td>(IX,3),vertical indices for low, mid, hi cloud tops </td></tr>
    <tr><td class="paramname">mbot</td><td>(IX,3),vertical indices for low, mid, hi cloud bases</td></tr>
  </table>
  </dd>
</dl>
<h1><a class="anchor" id="detail"></a>
Detailed Algorithm</h1>
<ol type="1">
<li>Calculate total and BL cloud fractions (maximum-random cloud overlapping is operational).</li>
<li>Calculte high, mid, low cloud fractions and vertical indices of cloud tops/bases. </li>
</ol>

<p class="definition">Definition at line <a class="el" href="radiation__clouds_8f_source.html#l03884">3884</a> of file <a class="el" href="radiation__clouds_8f_source.html">radiation_clouds.f</a>.</p>

<p class="reference">References <a class="el" href="radiation__clouds_8f_source.html#l00322">iovr</a>, <a class="el" href="radiation__clouds_8f_source.html#l00320">llyr</a>, and <a class="el" href="radiation__clouds_8f_source.html#l00260">nk_clds</a>.</p>

<p class="reference">Referenced by <a class="el" href="radiation__clouds_8f_source.html#l03268">diagcld1()</a>, <a class="el" href="radiation__clouds_8f_source.html#l00508">progcld1()</a>, <a class="el" href="radiation__clouds_8f_source.html#l00989">progcld2()</a>, <a class="el" href="radiation__clouds_8f_source.html#l01489">progcld3()</a>, <a class="el" href="radiation__clouds_8f_source.html#l02464">progcld5()</a>, and <a class="el" href="radiation__clouds_8f_source.html#l02893">progclduni()</a>.</p>

</div>
</div>
<a id="gafa23f5bc69fa713abfa32939fd96ade8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gafa23f5bc69fa713abfa32939fd96ade8">&#9670;&nbsp;</a></span>progcld1()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine, public module_radiation_clouds::progcld1 </td>
          <td>(</td>
          <td class="paramtype">real (kind=kind_phys), dimension(:,:), intent(in)&#160;</td>
          <td class="paramname"><em>plyr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real (kind=kind_phys), dimension(:,:), intent(in)&#160;</td>
          <td class="paramname"><em>plvl</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real (kind=kind_phys), dimension(:,:), intent(in)&#160;</td>
          <td class="paramname"><em>tlyr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real (kind=kind_phys), dimension(:,:), intent(in)&#160;</td>
          <td class="paramname"><em>tvly</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real (kind=kind_phys), dimension(:,:), intent(in)&#160;</td>
          <td class="paramname"><em>qlyr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real (kind=kind_phys), dimension(:,:), intent(in)&#160;</td>
          <td class="paramname"><em>qstl</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real (kind=kind_phys), dimension(:,:), intent(in)&#160;</td>
          <td class="paramname"><em>rhly</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real (kind=kind_phys), dimension(:,:), intent(in)&#160;</td>
          <td class="paramname"><em>clw</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real (kind=kind_phys), dimension(:), intent(in)&#160;</td>
          <td class="paramname"><em>xlat</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real (kind=kind_phys), dimension(:), intent(in)&#160;</td>
          <td class="paramname"><em>xlon</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real (kind=kind_phys), dimension(:), intent(in)&#160;</td>
          <td class="paramname"><em>slmsk</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>IX</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>NLAY</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>NLP1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">logical, intent(in)&#160;</td>
          <td class="paramname"><em>uni_cld</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">logical, intent(in)&#160;</td>
          <td class="paramname"><em>lmfshal</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">logical, intent(in)&#160;</td>
          <td class="paramname"><em>lmfdeep2</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real (kind=kind_phys), dimension(:,:), intent(in)&#160;</td>
          <td class="paramname"><em>cldcov</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real (kind=kind_phys), dimension(:,:), intent(in)&#160;</td>
          <td class="paramname"><em>effrl</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real (kind=kind_phys), dimension(:,:), intent(in)&#160;</td>
          <td class="paramname"><em>effri</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real (kind=kind_phys), dimension(:,:), intent(in)&#160;</td>
          <td class="paramname"><em>effrr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real (kind=kind_phys), dimension(:,:), intent(in)&#160;</td>
          <td class="paramname"><em>effrs</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">logical, intent(in)&#160;</td>
          <td class="paramname"><em>effr_in</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real (kind=kind_phys), dimension(:,:,:), intent(out)&#160;</td>
          <td class="paramname"><em>clouds</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real (kind=kind_phys), dimension(:,:), intent(out)&#160;</td>
          <td class="paramname"><em>clds</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, dimension(:,:), intent(out)&#160;</td>
          <td class="paramname"><em>mtop</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, dimension(:,:), intent(out)&#160;</td>
          <td class="paramname"><em>mbot</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">plyr</td><td>(IX,NLAY), model layer mean pressure in mb (100Pa) </td></tr>
    <tr><td class="paramname">plvl</td><td>(IX,NLP1), model level pressure in mb (100Pa) </td></tr>
    <tr><td class="paramname">tlyr</td><td>(IX,NLAY), model layer mean temperature in K </td></tr>
    <tr><td class="paramname">tvly</td><td>(IX,NLAY), model layer virtual temperature in K </td></tr>
    <tr><td class="paramname">qlyr</td><td>(IX,NLAY), layer specific humidity in gm/gm </td></tr>
    <tr><td class="paramname">qstl</td><td>(IX,NLAY), layer saturate humidity in gm/gm </td></tr>
    <tr><td class="paramname">rhly</td><td>(IX,NLAY), layer relative humidity \( (=qlyr/qstl) \) </td></tr>
    <tr><td class="paramname">clw</td><td>(IX,NLAY), layer cloud condensate amount </td></tr>
    <tr><td class="paramname">xlat</td><td>(IX), grid latitude in radians, default to pi/2 -&gt; -pi/2 range, otherwise see in-line comment </td></tr>
    <tr><td class="paramname">xlon</td><td>(IX), grid longitude in radians (not used) </td></tr>
    <tr><td class="paramname">slmsk</td><td>(IX), sea/land mask array (sea:0,land:1,sea-ice:2) </td></tr>
    <tr><td class="paramname">IX</td><td>horizontal dimention </td></tr>
    <tr><td class="paramname">NLAY,NLP1</td><td>vertical layer/level dimensions </td></tr>
    <tr><td class="paramname">clouds</td><td>(IX,NLAY,NF_CLDS), cloud profiles <br />
 (:,:,1) - layer total cloud fraction <br />
 (:,:,2) - layer cloud liq water path \((g/m^2)\) <br />
 (:,:,3) - mean eff radius for liq cloud (micron) <br />
 (:,:,4) - layer cloud ice water path \((g/m^2)\) <br />
 (:,:,5) - mean eff radius for ice cloud (micron) <br />
 (:,:,6) - layer rain drop water path (not assigned) <br />
 (:,:,7) - mean eff radius for rain drop (micron) <br />
 (:,:,8) - layer snow flake water path (not assigned) <br />
 (:,:,9) - mean eff radius for snow flake (micron) <br />
 *** fu's scheme need to be normalized by snow density \( (g/m^3/1.0e6)\) </td></tr>
    <tr><td class="paramname">clds</td><td>(IX,5), fraction of clouds for low, mid, hi, tot, bl </td></tr>
    <tr><td class="paramname">mtop</td><td>(IX,3), vertical indices for low, mid, hi cloud tops </td></tr>
    <tr><td class="paramname">mbot</td><td>(IX,3), vertical indices for low, mid, hi cloud bases </td></tr>
  </table>
  </dd>
</dl>
<h1><a class="anchor" id="gen_progcld1"></a>
General Algorithm</h1>
<ol type="1">
<li>Find top pressure for each cloud domain for given latitude.</li>
<li>Compute cloud liquid/ice condensate path in \( g/m^2 \) .</li>
<li>Compute effective liquid cloud droplet radius over land.</li>
<li>Calculate layer cloud fraction.</li>
<li>Compute effective ice cloud droplet radius following Heymsfield and McFarquhar (1996) <a class="el" href="citelist.html#CITEREF_heymsfield_and_mcfarquhar_1996">[28]</a>.</li>
<li>Call <a class="el" href="group__module__radiation__clouds.html#gac231d967afcfb252dedba82e9085b34d" title="This subroutine computes high, mid, low, total, and boundary cloud fractions and cloud top/bottom lay...">gethml()</a> to compute low,mid,high,total, and boundary layer cloud fractions and clouds top/bottom layer indices for low, mid, and high clouds. </li>
</ol>

<p class="definition">Definition at line <a class="el" href="radiation__clouds_8f_source.html#l00508">508</a> of file <a class="el" href="radiation__clouds_8f_source.html">radiation_clouds.f</a>.</p>

<p class="reference">References <a class="el" href="radiation__clouds_8f_source.html#l03884">gethml()</a>, <a class="el" href="radiation__clouds_8f_source.html#l00258">nf_clds</a>, <a class="el" href="radiation__clouds_8f_source.html#l00263">ptopc</a>, <a class="el" href="radiation__clouds_8f_source.html#l00275">reice_def</a>, <a class="el" href="radiation__clouds_8f_source.html#l00273">reliq_def</a>, <a class="el" href="radiation__clouds_8f_source.html#l00277">rrain_def</a>, and <a class="el" href="radiation__clouds_8f_source.html#l00279">rsnow_def</a>.</p>

<p class="reference">Referenced by <a class="el" href="_g_f_s__radiation__driver_8_f90_source.html#l01015">module_radiation_driver::gfs_radiation_driver()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="group__module__radiation__clouds_gafa23f5bc69fa713abfa32939fd96ade8_cgraph.png" border="0" usemap="#group__module__radiation__clouds_gafa23f5bc69fa713abfa32939fd96ade8_cgraph" alt=""/></div>
<!-- MAP 2 -->
</div>

</div>
</div>
<a id="ga3fd7643ce526761b17d04eec6a332333"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga3fd7643ce526761b17d04eec6a332333">&#9670;&nbsp;</a></span>progcld2()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine, public module_radiation_clouds::progcld2 </td>
          <td>(</td>
          <td class="paramtype">real (kind=kind_phys), dimension(:,:), intent(in)&#160;</td>
          <td class="paramname"><em>plyr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real (kind=kind_phys), dimension(:,:), intent(in)&#160;</td>
          <td class="paramname"><em>plvl</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real (kind=kind_phys), dimension(:,:), intent(in)&#160;</td>
          <td class="paramname"><em>tlyr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real (kind=kind_phys), dimension(:,:), intent(in)&#160;</td>
          <td class="paramname"><em>tvly</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real (kind=kind_phys), dimension(:,:), intent(in)&#160;</td>
          <td class="paramname"><em>qlyr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real (kind=kind_phys), dimension(:,:), intent(in)&#160;</td>
          <td class="paramname"><em>qstl</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real (kind=kind_phys), dimension(:,:), intent(in)&#160;</td>
          <td class="paramname"><em>rhly</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real (kind=kind_phys), dimension(:,:), intent(in)&#160;</td>
          <td class="paramname"><em>clw</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real (kind=kind_phys), dimension(:), intent(in)&#160;</td>
          <td class="paramname"><em>xlat</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real (kind=kind_phys), dimension(:), intent(in)&#160;</td>
          <td class="paramname"><em>xlon</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real (kind=kind_phys), dimension(:), intent(in)&#160;</td>
          <td class="paramname"><em>slmsk</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real (kind=kind_phys), dimension(:,:), intent(in)&#160;</td>
          <td class="paramname"><em>f_ice</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real (kind=kind_phys), dimension(:,:), intent(in)&#160;</td>
          <td class="paramname"><em>f_rain</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real (kind=kind_phys), dimension(:,:), intent(in)&#160;</td>
          <td class="paramname"><em>r_rime</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real (kind=kind_phys), dimension(:), intent(in)&#160;</td>
          <td class="paramname"><em>flgmin</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>IX</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>NLAY</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>NLP1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">logical, intent(in)&#160;</td>
          <td class="paramname"><em>lmfshal</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">logical, intent(in)&#160;</td>
          <td class="paramname"><em>lmfdeep2</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real (kind=kind_phys), dimension(:,:,:), intent(out)&#160;</td>
          <td class="paramname"><em>clouds</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real (kind=kind_phys), dimension(:,:), intent(out)&#160;</td>
          <td class="paramname"><em>clds</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, dimension(:,:), intent(out)&#160;</td>
          <td class="paramname"><em>mtop</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, dimension(:,:), intent(out)&#160;</td>
          <td class="paramname"><em>mbot</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">plyr</td><td>(IX,NLAY), model layer mean pressure in mb (100Pa) </td></tr>
    <tr><td class="paramname">plvl</td><td>(IX,NLP1), model level pressure in mb (100Pa) </td></tr>
    <tr><td class="paramname">tlyr</td><td>(IX,NLAY), model layer mean temperature in K </td></tr>
    <tr><td class="paramname">tvly</td><td>(IX,NLAY), model layer virtual temperature in K </td></tr>
    <tr><td class="paramname">qlyr</td><td>(IX,NLAY), layer specific humidity in gm/gm </td></tr>
    <tr><td class="paramname">qstl</td><td>(IX,NLAY), layer saturate humidity in gm/gm </td></tr>
    <tr><td class="paramname">rhly</td><td>(IX,NLAY), layer relative humidity (=qlyr/qstl) </td></tr>
    <tr><td class="paramname">clw</td><td>(IX,NLAY), layer cloud condensate amount </td></tr>
    <tr><td class="paramname">f_ice</td><td>(IX,NLAY), fraction of layer cloud ice (ferrier micro-phys) </td></tr>
    <tr><td class="paramname">f_rain</td><td>(IX,NLAY), fraction of layer rain water (ferrier micro-phys) </td></tr>
    <tr><td class="paramname">r_rime</td><td>(IX,NLAY), mass ratio of total ice to unrimed ice (&gt;=1) </td></tr>
    <tr><td class="paramname">flgmin</td><td>(IX), minimum large ice fraction </td></tr>
    <tr><td class="paramname">xlat</td><td>(IX), grid latitude in radians, default to pi/2 -&gt; -pi/2 range, otherwise see in-line comment </td></tr>
    <tr><td class="paramname">xlon</td><td>(IX), grid longitude in radians (not used) </td></tr>
    <tr><td class="paramname">slmsk</td><td>(IX), sea/land mask array (sea:0,land:1,sea-ice:2) </td></tr>
    <tr><td class="paramname">IX</td><td>horizontal dimention </td></tr>
    <tr><td class="paramname">NLAY,NLP1</td><td>vertical layer/level dimensions </td></tr>
    <tr><td class="paramname">clouds</td><td>(IX,NLAY,NF_CLDS), cloud profiles <br />
 (:,:,1) - layer total cloud fraction <br />
 (:,:,2) - layer cloud liq water path \((g/m^2)\) <br />
 (:,:,3) - mean eff radius for liq cloud (micron) <br />
 (:,:,4) - layer cloud ice water path \((g/m^2)\) <br />
 (:,:,5) - mean eff radius for ice cloud (micron) <br />
 (:,:,6) - layer rain drop water path \((g/m^2)\) <br />
 (:,:,7) - mean eff radius for rain drop (micron) <br />
 (:,:,8) - layer snow flake water path \((g/m^2)\) <br />
 (:,:,9) - mean eff radius for snow flake (micron) <br />
 *** fu's scheme need to be normalized by snow density (g/m**3/1.0e6) </td></tr>
    <tr><td class="paramname">clds</td><td>(IX,5), fraction of clouds for low, mid, hi, tot, bl </td></tr>
    <tr><td class="paramname">mtop</td><td>(IX,3), vertical indices for low, mid, hi cloud tops </td></tr>
    <tr><td class="paramname">mbot</td><td>(IX,3), vertical indices for low, mid, hi cloud bases </td></tr>
  </table>
  </dd>
</dl>
<h1><a class="anchor" id="gen_progcld2"></a>
General Algorithm</h1>
<ol type="1">
<li>Find top pressure (ptopc) for each cloud domain for given latitude.</li>
<li>Seperate cloud condensate into liquid, ice, and rain types, and save the liquid+ice condensate in array clw2 for later calculation of cloud fraction.</li>
<li>Call module_microphysics::rsipath2(), in Ferrier's scheme, to compute layer's cloud liquid, ice, rain, and snow water condensate path and the partical effective radius for liquid droplet, rain drop, and snow flake.</li>
<li>Calculate layer cloud fraction.</li>
<li>Calculate effective ice cloud droplet radius.</li>
<li>Call <a class="el" href="group__module__radiation__clouds.html#gac231d967afcfb252dedba82e9085b34d" title="This subroutine computes high, mid, low, total, and boundary cloud fractions and cloud top/bottom lay...">gethml()</a>, to compute low, mid, high, total, and boundary layer cloud fractions and clouds top/bottom layer indices for low, mid, and high clouds. </li>
</ol>

<p class="definition">Definition at line <a class="el" href="radiation__clouds_8f_source.html#l00989">989</a> of file <a class="el" href="radiation__clouds_8f_source.html">radiation_clouds.f</a>.</p>

<p class="reference">References <a class="el" href="radiation__clouds_8f_source.html#l03884">gethml()</a>, <a class="el" href="radiation__clouds_8f_source.html#l00263">ptopc</a>, <a class="el" href="radiation__clouds_8f_source.html#l00275">reice_def</a>, <a class="el" href="radiation__clouds_8f_source.html#l00273">reliq_def</a>, <a class="el" href="radiation__clouds_8f_source.html#l00277">rrain_def</a>, and <a class="el" href="radiation__clouds_8f_source.html#l00279">rsnow_def</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="group__module__radiation__clouds_ga3fd7643ce526761b17d04eec6a332333_cgraph.png" border="0" usemap="#group__module__radiation__clouds_ga3fd7643ce526761b17d04eec6a332333_cgraph" alt=""/></div>
<!-- MAP 3 -->
</div>

</div>
</div>
<a id="gaeab51a06b22516fbfc78ab2c9eaf2622"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gaeab51a06b22516fbfc78ab2c9eaf2622">&#9670;&nbsp;</a></span>progcld3()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine, public module_radiation_clouds::progcld3 </td>
          <td>(</td>
          <td class="paramtype">real (kind=kind_phys), dimension(:,:), intent(in)&#160;</td>
          <td class="paramname"><em>plyr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real (kind=kind_phys), dimension(:,:), intent(in)&#160;</td>
          <td class="paramname"><em>plvl</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real (kind=kind_phys), dimension(:,:), intent(in)&#160;</td>
          <td class="paramname"><em>tlyr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real (kind=kind_phys), dimension(:,:), intent(in)&#160;</td>
          <td class="paramname"><em>tvly</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real (kind=kind_phys), dimension(:,:), intent(in)&#160;</td>
          <td class="paramname"><em>qlyr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real (kind=kind_phys), dimension(:,:), intent(in)&#160;</td>
          <td class="paramname"><em>qstl</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real (kind=kind_phys), dimension(:,:), intent(in)&#160;</td>
          <td class="paramname"><em>rhly</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real (kind=kind_phys), dimension(:,:), intent(in)&#160;</td>
          <td class="paramname"><em>clw</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real (kind=kind_phys), dimension(:,:)&#160;</td>
          <td class="paramname"><em>cnvw</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real (kind=kind_phys), dimension(:,:)&#160;</td>
          <td class="paramname"><em>cnvc</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real (kind=kind_phys), dimension(:), intent(in)&#160;</td>
          <td class="paramname"><em>xlat</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real (kind=kind_phys), dimension(:), intent(in)&#160;</td>
          <td class="paramname"><em>xlon</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real (kind=kind_phys), dimension(:), intent(in)&#160;</td>
          <td class="paramname"><em>slmsk</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>ix</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>nlay</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>nlp1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real (kind=kind_phys), dimension(:,:)&#160;</td>
          <td class="paramname"><em>deltaq</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real (kind=kind_phys), intent(in)&#160;</td>
          <td class="paramname"><em>sup</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>kdt</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer&#160;</td>
          <td class="paramname"><em>me</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real (kind=kind_phys), dimension(:,:,:), intent(out)&#160;</td>
          <td class="paramname"><em>clouds</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real (kind=kind_phys), dimension(:,:), intent(out)&#160;</td>
          <td class="paramname"><em>clds</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, dimension(:,:), intent(out)&#160;</td>
          <td class="paramname"><em>mtop</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, dimension(:,:), intent(out)&#160;</td>
          <td class="paramname"><em>mbot</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">plyr</td><td>(ix,nlay), model layer mean pressure in mb (100pa) </td></tr>
    <tr><td class="paramname">plvl</td><td>(ix,nlp1), model level pressure in mb (100pa) </td></tr>
    <tr><td class="paramname">tlyr</td><td>(ix,nlay), model layer mean temperature in K </td></tr>
    <tr><td class="paramname">tvly</td><td>(ix,nlay), model layer virtual temperature in K </td></tr>
    <tr><td class="paramname">qlyr</td><td>(ix,nlay), layer specific humidity in gm/gm </td></tr>
    <tr><td class="paramname">qstl</td><td>(ix,nlay), layer saturate humidity in gm/gm </td></tr>
    <tr><td class="paramname">rhly</td><td>(ix,nlay), layer relative humidity (=qlyr/qstl) </td></tr>
    <tr><td class="paramname">clw</td><td>(ix,nlay), layer cloud condensate amount </td></tr>
    <tr><td class="paramname">xlat</td><td>(ix), grid latitude in radians, default to pi/2 -&gt; -pi/2 range, otherwise see in-line comment </td></tr>
    <tr><td class="paramname">xlon</td><td>(ix), grid longitude in radians (not used) </td></tr>
    <tr><td class="paramname">slmsk</td><td>(ix), sea/land mask array (sea:0,land:1,sea-ice:2) </td></tr>
    <tr><td class="paramname">ix</td><td>horizontal dimention </td></tr>
    <tr><td class="paramname">nlay,nlp1</td><td>vertical layer/level dimensions </td></tr>
    <tr><td class="paramname">deltaq</td><td>(ix,nlay), half total water distribution width </td></tr>
    <tr><td class="paramname">sup</td><td>supersaturation </td></tr>
    <tr><td class="paramname">kdt</td><td></td></tr>
    <tr><td class="paramname">me</td><td>print control flag </td></tr>
    <tr><td class="paramname">clouds</td><td>(ix,nlay,nf_clds), cloud profiles <br />
 (:,:,1) - layer total cloud fraction <br />
 (:,:,2) - layer cloud liq water path (g/m**2) <br />
 (:,:,3) - mean eff radius for liq cloud (micron) <br />
 (:,:,4) - layer cloud ice water path (g/m**2) <br />
 (:,:,5) - mean eff radius for ice cloud (micron) <br />
 (:,:,6) - layer rain drop water path not assigned <br />
 (:,:,7) - mean eff radius for rain drop (micron) <br />
 (:,:,8) - layer snow flake water path not assigned <br />
 (:,:,9) - mean eff radius for snow flake(micron) </td></tr>
    <tr><td class="paramname">clds</td><td>(ix,5), fraction of clouds for low, mid, hi, tot, bl </td></tr>
    <tr><td class="paramname">mtop</td><td>(ix,3), vertical indices for low, mid, hi cloud tops </td></tr>
    <tr><td class="paramname">mbot</td><td>(ix,3), vertical indices for low, mid, hi cloud bases </td></tr>
  </table>
  </dd>
</dl>
<h1><a class="anchor" id="gen_progcld3"></a>
General Algorithm</h1>
<ol type="1">
<li>Find top pressure (ptopc) for each cloud domain for given latitude.</li>
<li>Calculate liquid/ice condensate path in \( g/m^2 \)</li>
<li>Calculate effective liquid cloud droplet radius over land.</li>
<li>Calculate layer cloud fraction.</li>
<li>Calculate effective ice cloud droplet radius following Heymsfield and McFarquhar (1996) <a class="el" href="citelist.html#CITEREF_heymsfield_and_mcfarquhar_1996">[28]</a>.</li>
<li>Call <a class="el" href="group__module__radiation__clouds.html#gac231d967afcfb252dedba82e9085b34d" title="This subroutine computes high, mid, low, total, and boundary cloud fractions and cloud top/bottom lay...">gethml()</a> to compute low,mid,high,total, and boundary layer cloud fractions and clouds top/bottom layer indices for low, mid, and high clouds. </li>
</ol>

<p class="definition">Definition at line <a class="el" href="radiation__clouds_8f_source.html#l01489">1489</a> of file <a class="el" href="radiation__clouds_8f_source.html">radiation_clouds.f</a>.</p>

<p class="reference">References <a class="el" href="radiation__clouds_8f_source.html#l03884">gethml()</a>, <a class="el" href="radiation__clouds_8f_source.html#l00258">nf_clds</a>, <a class="el" href="radiation__clouds_8f_source.html#l00263">ptopc</a>, <a class="el" href="radiation__clouds_8f_source.html#l00275">reice_def</a>, <a class="el" href="radiation__clouds_8f_source.html#l00273">reliq_def</a>, <a class="el" href="radiation__clouds_8f_source.html#l00277">rrain_def</a>, and <a class="el" href="radiation__clouds_8f_source.html#l00279">rsnow_def</a>.</p>

<p class="reference">Referenced by <a class="el" href="_g_f_s__radiation__driver_8_f90_source.html#l01015">module_radiation_driver::gfs_radiation_driver()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="group__module__radiation__clouds_gaeab51a06b22516fbfc78ab2c9eaf2622_cgraph.png" border="0" usemap="#group__module__radiation__clouds_gaeab51a06b22516fbfc78ab2c9eaf2622_cgraph" alt=""/></div>
<!-- MAP 4 -->
</div>

</div>
</div>
<a id="ga0c2a2c0d1abf49c1d6bbeb12d3223893"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga0c2a2c0d1abf49c1d6bbeb12d3223893">&#9670;&nbsp;</a></span>progcld5()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine, public module_radiation_clouds::progcld5 </td>
          <td>(</td>
          <td class="paramtype">real (kind=kind_phys), dimension(:,:), intent(in)&#160;</td>
          <td class="paramname"><em>plyr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real (kind=kind_phys), dimension(:,:), intent(in)&#160;</td>
          <td class="paramname"><em>plvl</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real (kind=kind_phys), dimension(:,:), intent(in)&#160;</td>
          <td class="paramname"><em>tlyr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real (kind=kind_phys), dimension(:,:), intent(in)&#160;</td>
          <td class="paramname"><em>qlyr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real (kind=kind_phys), dimension(:,:), intent(in)&#160;</td>
          <td class="paramname"><em>qstl</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real (kind=kind_phys), dimension(:,:), intent(in)&#160;</td>
          <td class="paramname"><em>rhly</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real (kind=kind_phys), dimension(:,:,:), intent(in)&#160;</td>
          <td class="paramname"><em>clw</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real (kind=kind_phys), dimension(:), intent(in)&#160;</td>
          <td class="paramname"><em>xlat</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real (kind=kind_phys), dimension(:), intent(in)&#160;</td>
          <td class="paramname"><em>xlon</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real (kind=kind_phys), dimension(:), intent(in)&#160;</td>
          <td class="paramname"><em>slmsk</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>ntrac</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>ntcw</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>ntiw</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>ntrw</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>ntsw</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>ntgl</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>IX</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>NLAY</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>NLP1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">logical, intent(in)&#160;</td>
          <td class="paramname"><em>uni_cld</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">logical, intent(in)&#160;</td>
          <td class="paramname"><em>lmfshal</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">logical, intent(in)&#160;</td>
          <td class="paramname"><em>lmfdeep2</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real (kind=kind_phys), dimension(:,:), intent(in)&#160;</td>
          <td class="paramname"><em>cldcov</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>re_cloud</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>re_ice</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>re_snow</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real (kind=kind_phys), dimension(:,:,:), intent(out)&#160;</td>
          <td class="paramname"><em>clouds</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real (kind=kind_phys), dimension(:,:), intent(out)&#160;</td>
          <td class="paramname"><em>clds</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, dimension(:,:), intent(out)&#160;</td>
          <td class="paramname"><em>mtop</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, dimension(:,:), intent(out)&#160;</td>
          <td class="paramname"><em>mbot</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<ol type="1">
<li>Find top pressure for each cloud domain for given latitude.</li>
<li>Compute cloud liquid/ice condensate path in \( g/m^2 \) .</li>
<li>Calculate layer cloud fraction.</li>
<li>Call <a class="el" href="group__module__radiation__clouds.html#gac231d967afcfb252dedba82e9085b34d" title="This subroutine computes high, mid, low, total, and boundary cloud fractions and cloud top/bottom lay...">gethml()</a> to compute low,mid,high,total, and boundary layer cloud fractions and clouds top/bottom layer indices for low, mid, and high clouds. </li>
</ol>

<p class="definition">Definition at line <a class="el" href="radiation__clouds_8f_source.html#l02464">2464</a> of file <a class="el" href="radiation__clouds_8f_source.html">radiation_clouds.f</a>.</p>

<p class="reference">References <a class="el" href="radiation__clouds_8f_source.html#l03884">gethml()</a>, <a class="el" href="radiation__clouds_8f_source.html#l00258">nf_clds</a>, <a class="el" href="radiation__clouds_8f_source.html#l00263">ptopc</a>, and <a class="el" href="radiation__clouds_8f_source.html#l00277">rrain_def</a>.</p>

<p class="reference">Referenced by <a class="el" href="_g_f_s__radiation__driver_8_f90_source.html#l01015">module_radiation_driver::gfs_radiation_driver()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="group__module__radiation__clouds_ga0c2a2c0d1abf49c1d6bbeb12d3223893_cgraph.png" border="0" usemap="#group__module__radiation__clouds_ga0c2a2c0d1abf49c1d6bbeb12d3223893_cgraph" alt=""/></div>
<!-- MAP 5 -->
</div>

</div>
</div>
<a id="gaa369e2e2910b3468614db856b378f3ba"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gaa369e2e2910b3468614db856b378f3ba">&#9670;&nbsp;</a></span>progclduni()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine, public module_radiation_clouds::progclduni </td>
          <td>(</td>
          <td class="paramtype">real (kind=kind_phys), dimension(:,:), intent(in)&#160;</td>
          <td class="paramname"><em>plyr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real (kind=kind_phys), dimension(:,:), intent(in)&#160;</td>
          <td class="paramname"><em>plvl</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real (kind=kind_phys), dimension(:,:), intent(in)&#160;</td>
          <td class="paramname"><em>tlyr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real (kind=kind_phys), dimension(:,:), intent(in)&#160;</td>
          <td class="paramname"><em>tvly</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real (kind=kind_phys), dimension(:,:,:), intent(in)&#160;</td>
          <td class="paramname"><em>ccnd</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>ncnd</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real (kind=kind_phys), dimension(:), intent(in)&#160;</td>
          <td class="paramname"><em>xlat</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real (kind=kind_phys), dimension(:), intent(in)&#160;</td>
          <td class="paramname"><em>xlon</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real (kind=kind_phys), dimension(:), intent(in)&#160;</td>
          <td class="paramname"><em>slmsk</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>IX</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>NLAY</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>NLP1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real (kind=kind_phys), dimension(:,:), intent(in)&#160;</td>
          <td class="paramname"><em>cldtot</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real (kind=kind_phys), dimension(:,:), intent(in)&#160;</td>
          <td class="paramname"><em>effrl</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real (kind=kind_phys), dimension(:,:), intent(in)&#160;</td>
          <td class="paramname"><em>effri</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real (kind=kind_phys), dimension(:,:), intent(in)&#160;</td>
          <td class="paramname"><em>effrr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real (kind=kind_phys), dimension(:,:), intent(in)&#160;</td>
          <td class="paramname"><em>effrs</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">logical, intent(in)&#160;</td>
          <td class="paramname"><em>effr_in</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real (kind=kind_phys), dimension(:,:,:), intent(out)&#160;</td>
          <td class="paramname"><em>clouds</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real (kind=kind_phys), dimension(:,:), intent(out)&#160;</td>
          <td class="paramname"><em>clds</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, dimension(:,:), intent(out)&#160;</td>
          <td class="paramname"><em>mtop</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, dimension(:,:), intent(out)&#160;</td>
          <td class="paramname"><em>mbot</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">plyr</td><td>(IX,NLAY), model layer mean pressure in mb (100Pa) </td></tr>
    <tr><td class="paramname">plvl</td><td>(IX,NLP1), model level pressure in mb (100Pa) </td></tr>
    <tr><td class="paramname">tlyr</td><td>(IX,NLAY), model layer mean temperature in K </td></tr>
    <tr><td class="paramname">tvly</td><td>(IX,NLAY), model layer virtual temperature in K </td></tr>
    <tr><td class="paramname">qlyr</td><td>(IX,NLAY), layer specific humidity in gm/gm </td></tr>
    <tr><td class="paramname">clw</td><td>(IX,NLAY), layer cloud liquid water amount </td></tr>
    <tr><td class="paramname">ciw</td><td>(IX,NLAY), layer cloud ice water amount </td></tr>
    <tr><td class="paramname">xlat</td><td>(IX), grid latitude in radians, default to pi/2 -&gt; -pi/2 range, otherwise see in-line comment </td></tr>
    <tr><td class="paramname">xlon</td><td>(IX), grid longitude in radians (not used) </td></tr>
    <tr><td class="paramname">slmsk</td><td>(IX), sea/land mask array (sea:0,land:1,sea-ice:2) </td></tr>
    <tr><td class="paramname">IX</td><td>horizontal dimention </td></tr>
    <tr><td class="paramname">NLAY,NLP1</td><td>vertical layer/level dimensions </td></tr>
    <tr><td class="paramname">clouds</td><td>(IX,NLAY,NF_CLDS), cloud profiles <br />
 (:,:,1) - layer total cloud fraction <br />
 (:,:,2) - layer cloud liq water path \((g/m^2)\) <br />
 (:,:,3) - mean eff radius for liq cloud (micron) <br />
 (:,:,4) - layer cloud ice water path \((g/m^2)\) <br />
 (:,:,5) - mean eff radius for ice cloud (micron) <br />
 (:,:,6) - layer rain drop water path (not assigned) <br />
 (:,:,7) - mean eff radius for rain drop (micron) <br />
 (:,:,8) - layer snow flake water path (not assigned) <br />
 (:,:,9) - mean eff radius for snow flake (micron) <br />
 *** fu's scheme need to be normalized by snow density \( (g/m^3/1.0e6)\) </td></tr>
    <tr><td class="paramname">clds</td><td>(IX,5), fraction of clouds for low, mid, hi, tot, bl </td></tr>
    <tr><td class="paramname">mtop</td><td>(IX,3), vertical indices for low, mid, hi cloud tops </td></tr>
    <tr><td class="paramname">mbot</td><td>(IX,3), vertical indices for low, mid, hi cloud bases </td></tr>
  </table>
  </dd>
</dl>
<h1><a class="anchor" id="gen_progclduni"></a>
General Algorithm</h1>
<ol type="1">
<li>Find top pressure for each cloud domain for given latitude.</li>
<li>Compute cloud liquid/ice condensate path in \( g/m^2 \) .</li>
<li>Compute effective liquid cloud droplet radius over land.</li>
<li>Compute effective ice cloud droplet radius following Heymsfield and McFarquhar (1996) <a class="el" href="citelist.html#CITEREF_heymsfield_and_mcfarquhar_1996">[28]</a>.</li>
<li>Call <a class="el" href="group__module__radiation__clouds.html#gac231d967afcfb252dedba82e9085b34d" title="This subroutine computes high, mid, low, total, and boundary cloud fractions and cloud top/bottom lay...">gethml()</a> to compute low,mid,high,total, and boundary layer cloud fractions and clouds top/bottom layer indices for low, mid, and high clouds. </li>
</ol>

<p class="definition">Definition at line <a class="el" href="radiation__clouds_8f_source.html#l02893">2893</a> of file <a class="el" href="radiation__clouds_8f_source.html">radiation_clouds.f</a>.</p>

<p class="reference">References <a class="el" href="radiation__clouds_8f_source.html#l03884">gethml()</a>, <a class="el" href="radiation__clouds_8f_source.html#l00258">nf_clds</a>, <a class="el" href="radiation__clouds_8f_source.html#l00263">ptopc</a>, <a class="el" href="radiation__clouds_8f_source.html#l00275">reice_def</a>, <a class="el" href="radiation__clouds_8f_source.html#l00273">reliq_def</a>, <a class="el" href="radiation__clouds_8f_source.html#l00277">rrain_def</a>, and <a class="el" href="radiation__clouds_8f_source.html#l00279">rsnow_def</a>.</p>

<p class="reference">Referenced by <a class="el" href="_g_f_s__radiation__driver_8_f90_source.html#l01015">module_radiation_driver::gfs_radiation_driver()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="group__module__radiation__clouds_gaa369e2e2910b3468614db856b378f3ba_cgraph.png" border="0" usemap="#group__module__radiation__clouds_gaa369e2e2910b3468614db856b378f3ba_cgraph" alt=""/></div>
<!-- MAP 6 -->
</div>

</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">Generated by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.13 </li>
  </ul>
</div>
</body>
</html>

<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.13"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Interoperable Physics Driver for NGGPS: module_radiation_driver</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { init_search(); });
</script>
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    extensions: ["tex2jax.js"],
    jax: ["input/TeX","output/HTML-CSS"],
});
</script><script type="text/javascript" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="ncep.jpg"/></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Interoperable Physics Driver for NGGPS
   </div>
  </td>
   <td>        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
</td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.13 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('group__module__radiation__driver.html','');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#namespaces">Modules</a>  </div>
  <div class="headertitle">
<div class="title">module_radiation_driver<div class="ingroups"><a class="el" href="group___r_r_t_m_g.html">RRTMG Shortwave/Longwave Radiation Scheme</a></div></div>  </div>
</div><!--header-->
<div class="contents">

<p>The GFS radiation driver module.  
<a href="#details">More...</a></p>
<div class="dynheader">
Collaboration diagram for module_radiation_driver:</div>
<div class="dyncontent">
<center><table><tr><td><img src="group__module__radiation__driver.png" border="0" alt="" usemap="#group____module____radiation____driver"/>
<!-- MAP 0 -->
</td></tr></table></center>
</div>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="namespaces"></a>
Modules</h2></td></tr>
<tr class="memitem:namespacemodule__radiation__driver"><td class="memItemLeft" align="right" valign="top">module &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacemodule__radiation__driver.html">module_radiation_driver</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="member-group"></a>
Constant values</h2></td></tr>
<tr class="memitem:gafdc2a7e1dbfb075ac33a2388564d9428"><td class="memItemLeft" align="right" valign="top">real(kind=kind_phys)&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__module__radiation__driver.html#gafdc2a7e1dbfb075ac33a2388564d9428">module_radiation_driver::qmin</a></td></tr>
<tr class="memdesc:gafdc2a7e1dbfb075ac33a2388564d9428"><td class="mdescLeft">&#160;</td><td class="mdescRight">lower limit of saturation vapor pressure (=1.0e-10)  <a href="group__module__radiation__driver.html#gafdc2a7e1dbfb075ac33a2388564d9428">More...</a><br /></td></tr>
<tr class="separator:gafdc2a7e1dbfb075ac33a2388564d9428"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gab671cb80142c71dab5f41f01ccdcc088"><td class="memItemLeft" align="right" valign="top">real(kind=kind_phys)&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__module__radiation__driver.html#gab671cb80142c71dab5f41f01ccdcc088">module_radiation_driver::qme5</a></td></tr>
<tr class="memdesc:gab671cb80142c71dab5f41f01ccdcc088"><td class="mdescLeft">&#160;</td><td class="mdescRight">lower limit of specific humidity (=1.0e-7)  <a href="group__module__radiation__driver.html#gab671cb80142c71dab5f41f01ccdcc088">More...</a><br /></td></tr>
<tr class="separator:gab671cb80142c71dab5f41f01ccdcc088"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga4916e37c472b2f824b6f566ff67200cd"><td class="memItemLeft" align="right" valign="top">real(kind=kind_phys)&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__module__radiation__driver.html#ga4916e37c472b2f824b6f566ff67200cd">module_radiation_driver::qme6</a></td></tr>
<tr class="memdesc:ga4916e37c472b2f824b6f566ff67200cd"><td class="mdescLeft">&#160;</td><td class="mdescRight">lower limit of specific humidity (=1.0e-7)  <a href="group__module__radiation__driver.html#ga4916e37c472b2f824b6f566ff67200cd">More...</a><br /></td></tr>
<tr class="separator:ga4916e37c472b2f824b6f566ff67200cd"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga0b0bf0fa8723b80d0891ec3327d187d7"><td class="memItemLeft" align="right" valign="top">real(kind=kind_phys)&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__module__radiation__driver.html#ga0b0bf0fa8723b80d0891ec3327d187d7">module_radiation_driver::epsq</a></td></tr>
<tr class="memdesc:ga0b0bf0fa8723b80d0891ec3327d187d7"><td class="mdescLeft">&#160;</td><td class="mdescRight">EPSQ=1.0e-12.  <a href="group__module__radiation__driver.html#ga0b0bf0fa8723b80d0891ec3327d187d7">More...</a><br /></td></tr>
<tr class="separator:ga0b0bf0fa8723b80d0891ec3327d187d7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga3fc43ca0d2c5f69a380ddb4f0926ecc7"><td class="memItemLeft" align="right" valign="top">real, parameter&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__module__radiation__driver.html#ga3fc43ca0d2c5f69a380ddb4f0926ecc7">module_radiation_driver::prsmin</a> = 1.0e-6</td></tr>
<tr class="memdesc:ga3fc43ca0d2c5f69a380ddb4f0926ecc7"><td class="mdescLeft">&#160;</td><td class="mdescRight">lower limit of toa pressure value in mb  <a href="group__module__radiation__driver.html#ga3fc43ca0d2c5f69a380ddb4f0926ecc7">More...</a><br /></td></tr>
<tr class="separator:ga3fc43ca0d2c5f69a380ddb4f0926ecc7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga9ee6a89464bf206cc07ea30d7eeaaeb8"><td class="memItemLeft" align="right" valign="top">integer&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__module__radiation__driver.html#ga9ee6a89464bf206cc07ea30d7eeaaeb8">module_radiation_driver::itsfc</a> =0</td></tr>
<tr class="memdesc:ga9ee6a89464bf206cc07ea30d7eeaaeb8"><td class="mdescLeft">&#160;</td><td class="mdescRight">control flag for LW surface temperature at air/ground interface (default=0, the value will be set in subroutine radinit)  <a href="group__module__radiation__driver.html#ga9ee6a89464bf206cc07ea30d7eeaaeb8">More...</a><br /></td></tr>
<tr class="separator:ga9ee6a89464bf206cc07ea30d7eeaaeb8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga6eb268f296c77047f389ed6fac5f95be"><td class="memItemLeft" align="right" valign="top">integer&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__module__radiation__driver.html#ga6eb268f296c77047f389ed6fac5f95be">module_radiation_driver::month0</a> =0</td></tr>
<tr class="memdesc:ga6eb268f296c77047f389ed6fac5f95be"><td class="mdescLeft">&#160;</td><td class="mdescRight">new data input control variables (set/reset in subroutines radinit/radupdate):  <a href="group__module__radiation__driver.html#ga6eb268f296c77047f389ed6fac5f95be">More...</a><br /></td></tr>
<tr class="separator:ga6eb268f296c77047f389ed6fac5f95be"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga4d755de48d0aa83f337a2a907ac7d8a2"><td class="memItemLeft" align="right" valign="top">integer&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__module__radiation__driver.html#ga4d755de48d0aa83f337a2a907ac7d8a2">module_radiation_driver::iyear0</a> =0</td></tr>
<tr class="separator:ga4d755de48d0aa83f337a2a907ac7d8a2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gac4baf8ff048aaa5b85d03cc42c579c7b"><td class="memItemLeft" align="right" valign="top">integer&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__module__radiation__driver.html#gac4baf8ff048aaa5b85d03cc42c579c7b">module_radiation_driver::monthd</a> =0</td></tr>
<tr class="separator:gac4baf8ff048aaa5b85d03cc42c579c7b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gaf6e0e1ef2ebb78f57c897ebaf633edd2"><td class="memItemLeft" align="right" valign="top">logical&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__module__radiation__driver.html#gaf6e0e1ef2ebb78f57c897ebaf633edd2">module_radiation_driver::loz1st</a> =.true.</td></tr>
<tr class="memdesc:gaf6e0e1ef2ebb78f57c897ebaf633edd2"><td class="mdescLeft">&#160;</td><td class="mdescRight">control flag for the first time of reading climatological ozone data (set/reset in subroutines radinit/radupdate, it is used only if the control parameter ioznflg=0)  <a href="group__module__radiation__driver.html#gaf6e0e1ef2ebb78f57c897ebaf633edd2">More...</a><br /></td></tr>
<tr class="separator:gaf6e0e1ef2ebb78f57c897ebaf633edd2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gaab2535e9906afd709124056f4ca1e470"><td class="memItemLeft" align="right" valign="top">integer, parameter&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__module__radiation__driver.html#gaab2535e9906afd709124056f4ca1e470">module_radiation_driver::ltp</a> = 0</td></tr>
<tr class="memdesc:gaab2535e9906afd709124056f4ca1e470"><td class="mdescLeft">&#160;</td><td class="mdescRight">optional extra top layer on top of low ceiling models <br />
 LTP=0: no extra top layer  <a href="group__module__radiation__driver.html#gaab2535e9906afd709124056f4ca1e470">More...</a><br /></td></tr>
<tr class="separator:gaab2535e9906afd709124056f4ca1e470"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gad27b36d0186c8147fe839eb5c268d157"><td class="memItemLeft" align="right" valign="top">logical, parameter&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__module__radiation__driver.html#gad27b36d0186c8147fe839eb5c268d157">module_radiation_driver::lextop</a> = (LTP &gt; 0)</td></tr>
<tr class="memdesc:gad27b36d0186c8147fe839eb5c268d157"><td class="mdescLeft">&#160;</td><td class="mdescRight">control flag for extra top layer  <a href="group__module__radiation__driver.html#gad27b36d0186c8147fe839eb5c268d157">More...</a><br /></td></tr>
<tr class="separator:gad27b36d0186c8147fe839eb5c268d157"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga3d4ef1d77b7d7ef09fafcb4413e1cbf2"><td class="memItemLeft" align="right" valign="top">subroutine, public&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__module__radiation__driver.html#ga3d4ef1d77b7d7ef09fafcb4413e1cbf2">module_radiation_driver::radinit</a> (si, NLAY, imp_physics, me)</td></tr>
<tr class="memdesc:ga3d4ef1d77b7d7ef09fafcb4413e1cbf2"><td class="mdescLeft">&#160;</td><td class="mdescRight">This subroutine initialize a model's radiation process through calling of specific initialization subprograms that directly related to radiation calculations. This subroutine needs to be invoked only once at the start stage of a model's run, and the call is placed outside of both the time advancement loop and horizontal grid loop.  <a href="group__module__radiation__driver.html#ga3d4ef1d77b7d7ef09fafcb4413e1cbf2">More...</a><br /></td></tr>
<tr class="separator:ga3d4ef1d77b7d7ef09fafcb4413e1cbf2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga28280ee9ea8ee0d183ab9d541a31b718"><td class="memItemLeft" align="right" valign="top">subroutine, public&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__module__radiation__driver.html#ga28280ee9ea8ee0d183ab9d541a31b718">module_radiation_driver::radupdate</a> (idate, jdate, deltsw, deltim, lsswr, me, slag, sdec, cdec, solcon)</td></tr>
<tr class="memdesc:ga28280ee9ea8ee0d183ab9d541a31b718"><td class="mdescLeft">&#160;</td><td class="mdescRight">This subroutine checks and updates time sensitive data used by radiation computations. This subroutine needs to be placed inside the time advancement loop but outside of the horizontal grid loop. It is invoked at radiation calling frequncy but before any actual radiative transfer computations.  <a href="group__module__radiation__driver.html#ga28280ee9ea8ee0d183ab9d541a31b718">More...</a><br /></td></tr>
<tr class="separator:ga28280ee9ea8ee0d183ab9d541a31b718"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga9c5872d3bd177315e79977d40245a99a"><td class="memItemLeft" align="right" valign="top">subroutine, public&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__module__radiation__driver.html#ga9c5872d3bd177315e79977d40245a99a">module_radiation_driver::gfs_radiation_driver</a> (Model, Statein, Stateout, Sfcprop, Coupling, Grid, Tbd, Cldprop, Radtend, Diag)</td></tr>
<tr class="memdesc:ga9c5872d3bd177315e79977d40245a99a"><td class="mdescLeft">&#160;</td><td class="mdescRight">This subroutine is the driver of main radiation calculations. It sets up column profiles, such as pressure, temperature, moisture, gases, clouds, aerosols, etc., as well as surface radiative characteristics, such as surface albedo, and emissivity. The call of this subroutine is placed inside both the time advancing loop and the horizontal grid loop.  <a href="group__module__radiation__driver.html#ga9c5872d3bd177315e79977d40245a99a">More...</a><br /></td></tr>
<tr class="separator:ga9c5872d3bd177315e79977d40245a99a"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<p>The GFS radiation driver module. </p>
<p><a class="el" href="namespacemodule__radiation__driver.html">module_radiation_driver</a> prepares the atmospheric profile, invokes the main radiation calculations, and computes radiative fluxes and heating rates for some arbitrary number of vertical columns. This module also regulates the logistic running flow of the computations, such as data initialization and update accordance with forecast timing progress, the sequential order of subroutine calls, and sorting results for final output. There are three externally accessible subroutines:</p><ul>
<li><a class="el" href="group__module__radiation__driver.html#ga3d4ef1d77b7d7ef09fafcb4413e1cbf2" title="This subroutine initialize a model&#39;s radiation process through calling of specific initialization sub...">radinit()</a>: the initialization subroutine of radiation calculations It is invoked by the model's initialization process and is independent with forecat time progress.</li>
<li><a class="el" href="group__module__radiation__driver.html#ga28280ee9ea8ee0d183ab9d541a31b718" title="This subroutine checks and updates time sensitive data used by radiation computations. This subroutine needs to be placed inside the time advancement loop but outside of the horizontal grid loop. It is invoked at radiation calling frequncy but before any actual radiative transfer computations. ">radupdate()</a>: calls many update subroutines to check and update radiation required but time varying data sets and module variables. It is placed inside a model's time advancing loop.</li>
<li>grrad(): the driver of radiation calculation subroutines. It sets up profile variables for radiation input, including clouds, surface albedos, atmospheric aerosols, ozone, etc. It is located inside the timing loop, and control the sequence of the radiative process calculations. <dl class="section version"><dt>Version</dt><dd>NCEP-Radiation_driver v5.2 Jan 2013 </dd></dl>
</li>
</ul>
<h2 class="groupheader">Function/Subroutine Documentation</h2>
<a id="ga3d4ef1d77b7d7ef09fafcb4413e1cbf2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga3d4ef1d77b7d7ef09fafcb4413e1cbf2">&#9670;&nbsp;</a></span>radinit()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine, public module_radiation_driver::radinit </td>
          <td>(</td>
          <td class="paramtype">real (kind=kind_phys), dimension(:), intent(in)&#160;</td>
          <td class="paramname"><em>si</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>NLAY</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>imp_physics</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>me</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>This subroutine initialize a model's radiation process through calling of specific initialization subprograms that directly related to radiation calculations. This subroutine needs to be invoked only once at the start stage of a model's run, and the call is placed outside of both the time advancement loop and horizontal grid loop. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">si</td><td>model vertical sigma interface </td></tr>
    <tr><td class="paramname">nlay</td><td>number of model vertical layers </td></tr>
    <tr><td class="paramname">me</td><td>print control flag </td></tr>
  </table>
  </dd>
</dl>
<h1><a class="anchor" id="gen_radinit"></a>
General Algorithm</h1>
<ol type="1">
<li>Set up control variables and external module variables in module physparam</li>
<li>Initialization</li>
</ol>
<ul>
<li>astronomy initialization routine: call module_radiation_astronomy::sol_init()</li>
<li>aerosols initialization routine: call module_radiation_aerosols::aer_init()</li>
<li>CO2 and other gases intialization routine: call module_radiation_gases::gas_init()</li>
<li>surface intialization routine: call module_radiation_surface::sfc_init()</li>
<li>cloud initialization routine: call module_radiation_clouds::cld_init()</li>
<li>LW radiation initialization routine: call module_radlw_main::rlwinit()</li>
<li>SW radiation initialization routine: call module_radsw_main::rswinit() </li>
</ul>

<p class="definition">Definition at line <a class="el" href="_g_f_s__radiation__driver_8_f90_source.html#l00417">417</a> of file <a class="el" href="_g_f_s__radiation__driver_8_f90_source.html">GFS_radiation_driver.F90</a>.</p>

<p class="reference">References <a class="el" href="_g_f_s__radiation__driver_8_f90_source.html#l00377">itsfc</a>, <a class="el" href="_g_f_s__radiation__driver_8_f90_source.html#l00380">iyear0</a>, <a class="el" href="_g_f_s__radiation__driver_8_f90_source.html#l00393">lextop</a>, <a class="el" href="_g_f_s__radiation__driver_8_f90_source.html#l00385">loz1st</a>, <a class="el" href="_g_f_s__radiation__driver_8_f90_source.html#l00389">ltp</a>, <a class="el" href="_g_f_s__radiation__driver_8_f90_source.html#l00380">month0</a>, <a class="el" href="_g_f_s__radiation__driver_8_f90_source.html#l00380">monthd</a>, and <a class="el" href="_g_f_s__radiation__driver_8_f90_source.html#l00353">vtagrad</a>.</p>

</div>
</div>
<a id="ga28280ee9ea8ee0d183ab9d541a31b718"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga28280ee9ea8ee0d183ab9d541a31b718">&#9670;&nbsp;</a></span>radupdate()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine, public module_radiation_driver::radupdate </td>
          <td>(</td>
          <td class="paramtype">integer, dimension(:), intent(in)&#160;</td>
          <td class="paramname"><em>idate</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, dimension(:), intent(in)&#160;</td>
          <td class="paramname"><em>jdate</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real (kind=kind_phys), intent(in)&#160;</td>
          <td class="paramname"><em>deltsw</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real (kind=kind_phys), intent(in)&#160;</td>
          <td class="paramname"><em>deltim</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">logical, intent(in)&#160;</td>
          <td class="paramname"><em>lsswr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>me</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real (kind=kind_phys), intent(out)&#160;</td>
          <td class="paramname"><em>slag</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real (kind=kind_phys), intent(out)&#160;</td>
          <td class="paramname"><em>sdec</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real (kind=kind_phys), intent(out)&#160;</td>
          <td class="paramname"><em>cdec</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real (kind=kind_phys), intent(out)&#160;</td>
          <td class="paramname"><em>solcon</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>This subroutine checks and updates time sensitive data used by radiation computations. This subroutine needs to be placed inside the time advancement loop but outside of the horizontal grid loop. It is invoked at radiation calling frequncy but before any actual radiative transfer computations. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">idate</td><td>NCEP absolute date and time of intial condition (year,month,day,time-zone,hour,minute,second, mil-second) </td></tr>
    <tr><td class="paramname">jdate</td><td>NCEP absolute date and time at forecast time (year,month,day,time-zone,hour,minute,second, mil-second) </td></tr>
    <tr><td class="paramname">deltsw</td><td>SW radiation calling time interval in seconds </td></tr>
    <tr><td class="paramname">deltim</td><td>model advancing time-step duration in seconds </td></tr>
    <tr><td class="paramname">lsswr</td><td>logical control flag for SW radiation calculations </td></tr>
    <tr><td class="paramname">me</td><td>print control flag </td></tr>
    <tr><td class="paramname">slag</td><td>equation of time in radians </td></tr>
    <tr><td class="paramname">sdec,cdec</td><td>sine and cosine of the solar declination angle </td></tr>
    <tr><td class="paramname">solcon</td><td>solar constant adjusted by sun-earth distance \((W/m^2)\) </td></tr>
  </table>
  </dd>
</dl>
<h1><a class="anchor" id="gen_radupdate"></a>
General Algorithm</h1>
<ol type="1">
<li>Set up time stamp at fcst time and that for green house gases (currently co2 only)</li>
<li>Call module_radiation_astronomy::sol_update(), yearly update, no time interpolation.</li>
<li>Call module_radiation_aerosols::aer_update(), monthly update, no time interpolation</li>
<li>Call co2 and other gases update routine: module_radiation_gases::gas_update()</li>
<li>Call surface update routine (currently not needed)</li>
<li>Call clouds update routine (currently not needed) </li>
</ol>

<p class="definition">Definition at line <a class="el" href="_g_f_s__radiation__driver_8_f90_source.html#l00667">667</a> of file <a class="el" href="_g_f_s__radiation__driver_8_f90_source.html">GFS_radiation_driver.F90</a>.</p>

<p class="reference">References <a class="el" href="_g_f_s__radiation__driver_8_f90_source.html#l00380">iyear0</a>, <a class="el" href="_g_f_s__radiation__driver_8_f90_source.html#l00385">loz1st</a>, <a class="el" href="_g_f_s__radiation__driver_8_f90_source.html#l00380">month0</a>, and <a class="el" href="_g_f_s__radiation__driver_8_f90_source.html#l00380">monthd</a>.</p>

<p class="reference">Referenced by <a class="el" href="_g_f_s__driver_8_f90_source.html#l00518">gfs_driver::gfs_rad_time_vary()</a>.</p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="group__module__radiation__driver_ga28280ee9ea8ee0d183ab9d541a31b718_icgraph.png" border="0" usemap="#group__module__radiation__driver_ga28280ee9ea8ee0d183ab9d541a31b718_icgraph" alt=""/></div>
<!-- MAP 1 -->
</div>

</div>
</div>
<a id="ga9c5872d3bd177315e79977d40245a99a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga9c5872d3bd177315e79977d40245a99a">&#9670;&nbsp;</a></span>gfs_radiation_driver()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine, public module_radiation_driver::gfs_radiation_driver </td>
          <td>(</td>
          <td class="paramtype">type(gfs_control_type), intent(in)&#160;</td>
          <td class="paramname"><em>Model</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(gfs_statein_type), intent(in)&#160;</td>
          <td class="paramname"><em>Statein</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(gfs_stateout_type), intent(inout)&#160;</td>
          <td class="paramname"><em>Stateout</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(gfs_sfcprop_type), intent(in)&#160;</td>
          <td class="paramname"><em>Sfcprop</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(gfs_coupling_type), intent(inout)&#160;</td>
          <td class="paramname"><em>Coupling</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(gfs_grid_type), intent(in)&#160;</td>
          <td class="paramname"><em>Grid</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(gfs_tbd_type), intent(in)&#160;</td>
          <td class="paramname"><em>Tbd</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(gfs_cldprop_type), intent(in)&#160;</td>
          <td class="paramname"><em>Cldprop</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(gfs_radtend_type), intent(inout)&#160;</td>
          <td class="paramname"><em>Radtend</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(gfs_diag_type), intent(inout)&#160;</td>
          <td class="paramname"><em>Diag</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>This subroutine is the driver of main radiation calculations. It sets up column profiles, such as pressure, temperature, moisture, gases, clouds, aerosols, etc., as well as surface radiative characteristics, such as surface albedo, and emissivity. The call of this subroutine is placed inside both the time advancing loop and the horizontal grid loop. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">prsi</td><td>model level pressure in Pa </td></tr>
    <tr><td class="paramname">prsl</td><td>model layer mean pressure in Pa </td></tr>
    <tr><td class="paramname">prslk</td><td>exner function = \( (p/p0)^{rocp} \) </td></tr>
    <tr><td class="paramname">tgrs</td><td>model layer mean temperature in K </td></tr>
    <tr><td class="paramname">qgrs</td><td>layer specific humidity in gm/gm </td></tr>
    <tr><td class="paramname">tracer</td><td>layer prognostic tracer amount mixing-ratio, including: ozone,cloud condensate,aerosols,etc </td></tr>
    <tr><td class="paramname">vvl</td><td>layer mean vertical velocity in pa/sec (used only for the legacy diagnostic style of cloud scheme) </td></tr>
    <tr><td class="paramname">slmsk</td><td>sea/land mask array (sea:0,land:1,sea-ice:2) </td></tr>
    <tr><td class="paramname">xlon</td><td>grid longitude in radians,ok for both 0-&gt;2pi or -pi-&gt;+pi ranges </td></tr>
    <tr><td class="paramname">xlat</td><td>grid latitude in radians, default to pi/2-&gt;-pi/2 range, otherwise need to adjust in the called subroutine </td></tr>
    <tr><td class="paramname">tsfc</td><td>surface temperature in K </td></tr>
    <tr><td class="paramname">snowd</td><td>snow depth water equivalent in mm (used when control flag ialbflg=1) </td></tr>
    <tr><td class="paramname">sncovr</td><td>snow cover in fraction (used when contrl flag ialbflg=1) </td></tr>
    <tr><td class="paramname">snoalb</td><td>maximum snow albedo in fraction (used when control flag ialbflg=1) </td></tr>
    <tr><td class="paramname">zorl</td><td>surface roughness in cm </td></tr>
    <tr><td class="paramname">hprim</td><td>topographic standard deviation in m </td></tr>
    <tr><td class="paramname">alvsf</td><td>ialbflg=0: uv+visible albedo with strong cosz dependency (z=60) <br />
 ialbflg=1: uv+visible black sky albedo (z=60 degree) </td></tr>
    <tr><td class="paramname">alnsf</td><td>ialbflg=0: near IR albedo with strong cosz dependency (z=60) <br />
 ialbflg=1: near IR black sky albedo (z=60 degree) </td></tr>
    <tr><td class="paramname">alvwf</td><td>ialbflg=0: uv+visible albedo with weak cosz dependency (z=60) <br />
 ialbflg=1: uv+visible white sky albedo </td></tr>
    <tr><td class="paramname">alnwf</td><td>ialbflg=0: near IR albedo with weak cosz dependency (z=60) <br />
 ialbflg=1: near IR white sky albedo </td></tr>
    <tr><td class="paramname">facsf</td><td>fractional coverage with strong cosz dependency </td></tr>
    <tr><td class="paramname">facwf</td><td>fractional coverage with weak cosz dependency </td></tr>
    <tr><td class="paramname">fice</td><td>fraction ice cover over open water grid </td></tr>
    <tr><td class="paramname">tisfc</td><td>surface temperature over ice cover in K </td></tr>
    <tr><td class="paramname">sinlat</td><td>sine of latitude for the model grid </td></tr>
    <tr><td class="paramname">coslat</td><td>cosine of latitude for the model grid </td></tr>
    <tr><td class="paramname">solhr</td><td>hour time after 00z at the current time-step </td></tr>
    <tr><td class="paramname">jdate</td><td>current forecast date and time (year, month, day,time-zone,hour, minute, second, mil-second) </td></tr>
    <tr><td class="paramname">solcon</td><td>solar constant (sun-earth distant adjusted) in \(W/m^2\) </td></tr>
    <tr><td class="paramname">cv</td><td>fraction of convective cloud cover (for diagnostic clouds only) </td></tr>
    <tr><td class="paramname">cvt,cvb</td><td>convective cloud top/bottom pressure in pa (for diagnostic clouds only) </td></tr>
    <tr><td class="paramname">fcice</td><td>fraction of cloud ice content (for Ferrier microphysics scheme only) </td></tr>
    <tr><td class="paramname">frain</td><td>fraction of rain water (for Ferrier microphysics scheme only) </td></tr>
    <tr><td class="paramname">rrime</td><td>mass ratio of total to unrimed ice content (&gt;= 1, for Ferrier microphysics scheme only) </td></tr>
    <tr><td class="paramname">flgmin</td><td>minimum large ice fraction (for Ferrier microphysics scheme only) </td></tr>
    <tr><td class="paramname">icsdsw,icsdlw</td><td>auxiliary cloud control arrays for radiations if isubcsw/isubclw (physparam) are set to 2, the arrays contains random seeds for the sub-column cloud overlap scheme, McICA, used in SW/LW radiations </td></tr>
    <tr><td class="paramname">ntcw</td><td>=0: no cloud condensate calculated; <br />
 &gt;0: tracer array location index for cloud condensate </td></tr>
    <tr><td class="paramname">ncld</td><td>only used when ntcw&gt;0 </td></tr>
    <tr><td class="paramname">ntoz</td><td>=0: use climatological ozone profile <br />
 &gt;0: use interactive ozone profile </td></tr>
    <tr><td class="paramname">NTRAC</td><td>number of tracers </td></tr>
    <tr><td class="paramname">NFXR</td><td>number of fields (second dimension) of I/O array fluxr </td></tr>
    <tr><td class="paramname">dtlw,dtsw</td><td>time durations for LW/SW radiation calls in second </td></tr>
    <tr><td class="paramname">lsswr,lslwr</td><td>logical control flags for SW/LW radiation calls </td></tr>
    <tr><td class="paramname">lssav</td><td>logical control flag for storing 3-d cloud field </td></tr>
    <tr><td class="paramname">IX,IM</td><td>horizontal dimension and number of used points </td></tr>
    <tr><td class="paramname">LM</td><td>vertical layer dimension </td></tr>
    <tr><td class="paramname">me</td><td>control flag for parallel process </td></tr>
    <tr><td class="paramname">lprnt</td><td>control flag for diagnostic printout </td></tr>
    <tr><td class="paramname">ipt</td><td>grid-point index for diagnostic printout (debugging) </td></tr>
    <tr><td class="paramname">kdt</td><td>time-step sequential number </td></tr>
    <tr><td class="paramname">deltaq</td><td>half width of pdf cloud uniform total water distribution (for pdf cloud cover scheme) </td></tr>
    <tr><td class="paramname">sup</td><td>supersaturation in pdf cloud when t is very low (for pdf cloud cover scheme) </td></tr>
    <tr><td class="paramname">cnvw</td><td>layer convective cloud water content (for pdf cloud scheme) </td></tr>
    <tr><td class="paramname">cnvc</td><td>layer convective cloud cover (for pdf cloud scheme) </td></tr>
    <tr><td class="paramname">htrsw</td><td>total sky SW heating rate in k/sec </td></tr>
    <tr><td class="paramname">topfsw</td><td>derived type, SW radiation fluxes at TOA, components: (check module_radsw_parameters for definition) <br />
 upfxc - total-sky upward SW flux at toa ( \(W/m^2\)) <br />
 dnflx - total-sky downward SW flux at toa ( \(W/m^2\)) <br />
 upfx0 - clear-sky upward SW flux at toa ( \(W/m^2\)) </td></tr>
    <tr><td class="paramname">sfcfsw</td><td>derived type, SW radiation fluxes at surface, components: (check module_radsw_parameters for definition) <br />
 upfxc - total-sky upward SW flux at sfc ( \(W/m^2\)) <br />
 dnfxc - total-sky downward SW flux at sfc ( \(W/m^2\)) <br />
 upfx0 - clear-sky upward SW flux at sfc ( \(W/m^2\)) <br />
 dnfx0 - clear-sky downward SW flux at sfc ( \(W/m^2\)) </td></tr>
    <tr><td class="paramname">dswcmp</td><td>downward surface SW spectral components: <br />
 (:, 1) - total-sky sfc downward nir direct flux <br />
 (:, 2) - total-sky sfc downward nir diffused flux <br />
 (:, 3) - total-sky sfc downward uv+vis direct flux <br />
 (:, 4) - total-sky sfc downward uv+vis diffused flux </td></tr>
    <tr><td class="paramname">uswcmp</td><td>upward surface SW spectral components: <br />
 (:, 1) - total-sky sfc upward nir direct flux <br />
 (:, 2) - total-sky sfc upward nir diffused flux <br />
 (:, 3) - total-sky sfc upward uv+vis direct flux <br />
 (:, 4) - total-sky sfc upward uv+vis diffused flux </td></tr>
    <tr><td class="paramname">sfalb</td><td>mean surface diffused albedo for SW radiation </td></tr>
    <tr><td class="paramname">coszen</td><td>mean cosine of solar zenith angle over radiation calling period </td></tr>
    <tr><td class="paramname">coszdg</td><td>daytime mean cosine of zenith angle over the radiation calling period </td></tr>
    <tr><td class="paramname">htrlw</td><td>total-sky LW heating rate in k/sec </td></tr>
    <tr><td class="paramname">topflw</td><td>derived type, LW radiation fluxes at TOA, component: (check module_radlw_paramters for definition) <br />
 upfxc - total-sky upward LW flux at toa ( \(W/m^2\)) <br />
 upfx0 - clear-sky upward LW flux at toa ( \(W/m^2\)) </td></tr>
    <tr><td class="paramname">sfcflw</td><td>derived type, LW radiation fluxes at surface, component: (check module_radlw_paramters for definition) <br />
 upfxc - total-sky upward LW flux at sfc ( \(W/m^2\)) <br />
 upfx0 - clear-sky upward LW flux at sfc ( \(W/m^2\)) <br />
 dnfxc - total-sky downward LW flux at sfc ( \(W/m^2\)) <br />
 dnfx0 - clear-sky downward LW flux at sfc ( \(W/m^2\)) </td></tr>
    <tr><td class="paramname">tsflw</td><td>surface air temp during LW calculation call in K </td></tr>
    <tr><td class="paramname">semis</td><td>surface emissivity in fraction for LW radiation </td></tr>
    <tr><td class="paramname">cldcov</td><td>3-d cloud fraction </td></tr>
    <tr><td class="paramname">fluxr</td><td>array for saving time accumulated 2-d fields that are defined as: <br />
 (:, 1) - toa total-sky upward LW radiation flux <br />
 (:, 2) - toa total-sky upward SW radiation flux <br />
 (:, 3) - sfc total-sky upward SW radiation flux <br />
 (:, 4) - sfc total-sky downward SW radiation flux <br />
 (:, 5) - high domain cloud fraction <br />
 (:, 6) - mid domain cloud fraction <br />
 (:, 7) - low domain cloud fraction <br />
 (:, 8) - high domain mean cloud top pressure <br />
 (:, 9) - mid domain mean cloud top pressure <br />
 (:,10) - low domain mean cloud top pressure <br />
 (:,11) - high domain mean cloud base pressure <br />
 (:,12) - mid domain mean cloud base pressure <br />
 (:,13) - low domain mean cloud base pressure <br />
 (:,14) - high domain mean cloud top temperature <br />
 (:,15) - mid domain mean cloud top temperature <br />
 (:,16) - low domain mean cloud top temperature <br />
 (:,17) - total cloud fraction <br />
 (:,18) - boundary layer domain cloud fraction <br />
 (:,19) - sfc total-sky downward LW radiation flux <br />
 (:,20) - sfc total-sky upward LW radiation flux <br />
 (:,21) - sfc total-sky downward SW UV-B radiation flux <br />
 (:,22) - sfc clear-sky downward SW UV-B radiation flux <br />
 (:,23) - TOA incoming solar radiation flux <br />
 (:,24) - sfc UV+visible beam downward SW radiation flux <br />
 (:,25) - sfc UV+visible diffused downward SW radiation flux <br />
 (:,26) - sfc near-IR beam downward SW radiation flux <br />
 (:,27) - sfc near-IR diffused downward SW radiation flux <br />
 (:,28) - toa clear-sky upward LW radiation flux <br />
 (:,29) - toa clear-sky upward SW radiation flux <br />
 (:,30) - sfc clear-sky downward LW radiation flux <br />
 (:,31) - sfc clear-sky upward SW radiation flux <br />
 (:,32) - sfc clear-sky downward SW radiation flux <br />
 (:,33) - sfc clear-sky upward LW radiation flux <br />
 optional: <br />
 (:,34) - aerosol AOD at 550nm (all components) <br />
 (:,35) - aerosol AOD at 550nm for du component <br />
 (:,36) - aerosol AOD at 550nm for bc component <br />
 (:,37) - aerosol AOD at 550nm for oc component <br />
 (:,38) - aerosol AOD at 550nm for su component <br />
 (:,39) - aerosol AOD at 550nm for ss component </td></tr>
    <tr><td class="paramname">htrswb</td><td>spectral bands distributed total sky SW heating rate in k/sec </td></tr>
    <tr><td class="paramname">htrlwb</td><td>spectral bands distributed total sky LW heating rate in k/sec</td></tr>
  </table>
  </dd>
</dl>
<h1><a class="anchor" id="gen_grrad"></a>
General Algorithm</h1>
<ol type="1">
<li>Setup surface ground temperature and ground/air skin temperature if required.</li>
<li>Prepare atmospheric profiles for radiation input.<ul>
<li>Compute relative humidity.</li>
<li>Get layer ozone mass mixing ratio (if use ozone climatology data, call getozn()).</li>
<li>Call coszmn(), to compute cosine of zenith angle.</li>
<li>Call getgases(), to set up non-prognostic gas volume mixing ratioes (gasvmr).</li>
<li>Get temperature at layer interface, and layer moisture.</li>
<li>Check for daytime points for SW radiation.</li>
<li>Call module_radiation_aerosols::setaer(),to setup aerosols property profile for radiation.</li>
<li>Obtain cloud information for radiation calculations (clouds,cldsa,mtopa,mbota) <br />
 for prognostic cloud:<ul>
<li>For Zhao/Moorthi's prognostic cloud scheme, call module_radiation_clouds::progcld1()</li>
<li>For Zhao/Moorthi's prognostic cloud+pdfcld, call module_radiation_clouds::progcld3() call module_radiation_clouds::progclduni() for unified cloud and ncld=2</li>
</ul>
</li>
<li>If cloud condensate is not computed (ntcw=0), using the legacy cloud scheme, compute cloud information based on Slingo's diagnostic cloud scheme (call module_radiation_clouds::diagcld1())</li>
</ul>
</li>
<li>Start SW radiation calculations<ul>
<li>Call module_radiation_surface::setalb() to setup surface albedo. for SW radiation.</li>
</ul>
</li>
<li>Approximate mean surface albedo from vis- and nir- diffuse values.<ul>
<li>Call module_radsw_main::swrad(), to compute SW heating rates and fluxes.</li>
<li>Save two spectral bands' surface downward and upward fluxes for output.</li>
</ul>
</li>
<li>Start LW radiation calculations<ul>
<li>Call module_radiation_surface::setemis(),to setup surface emissivity for LW radiation.</li>
<li>Call module_radlw_main::lwrad(), to compute LW heating rates and fluxes.</li>
</ul>
</li>
<li>Save calculation results<ul>
<li>Save surface air temp for diurnal adjustment at model t-steps</li>
<li>For time averaged output quantities (including total-sky and clear-sky SW and LW fluxes at TOA and surface; conventional 3-domain cloud amount, cloud top and base pressure, and cloud top temperature; aerosols AOD, etc.), store computed results in corresponding slots of array fluxr with appropriate time weights. </li>
</ul>
</li>
</ol>

<p class="definition">Definition at line <a class="el" href="_g_f_s__radiation__driver_8_f90_source.html#l01015">1015</a> of file <a class="el" href="_g_f_s__radiation__driver_8_f90_source.html">GFS_radiation_driver.F90</a>.</p>

<p class="reference">References <a class="el" href="_g_f_s__radiation__driver_8_f90_source.html#l00367">epsq</a>, <a class="el" href="_g_f_s__radiation__driver_8_f90_source.html#l00377">itsfc</a>, <a class="el" href="_g_f_s__radiation__driver_8_f90_source.html#l00393">lextop</a>, <a class="el" href="_g_f_s__radiation__driver_8_f90_source.html#l00389">ltp</a>, <a class="el" href="_g_f_s__radiation__driver_8_f90_source.html#l00373">prsmin</a>, <a class="el" href="_g_f_s__radiation__driver_8_f90_source.html#l00363">qme5</a>, <a class="el" href="_g_f_s__radiation__driver_8_f90_source.html#l00365">qme6</a>, and <a class="el" href="_g_f_s__radiation__driver_8_f90_source.html#l00361">qmin</a>.</p>

</div>
</div>
<h2 class="groupheader">Variable Documentation</h2>
<a id="gafdc2a7e1dbfb075ac33a2388564d9428"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gafdc2a7e1dbfb075ac33a2388564d9428">&#9670;&nbsp;</a></span>qmin</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">real (kind=kind_phys) module_radiation_driver::qmin</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>lower limit of saturation vapor pressure (=1.0e-10) </p>

<p class="definition">Definition at line <a class="el" href="_g_f_s__radiation__driver_8_f90_source.html#l00361">361</a> of file <a class="el" href="_g_f_s__radiation__driver_8_f90_source.html">GFS_radiation_driver.F90</a>.</p>

<p class="reference">Referenced by <a class="el" href="_g_f_s__radiation__driver_8_f90_source.html#l01015">gfs_radiation_driver()</a>.</p>

</div>
</div>
<a id="gab671cb80142c71dab5f41f01ccdcc088"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gab671cb80142c71dab5f41f01ccdcc088">&#9670;&nbsp;</a></span>qme5</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">real (kind=kind_phys) module_radiation_driver::qme5</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>lower limit of specific humidity (=1.0e-7) </p>

<p class="definition">Definition at line <a class="el" href="_g_f_s__radiation__driver_8_f90_source.html#l00363">363</a> of file <a class="el" href="_g_f_s__radiation__driver_8_f90_source.html">GFS_radiation_driver.F90</a>.</p>

<p class="reference">Referenced by <a class="el" href="_g_f_s__radiation__driver_8_f90_source.html#l01015">gfs_radiation_driver()</a>.</p>

</div>
</div>
<a id="ga4916e37c472b2f824b6f566ff67200cd"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga4916e37c472b2f824b6f566ff67200cd">&#9670;&nbsp;</a></span>qme6</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">real (kind=kind_phys) module_radiation_driver::qme6</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>lower limit of specific humidity (=1.0e-7) </p>

<p class="definition">Definition at line <a class="el" href="_g_f_s__radiation__driver_8_f90_source.html#l00365">365</a> of file <a class="el" href="_g_f_s__radiation__driver_8_f90_source.html">GFS_radiation_driver.F90</a>.</p>

<p class="reference">Referenced by <a class="el" href="_g_f_s__radiation__driver_8_f90_source.html#l01015">gfs_radiation_driver()</a>.</p>

</div>
</div>
<a id="ga0b0bf0fa8723b80d0891ec3327d187d7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga0b0bf0fa8723b80d0891ec3327d187d7">&#9670;&nbsp;</a></span>epsq</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">real (kind=kind_phys) module_radiation_driver::epsq</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>EPSQ=1.0e-12. </p>

<p class="definition">Definition at line <a class="el" href="_g_f_s__radiation__driver_8_f90_source.html#l00367">367</a> of file <a class="el" href="_g_f_s__radiation__driver_8_f90_source.html">GFS_radiation_driver.F90</a>.</p>

<p class="reference">Referenced by <a class="el" href="_g_f_s__radiation__driver_8_f90_source.html#l01015">gfs_radiation_driver()</a>.</p>

</div>
</div>
<a id="ga3fc43ca0d2c5f69a380ddb4f0926ecc7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga3fc43ca0d2c5f69a380ddb4f0926ecc7">&#9670;&nbsp;</a></span>prsmin</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">real, parameter module_radiation_driver::prsmin = 1.0e-6</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>lower limit of toa pressure value in mb </p>

<p class="definition">Definition at line <a class="el" href="_g_f_s__radiation__driver_8_f90_source.html#l00373">373</a> of file <a class="el" href="_g_f_s__radiation__driver_8_f90_source.html">GFS_radiation_driver.F90</a>.</p>

<p class="reference">Referenced by <a class="el" href="_g_f_s__radiation__driver_8_f90_source.html#l01015">gfs_radiation_driver()</a>.</p>

</div>
</div>
<a id="ga9ee6a89464bf206cc07ea30d7eeaaeb8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga9ee6a89464bf206cc07ea30d7eeaaeb8">&#9670;&nbsp;</a></span>itsfc</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">integer module_radiation_driver::itsfc =0</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>control flag for LW surface temperature at air/ground interface (default=0, the value will be set in subroutine radinit) </p>

<p class="definition">Definition at line <a class="el" href="_g_f_s__radiation__driver_8_f90_source.html#l00377">377</a> of file <a class="el" href="_g_f_s__radiation__driver_8_f90_source.html">GFS_radiation_driver.F90</a>.</p>

<p class="reference">Referenced by <a class="el" href="_g_f_s__radiation__driver_8_f90_source.html#l01015">gfs_radiation_driver()</a>, and <a class="el" href="_g_f_s__radiation__driver_8_f90_source.html#l00417">radinit()</a>.</p>

</div>
</div>
<a id="ga6eb268f296c77047f389ed6fac5f95be"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga6eb268f296c77047f389ed6fac5f95be">&#9670;&nbsp;</a></span>month0</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">integer module_radiation_driver::month0 =0</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>new data input control variables (set/reset in subroutines radinit/radupdate): </p>

<p class="definition">Definition at line <a class="el" href="_g_f_s__radiation__driver_8_f90_source.html#l00380">380</a> of file <a class="el" href="_g_f_s__radiation__driver_8_f90_source.html">GFS_radiation_driver.F90</a>.</p>

<p class="reference">Referenced by <a class="el" href="_g_f_s__radiation__driver_8_f90_source.html#l00417">radinit()</a>, and <a class="el" href="_g_f_s__radiation__driver_8_f90_source.html#l00667">radupdate()</a>.</p>

</div>
</div>
<a id="ga4d755de48d0aa83f337a2a907ac7d8a2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga4d755de48d0aa83f337a2a907ac7d8a2">&#9670;&nbsp;</a></span>iyear0</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">integer module_radiation_driver::iyear0 =0</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="_g_f_s__radiation__driver_8_f90_source.html#l00380">380</a> of file <a class="el" href="_g_f_s__radiation__driver_8_f90_source.html">GFS_radiation_driver.F90</a>.</p>

<p class="reference">Referenced by <a class="el" href="_g_f_s__radiation__driver_8_f90_source.html#l00417">radinit()</a>, and <a class="el" href="_g_f_s__radiation__driver_8_f90_source.html#l00667">radupdate()</a>.</p>

</div>
</div>
<a id="gac4baf8ff048aaa5b85d03cc42c579c7b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gac4baf8ff048aaa5b85d03cc42c579c7b">&#9670;&nbsp;</a></span>monthd</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">integer module_radiation_driver::monthd =0</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="_g_f_s__radiation__driver_8_f90_source.html#l00380">380</a> of file <a class="el" href="_g_f_s__radiation__driver_8_f90_source.html">GFS_radiation_driver.F90</a>.</p>

<p class="reference">Referenced by <a class="el" href="_g_f_s__radiation__driver_8_f90_source.html#l00417">radinit()</a>, and <a class="el" href="_g_f_s__radiation__driver_8_f90_source.html#l00667">radupdate()</a>.</p>

</div>
</div>
<a id="gaf6e0e1ef2ebb78f57c897ebaf633edd2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gaf6e0e1ef2ebb78f57c897ebaf633edd2">&#9670;&nbsp;</a></span>loz1st</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">logical module_radiation_driver::loz1st =.true.</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>control flag for the first time of reading climatological ozone data (set/reset in subroutines radinit/radupdate, it is used only if the control parameter ioznflg=0) </p>

<p class="definition">Definition at line <a class="el" href="_g_f_s__radiation__driver_8_f90_source.html#l00385">385</a> of file <a class="el" href="_g_f_s__radiation__driver_8_f90_source.html">GFS_radiation_driver.F90</a>.</p>

<p class="reference">Referenced by <a class="el" href="_g_f_s__radiation__driver_8_f90_source.html#l00417">radinit()</a>, and <a class="el" href="_g_f_s__radiation__driver_8_f90_source.html#l00667">radupdate()</a>.</p>

</div>
</div>
<a id="gaab2535e9906afd709124056f4ca1e470"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gaab2535e9906afd709124056f4ca1e470">&#9670;&nbsp;</a></span>ltp</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">integer, parameter module_radiation_driver::ltp = 0</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>optional extra top layer on top of low ceiling models <br />
 LTP=0: no extra top layer </p>

<p class="definition">Definition at line <a class="el" href="_g_f_s__radiation__driver_8_f90_source.html#l00389">389</a> of file <a class="el" href="_g_f_s__radiation__driver_8_f90_source.html">GFS_radiation_driver.F90</a>.</p>

<p class="reference">Referenced by <a class="el" href="_g_f_s__radiation__driver_8_f90_source.html#l01015">gfs_radiation_driver()</a>, and <a class="el" href="_g_f_s__radiation__driver_8_f90_source.html#l00417">radinit()</a>.</p>

</div>
</div>
<a id="gad27b36d0186c8147fe839eb5c268d157"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gad27b36d0186c8147fe839eb5c268d157">&#9670;&nbsp;</a></span>lextop</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">logical, parameter module_radiation_driver::lextop = (LTP &gt; 0)</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>control flag for extra top layer </p>

<p class="definition">Definition at line <a class="el" href="_g_f_s__radiation__driver_8_f90_source.html#l00393">393</a> of file <a class="el" href="_g_f_s__radiation__driver_8_f90_source.html">GFS_radiation_driver.F90</a>.</p>

<p class="reference">Referenced by <a class="el" href="_g_f_s__radiation__driver_8_f90_source.html#l01015">gfs_radiation_driver()</a>, and <a class="el" href="_g_f_s__radiation__driver_8_f90_source.html#l00417">radinit()</a>.</p>

</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">Generated by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.13 </li>
  </ul>
</div>
</body>
</html>
